<?php
// Copyright (C) 2011 Bheesham Persaud.
// License available in LICENSE.

// request a resource
if ( isset( $_GET['res'] ) ) {
	switch( $_GET['res'] ) {
		case 'css':
			header( 'Content-Type: text/css' );
			echo "body { width: 600px; margin-left: auto; margin-right: auto; } \r\n";
			echo "h1,h2,h3,h4 { margin: 0px; padding: 0px; color: #555555; } \r\n";
			echo "ul { list-style: none; display: inline; } \r\n";
			echo "li.alt { background-color: #CCFFF0; } \r\n";
			echo "li.sel { background-color: #58ACFA; } \r\n";
			echo "img.ico, input.ico { padding-top: 2px; } \r\n";
			echo "ul, p { margin: 0px; padding: 0px; } \r\n";
			// jQuery Context Menu Plugin - http://abeautifulsite.net/blog/2008/09/jquery-context-menu-plugin/
			echo base64_decode( "LyogR2VuZXJpYyBjb250ZXh0IG1lbnUgc3R5bGVzICovDQouY29udGV4dE1lbnUgew0KCXBvc2l0aW9uOiBhYnNvbHV0ZTsNCgl3aWR0aDogMTIwcHg7DQoJei1pbmRleDogOTk5OTk7DQoJYm9yZGVyOiBzb2xpZCAxcHggI0NDQzsNCgliYWNrZ3JvdW5kOiAjRUVFOw0KCXBhZGRpbmc6IDBweDsNCgltYXJnaW46IDBweDsNCglkaXNwbGF5OiBub25lOw0KfQ0KDQouY29udGV4dE1lbnUgTEkgew0KCWxpc3Qtc3R5bGU6IG5vbmU7DQoJcGFkZGluZzogMHB4Ow0KCW1hcmdpbjogMHB4Ow0KfQ0KDQouY29udGV4dE1lbnUgQSB7DQoJY29sb3I6ICMzMzM7DQoJdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KCWRpc3BsYXk6IGJsb2NrOw0KCWxpbmUtaGVpZ2h0OiAyMHB4Ow0KCWhlaWdodDogMjBweDsNCgliYWNrZ3JvdW5kLXBvc2l0aW9uOiA2cHggY2VudGVyOw0KCWJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7DQoJb3V0bGluZTogbm9uZTsNCglwYWRkaW5nOiAxcHggNXB4Ow0KCXBhZGRpbmctbGVmdDogMjhweDsNCn0NCg0KLmNvbnRleHRNZW51IExJLmhvdmVyIEEgew0KCWNvbG9yOiAjRkZGOw0KCWJhY2tncm91bmQtY29sb3I6ICMzMzk5RkY7DQp9DQoNCi5jb250ZXh0TWVudSBMSS5kaXNhYmxlZCBBIHsNCgljb2xvcjogI0FBQTsNCgljdXJzb3I6IGRlZmF1bHQ7DQp9DQoNCi5jb250ZXh0TWVudSBMSS5ob3Zlci5kaXNhYmxlZCBBIHsNCgliYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsNCn0NCg0KLmNvbnRleHRNZW51IExJLnNlcGFyYXRvciB7DQoJYm9yZGVyLXRvcDogc29saWQgMXB4ICNDQ0M7DQp9" );
			// Icons for the Context Menu
			echo ".contextMenu LI.edit A { background-image: url(?res=edit); } \r\n";
			echo ".contextMenu LI.delete A { background-image: url(?res=delete); } \r\n";
			echo ".contextMenu LI.perms A { background-image: url(?res=perms); } \r\n";
			echo ".contextMenu LI.cut A { background-image: url(?res=cut); } \r\n";
			echo ".contextMenu LI.copy A { background-image: url(?res=copy); } \r\n";
			echo ".contextMenu LI.compress A { background-image: url(?res=compress); } \r\n";
			echo ".contextMenu LI.cross A { background-image: url(?res=cross); } \r\n";
			echo "\r\n";
			break;
		case 'js':
			header( 'Content-Type: text/javascript' );
			// jQuery 1.4.2 - http://jquery.com
			echo base64_decode( "LyohDQogKiBqUXVlcnkgSmF2YVNjcmlwdCBMaWJyYXJ5IHYxLjQuMg0KICogaHR0cDovL2pxdWVyeS5jb20vDQogKg0KICogQ29weXJpZ2h0IDIwMTAsIEpvaG4gUmVzaWcNCiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBvciBHUEwgVmVyc2lvbiAyIGxpY2Vuc2VzLg0KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQ0KICoNCiAqIEluY2x1ZGVzIFNpenpsZS5qcw0KICogaHR0cDovL3NpenpsZWpzLmNvbS8NCiAqIENvcHlyaWdodCAyMDEwLCBUaGUgRG9qbyBGb3VuZGF0aW9uDQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlULCBCU0QsIGFuZCBHUEwgTGljZW5zZXMuDQogKg0KICogRGF0ZTogU2F0IEZlYiAxMyAyMjozMzo0OCAyMDEwIC0wNTAwDQogKi8NCihmdW5jdGlvbihBLHcpe2Z1bmN0aW9uIG1hKCl7aWYoIWMuaXNSZWFkeSl7dHJ5e3MuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsKCJsZWZ0Iil9Y2F0Y2goYSl7c2V0VGltZW91dChtYSwxKTtyZXR1cm59Yy5yZWFkeSgpfX1mdW5jdGlvbiBRYShhLGIpe2Iuc3JjP2MuYWpheCh7dXJsOmIuc3JjLGFzeW5jOmZhbHNlLGRhdGFUeXBlOiJzY3JpcHQifSk6Yy5nbG9iYWxFdmFsKGIudGV4dHx8Yi50ZXh0Q29udGVudHx8Yi5pbm5lckhUTUx8fCIiKTtiLnBhcmVudE5vZGUmJmIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChiKX1mdW5jdGlvbiBYKGEsYixkLGYsZSxqKXt2YXIgaT1hLmxlbmd0aDtpZih0eXBlb2YgYj09PSJvYmplY3QiKXtmb3IodmFyIG8gaW4gYilYKGEsbyxiW29dLGYsZSxkKTtyZXR1cm4gYX1pZihkIT09dyl7Zj0haiYmZiYmYy5pc0Z1bmN0aW9uKGQpO2ZvcihvPTA7bzxpO28rKyllKGFbb10sYixmP2QuY2FsbChhW29dLG8sZShhW29dLGIpKTpkLGopO3JldHVybiBhfXJldHVybiBpPw0KZShhWzBdLGIpOnd9ZnVuY3Rpb24gSigpe3JldHVybihuZXcgRGF0ZSkuZ2V0VGltZSgpfWZ1bmN0aW9uIFkoKXtyZXR1cm4gZmFsc2V9ZnVuY3Rpb24gWigpe3JldHVybiB0cnVlfWZ1bmN0aW9uIG5hKGEsYixkKXtkWzBdLnR5cGU9YTtyZXR1cm4gYy5ldmVudC5oYW5kbGUuYXBwbHkoYixkKX1mdW5jdGlvbiBvYShhKXt2YXIgYixkPVtdLGY9W10sZT1hcmd1bWVudHMsaixpLG8sayxuLHI7aT1jLmRhdGEodGhpcywiZXZlbnRzIik7aWYoIShhLmxpdmVGaXJlZD09PXRoaXN8fCFpfHwhaS5saXZlfHxhLmJ1dHRvbiYmYS50eXBlPT09ImNsaWNrIikpe2EubGl2ZUZpcmVkPXRoaXM7dmFyIHU9aS5saXZlLnNsaWNlKDApO2ZvcihrPTA7azx1Lmxlbmd0aDtrKyspe2k9dVtrXTtpLm9yaWdUeXBlLnJlcGxhY2UoTywiIik9PT1hLnR5cGU/Zi5wdXNoKGkuc2VsZWN0b3IpOnUuc3BsaWNlKGstLSwxKX1qPWMoYS50YXJnZXQpLmNsb3Nlc3QoZixhLmN1cnJlbnRUYXJnZXQpO249MDtmb3Iocj0NCmoubGVuZ3RoO248cjtuKyspZm9yKGs9MDtrPHUubGVuZ3RoO2srKyl7aT11W2tdO2lmKGpbbl0uc2VsZWN0b3I9PT1pLnNlbGVjdG9yKXtvPWpbbl0uZWxlbTtmPW51bGw7aWYoaS5wcmVUeXBlPT09Im1vdXNlZW50ZXIifHxpLnByZVR5cGU9PT0ibW91c2VsZWF2ZSIpZj1jKGEucmVsYXRlZFRhcmdldCkuY2xvc2VzdChpLnNlbGVjdG9yKVswXTtpZighZnx8ZiE9PW8pZC5wdXNoKHtlbGVtOm8saGFuZGxlT2JqOml9KX19bj0wO2ZvcihyPWQubGVuZ3RoO248cjtuKyspe2o9ZFtuXTthLmN1cnJlbnRUYXJnZXQ9ai5lbGVtO2EuZGF0YT1qLmhhbmRsZU9iai5kYXRhO2EuaGFuZGxlT2JqPWouaGFuZGxlT2JqO2lmKGouaGFuZGxlT2JqLm9yaWdIYW5kbGVyLmFwcGx5KGouZWxlbSxlKT09PWZhbHNlKXtiPWZhbHNlO2JyZWFrfX1yZXR1cm4gYn19ZnVuY3Rpb24gcGEoYSxiKXtyZXR1cm4ibGl2ZS4iKyhhJiZhIT09IioiP2ErIi4iOiIiKStiLnJlcGxhY2UoL1wuL2csImAiKS5yZXBsYWNlKC8gL2csDQoiJiIpfWZ1bmN0aW9uIHFhKGEpe3JldHVybiFhfHwhYS5wYXJlbnROb2RlfHxhLnBhcmVudE5vZGUubm9kZVR5cGU9PT0xMX1mdW5jdGlvbiByYShhLGIpe3ZhciBkPTA7Yi5lYWNoKGZ1bmN0aW9uKCl7aWYodGhpcy5ub2RlTmFtZT09PShhW2RdJiZhW2RdLm5vZGVOYW1lKSl7dmFyIGY9Yy5kYXRhKGFbZCsrXSksZT1jLmRhdGEodGhpcyxmKTtpZihmPWYmJmYuZXZlbnRzKXtkZWxldGUgZS5oYW5kbGU7ZS5ldmVudHM9e307Zm9yKHZhciBqIGluIGYpZm9yKHZhciBpIGluIGZbal0pYy5ldmVudC5hZGQodGhpcyxqLGZbal1baV0sZltqXVtpXS5kYXRhKX19fSl9ZnVuY3Rpb24gc2EoYSxiLGQpe3ZhciBmLGUsajtiPWImJmJbMF0/YlswXS5vd25lckRvY3VtZW50fHxiWzBdOnM7aWYoYS5sZW5ndGg9PT0xJiZ0eXBlb2YgYVswXT09PSJzdHJpbmciJiZhWzBdLmxlbmd0aDw1MTImJmI9PT1zJiYhdGEudGVzdChhWzBdKSYmKGMuc3VwcG9ydC5jaGVja0Nsb25lfHwhdWEudGVzdChhWzBdKSkpe2U9DQp0cnVlO2lmKGo9Yy5mcmFnbWVudHNbYVswXV0paWYoaiE9PTEpZj1qfWlmKCFmKXtmPWIuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO2MuY2xlYW4oYSxiLGYsZCl9aWYoZSljLmZyYWdtZW50c1thWzBdXT1qP2Y6MTtyZXR1cm57ZnJhZ21lbnQ6ZixjYWNoZWFibGU6ZX19ZnVuY3Rpb24gSyhhLGIpe3ZhciBkPXt9O2MuZWFjaCh2YS5jb25jYXQuYXBwbHkoW10sdmEuc2xpY2UoMCxiKSksZnVuY3Rpb24oKXtkW3RoaXNdPWF9KTtyZXR1cm4gZH1mdW5jdGlvbiB3YShhKXtyZXR1cm4ic2Nyb2xsVG8iaW4gYSYmYS5kb2N1bWVudD9hOmEubm9kZVR5cGU9PT05P2EuZGVmYXVsdFZpZXd8fGEucGFyZW50V2luZG93OmZhbHNlfXZhciBjPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBjLmZuLmluaXQoYSxiKX0sUmE9QS5qUXVlcnksU2E9QS4kLHM9QS5kb2N1bWVudCxULFRhPS9eW148XSooPFtcd1xXXSs+KVtePl0qJHxeIyhbXHctXSspJC8sVWE9L14uW146I1xbXC4sXSokLyxWYT0vXFMvLA0KV2E9L14oXHN8XHUwMEEwKSt8KFxzfFx1MDBBMCkrJC9nLFhhPS9ePChcdyspXHMqXC8/Pig/OjxcL1wxPik/JC8sUD1uYXZpZ2F0b3IudXNlckFnZW50LHhhPWZhbHNlLFE9W10sTCwkPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsYWE9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxiYT1BcnJheS5wcm90b3R5cGUucHVzaCxSPUFycmF5LnByb3RvdHlwZS5zbGljZSx5YT1BcnJheS5wcm90b3R5cGUuaW5kZXhPZjtjLmZuPWMucHJvdG90eXBlPXtpbml0OmZ1bmN0aW9uKGEsYil7dmFyIGQsZjtpZighYSlyZXR1cm4gdGhpcztpZihhLm5vZGVUeXBlKXt0aGlzLmNvbnRleHQ9dGhpc1swXT1hO3RoaXMubGVuZ3RoPTE7cmV0dXJuIHRoaXN9aWYoYT09PSJib2R5IiYmIWIpe3RoaXMuY29udGV4dD1zO3RoaXNbMF09cy5ib2R5O3RoaXMuc2VsZWN0b3I9ImJvZHkiO3RoaXMubGVuZ3RoPTE7cmV0dXJuIHRoaXN9aWYodHlwZW9mIGE9PT0ic3RyaW5nIilpZigoZD1UYS5leGVjKGEpKSYmDQooZFsxXXx8IWIpKWlmKGRbMV0pe2Y9Yj9iLm93bmVyRG9jdW1lbnR8fGI6cztpZihhPVhhLmV4ZWMoYSkpaWYoYy5pc1BsYWluT2JqZWN0KGIpKXthPVtzLmNyZWF0ZUVsZW1lbnQoYVsxXSldO2MuZm4uYXR0ci5jYWxsKGEsYix0cnVlKX1lbHNlIGE9W2YuY3JlYXRlRWxlbWVudChhWzFdKV07ZWxzZXthPXNhKFtkWzFdXSxbZl0pO2E9KGEuY2FjaGVhYmxlP2EuZnJhZ21lbnQuY2xvbmVOb2RlKHRydWUpOmEuZnJhZ21lbnQpLmNoaWxkTm9kZXN9cmV0dXJuIGMubWVyZ2UodGhpcyxhKX1lbHNle2lmKGI9cy5nZXRFbGVtZW50QnlJZChkWzJdKSl7aWYoYi5pZCE9PWRbMl0pcmV0dXJuIFQuZmluZChhKTt0aGlzLmxlbmd0aD0xO3RoaXNbMF09Yn10aGlzLmNvbnRleHQ9czt0aGlzLnNlbGVjdG9yPWE7cmV0dXJuIHRoaXN9ZWxzZSBpZighYiYmL15cdyskLy50ZXN0KGEpKXt0aGlzLnNlbGVjdG9yPWE7dGhpcy5jb250ZXh0PXM7YT1zLmdldEVsZW1lbnRzQnlUYWdOYW1lKGEpO3JldHVybiBjLm1lcmdlKHRoaXMsDQphKX1lbHNlIHJldHVybiFifHxiLmpxdWVyeT8oYnx8VCkuZmluZChhKTpjKGIpLmZpbmQoYSk7ZWxzZSBpZihjLmlzRnVuY3Rpb24oYSkpcmV0dXJuIFQucmVhZHkoYSk7aWYoYS5zZWxlY3RvciE9PXcpe3RoaXMuc2VsZWN0b3I9YS5zZWxlY3Rvcjt0aGlzLmNvbnRleHQ9YS5jb250ZXh0fXJldHVybiBjLm1ha2VBcnJheShhLHRoaXMpfSxzZWxlY3RvcjoiIixqcXVlcnk6IjEuNC4yIixsZW5ndGg6MCxzaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGVuZ3RofSx0b0FycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIFIuY2FsbCh0aGlzLDApfSxnZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGE9PW51bGw/dGhpcy50b0FycmF5KCk6YTwwP3RoaXMuc2xpY2UoYSlbMF06dGhpc1thXX0scHVzaFN0YWNrOmZ1bmN0aW9uKGEsYixkKXt2YXIgZj1jKCk7Yy5pc0FycmF5KGEpP2JhLmFwcGx5KGYsYSk6Yy5tZXJnZShmLGEpO2YucHJldk9iamVjdD10aGlzO2YuY29udGV4dD10aGlzLmNvbnRleHQ7aWYoYj09PQ0KImZpbmQiKWYuc2VsZWN0b3I9dGhpcy5zZWxlY3RvcisodGhpcy5zZWxlY3Rvcj8iICI6IiIpK2Q7ZWxzZSBpZihiKWYuc2VsZWN0b3I9dGhpcy5zZWxlY3RvcisiLiIrYisiKCIrZCsiKSI7cmV0dXJuIGZ9LGVhY2g6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYy5lYWNoKHRoaXMsYSxiKX0scmVhZHk6ZnVuY3Rpb24oYSl7Yy5iaW5kUmVhZHkoKTtpZihjLmlzUmVhZHkpYS5jYWxsKHMsYyk7ZWxzZSBRJiZRLnB1c2goYSk7cmV0dXJuIHRoaXN9LGVxOmZ1bmN0aW9uKGEpe3JldHVybiBhPT09LTE/dGhpcy5zbGljZShhKTp0aGlzLnNsaWNlKGEsK2ErMSl9LGZpcnN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXEoMCl9LGxhc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgtMSl9LHNsaWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKFIuYXBwbHkodGhpcyxhcmd1bWVudHMpLCJzbGljZSIsUi5jYWxsKGFyZ3VtZW50cykuam9pbigiLCIpKX0sbWFwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayhjLm1hcCh0aGlzLA0KZnVuY3Rpb24oYixkKXtyZXR1cm4gYS5jYWxsKGIsZCxiKX0pKX0sZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJldk9iamVjdHx8YyhudWxsKX0scHVzaDpiYSxzb3J0OltdLnNvcnQsc3BsaWNlOltdLnNwbGljZX07Yy5mbi5pbml0LnByb3RvdHlwZT1jLmZuO2MuZXh0ZW5kPWMuZm4uZXh0ZW5kPWZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzWzBdfHx7fSxiPTEsZD1hcmd1bWVudHMubGVuZ3RoLGY9ZmFsc2UsZSxqLGksbztpZih0eXBlb2YgYT09PSJib29sZWFuIil7Zj1hO2E9YXJndW1lbnRzWzFdfHx7fTtiPTJ9aWYodHlwZW9mIGEhPT0ib2JqZWN0IiYmIWMuaXNGdW5jdGlvbihhKSlhPXt9O2lmKGQ9PT1iKXthPXRoaXM7LS1ifWZvcig7YjxkO2IrKylpZigoZT1hcmd1bWVudHNbYl0pIT1udWxsKWZvcihqIGluIGUpe2k9YVtqXTtvPWVbal07aWYoYSE9PW8paWYoZiYmbyYmKGMuaXNQbGFpbk9iamVjdChvKXx8Yy5pc0FycmF5KG8pKSl7aT1pJiYoYy5pc1BsYWluT2JqZWN0KGkpfHwNCmMuaXNBcnJheShpKSk/aTpjLmlzQXJyYXkobyk/W106e307YVtqXT1jLmV4dGVuZChmLGksbyl9ZWxzZSBpZihvIT09dylhW2pdPW99cmV0dXJuIGF9O2MuZXh0ZW5kKHtub0NvbmZsaWN0OmZ1bmN0aW9uKGEpe0EuJD1TYTtpZihhKUEualF1ZXJ5PVJhO3JldHVybiBjfSxpc1JlYWR5OmZhbHNlLHJlYWR5OmZ1bmN0aW9uKCl7aWYoIWMuaXNSZWFkeSl7aWYoIXMuYm9keSlyZXR1cm4gc2V0VGltZW91dChjLnJlYWR5LDEzKTtjLmlzUmVhZHk9dHJ1ZTtpZihRKXtmb3IodmFyIGEsYj0wO2E9UVtiKytdOylhLmNhbGwocyxjKTtRPW51bGx9Yy5mbi50cmlnZ2VySGFuZGxlciYmYyhzKS50cmlnZ2VySGFuZGxlcigicmVhZHkiKX19LGJpbmRSZWFkeTpmdW5jdGlvbigpe2lmKCF4YSl7eGE9dHJ1ZTtpZihzLnJlYWR5U3RhdGU9PT0iY29tcGxldGUiKXJldHVybiBjLnJlYWR5KCk7aWYocy5hZGRFdmVudExpc3RlbmVyKXtzLmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLA0KTCxmYWxzZSk7QS5hZGRFdmVudExpc3RlbmVyKCJsb2FkIixjLnJlYWR5LGZhbHNlKX1lbHNlIGlmKHMuYXR0YWNoRXZlbnQpe3MuYXR0YWNoRXZlbnQoIm9ucmVhZHlzdGF0ZWNoYW5nZSIsTCk7QS5hdHRhY2hFdmVudCgib25sb2FkIixjLnJlYWR5KTt2YXIgYT1mYWxzZTt0cnl7YT1BLmZyYW1lRWxlbWVudD09bnVsbH1jYXRjaChiKXt9cy5kb2N1bWVudEVsZW1lbnQuZG9TY3JvbGwmJmEmJm1hKCl9fX0saXNGdW5jdGlvbjpmdW5jdGlvbihhKXtyZXR1cm4gJC5jYWxsKGEpPT09IltvYmplY3QgRnVuY3Rpb25dIn0saXNBcnJheTpmdW5jdGlvbihhKXtyZXR1cm4gJC5jYWxsKGEpPT09IltvYmplY3QgQXJyYXldIn0saXNQbGFpbk9iamVjdDpmdW5jdGlvbihhKXtpZighYXx8JC5jYWxsKGEpIT09IltvYmplY3QgT2JqZWN0XSJ8fGEubm9kZVR5cGV8fGEuc2V0SW50ZXJ2YWwpcmV0dXJuIGZhbHNlO2lmKGEuY29uc3RydWN0b3ImJiFhYS5jYWxsKGEsImNvbnN0cnVjdG9yIikmJiFhYS5jYWxsKGEuY29uc3RydWN0b3IucHJvdG90eXBlLA0KImlzUHJvdG90eXBlT2YiKSlyZXR1cm4gZmFsc2U7dmFyIGI7Zm9yKGIgaW4gYSk7cmV0dXJuIGI9PT13fHxhYS5jYWxsKGEsYil9LGlzRW1wdHlPYmplY3Q6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiIGluIGEpcmV0dXJuIGZhbHNlO3JldHVybiB0cnVlfSxlcnJvcjpmdW5jdGlvbihhKXt0aHJvdyBhO30scGFyc2VKU09OOmZ1bmN0aW9uKGEpe2lmKHR5cGVvZiBhIT09InN0cmluZyJ8fCFhKXJldHVybiBudWxsO2E9Yy50cmltKGEpO2lmKC9eW1xdLDp7fVxzXSokLy50ZXN0KGEucmVwbGFjZSgvXFwoPzpbIlxcXC9iZm5ydF18dVswLTlhLWZBLUZdezR9KS9nLCJAIikucmVwbGFjZSgvIlteIlxcXG5ccl0qInx0cnVlfGZhbHNlfG51bGx8LT9cZCsoPzpcLlxkKik/KD86W2VFXVsrXC1dP1xkKyk/L2csIl0iKS5yZXBsYWNlKC8oPzpefDp8LCkoPzpccypcWykrL2csIiIpKSlyZXR1cm4gQS5KU09OJiZBLkpTT04ucGFyc2U/QS5KU09OLnBhcnNlKGEpOihuZXcgRnVuY3Rpb24oInJldHVybiAiKw0KYSkpKCk7ZWxzZSBjLmVycm9yKCJJbnZhbGlkIEpTT046ICIrYSl9LG5vb3A6ZnVuY3Rpb24oKXt9LGdsb2JhbEV2YWw6ZnVuY3Rpb24oYSl7aWYoYSYmVmEudGVzdChhKSl7dmFyIGI9cy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdfHxzLmRvY3VtZW50RWxlbWVudCxkPXMuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7ZC50eXBlPSJ0ZXh0L2phdmFzY3JpcHQiO2lmKGMuc3VwcG9ydC5zY3JpcHRFdmFsKWQuYXBwZW5kQ2hpbGQocy5jcmVhdGVUZXh0Tm9kZShhKSk7ZWxzZSBkLnRleHQ9YTtiLmluc2VydEJlZm9yZShkLGIuZmlyc3RDaGlsZCk7Yi5yZW1vdmVDaGlsZChkKX19LG5vZGVOYW1lOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9VcHBlckNhc2UoKT09PWIudG9VcHBlckNhc2UoKX0sZWFjaDpmdW5jdGlvbihhLGIsZCl7dmFyIGYsZT0wLGo9YS5sZW5ndGgsaT1qPT09d3x8Yy5pc0Z1bmN0aW9uKGEpO2lmKGQpaWYoaSlmb3IoZiBpbiBhKXtpZihiLmFwcGx5KGFbZl0sDQpkKT09PWZhbHNlKWJyZWFrfWVsc2UgZm9yKDtlPGo7KXtpZihiLmFwcGx5KGFbZSsrXSxkKT09PWZhbHNlKWJyZWFrfWVsc2UgaWYoaSlmb3IoZiBpbiBhKXtpZihiLmNhbGwoYVtmXSxmLGFbZl0pPT09ZmFsc2UpYnJlYWt9ZWxzZSBmb3IoZD1hWzBdO2U8aiYmYi5jYWxsKGQsZSxkKSE9PWZhbHNlO2Q9YVsrK2VdKTtyZXR1cm4gYX0sdHJpbTpmdW5jdGlvbihhKXtyZXR1cm4oYXx8IiIpLnJlcGxhY2UoV2EsIiIpfSxtYWtlQXJyYXk6ZnVuY3Rpb24oYSxiKXtiPWJ8fFtdO2lmKGEhPW51bGwpYS5sZW5ndGg9PW51bGx8fHR5cGVvZiBhPT09InN0cmluZyJ8fGMuaXNGdW5jdGlvbihhKXx8dHlwZW9mIGEhPT0iZnVuY3Rpb24iJiZhLnNldEludGVydmFsP2JhLmNhbGwoYixhKTpjLm1lcmdlKGIsYSk7cmV0dXJuIGJ9LGluQXJyYXk6ZnVuY3Rpb24oYSxiKXtpZihiLmluZGV4T2YpcmV0dXJuIGIuaW5kZXhPZihhKTtmb3IodmFyIGQ9MCxmPWIubGVuZ3RoO2Q8ZjtkKyspaWYoYltkXT09PQ0KYSlyZXR1cm4gZDtyZXR1cm4tMX0sbWVyZ2U6ZnVuY3Rpb24oYSxiKXt2YXIgZD1hLmxlbmd0aCxmPTA7aWYodHlwZW9mIGIubGVuZ3RoPT09Im51bWJlciIpZm9yKHZhciBlPWIubGVuZ3RoO2Y8ZTtmKyspYVtkKytdPWJbZl07ZWxzZSBmb3IoO2JbZl0hPT13OylhW2QrK109YltmKytdO2EubGVuZ3RoPWQ7cmV0dXJuIGF9LGdyZXA6ZnVuY3Rpb24oYSxiLGQpe2Zvcih2YXIgZj1bXSxlPTAsaj1hLmxlbmd0aDtlPGo7ZSsrKSFkIT09IWIoYVtlXSxlKSYmZi5wdXNoKGFbZV0pO3JldHVybiBmfSxtYXA6ZnVuY3Rpb24oYSxiLGQpe2Zvcih2YXIgZj1bXSxlLGo9MCxpPWEubGVuZ3RoO2o8aTtqKyspe2U9YihhW2pdLGosZCk7aWYoZSE9bnVsbClmW2YubGVuZ3RoXT1lfXJldHVybiBmLmNvbmNhdC5hcHBseShbXSxmKX0sZ3VpZDoxLHByb3h5OmZ1bmN0aW9uKGEsYixkKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MilpZih0eXBlb2YgYj09PSJzdHJpbmciKXtkPWE7YT1kW2JdO2I9d31lbHNlIGlmKGImJg0KIWMuaXNGdW5jdGlvbihiKSl7ZD1iO2I9d31pZighYiYmYSliPWZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkoZHx8dGhpcyxhcmd1bWVudHMpfTtpZihhKWIuZ3VpZD1hLmd1aWQ9YS5ndWlkfHxiLmd1aWR8fGMuZ3VpZCsrO3JldHVybiBifSx1YU1hdGNoOmZ1bmN0aW9uKGEpe2E9YS50b0xvd2VyQ2FzZSgpO2E9Lyh3ZWJraXQpWyBcL10oW1x3Ll0rKS8uZXhlYyhhKXx8LyhvcGVyYSkoPzouKnZlcnNpb24pP1sgXC9dKFtcdy5dKykvLmV4ZWMoYSl8fC8obXNpZSkgKFtcdy5dKykvLmV4ZWMoYSl8fCEvY29tcGF0aWJsZS8udGVzdChhKSYmLyhtb3ppbGxhKSg/Oi4qPyBydjooW1x3Ll0rKSk/Ly5leGVjKGEpfHxbXTtyZXR1cm57YnJvd3NlcjphWzFdfHwiIix2ZXJzaW9uOmFbMl18fCIwIn19LGJyb3dzZXI6e319KTtQPWMudWFNYXRjaChQKTtpZihQLmJyb3dzZXIpe2MuYnJvd3NlcltQLmJyb3dzZXJdPXRydWU7Yy5icm93c2VyLnZlcnNpb249UC52ZXJzaW9ufWlmKGMuYnJvd3Nlci53ZWJraXQpYy5icm93c2VyLnNhZmFyaT0NCnRydWU7aWYoeWEpYy5pbkFycmF5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHlhLmNhbGwoYixhKX07VD1jKHMpO2lmKHMuYWRkRXZlbnRMaXN0ZW5lcilMPWZ1bmN0aW9uKCl7cy5yZW1vdmVFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixMLGZhbHNlKTtjLnJlYWR5KCl9O2Vsc2UgaWYocy5hdHRhY2hFdmVudClMPWZ1bmN0aW9uKCl7aWYocy5yZWFkeVN0YXRlPT09ImNvbXBsZXRlIil7cy5kZXRhY2hFdmVudCgib25yZWFkeXN0YXRlY2hhbmdlIixMKTtjLnJlYWR5KCl9fTsoZnVuY3Rpb24oKXtjLnN1cHBvcnQ9e307dmFyIGE9cy5kb2N1bWVudEVsZW1lbnQsYj1zLmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpLGQ9cy5jcmVhdGVFbGVtZW50KCJkaXYiKSxmPSJzY3JpcHQiK0ooKTtkLnN0eWxlLmRpc3BsYXk9Im5vbmUiO2QuaW5uZXJIVE1MPSIgICA8bGluay8+PHRhYmxlPjwvdGFibGU+PGEgaHJlZj0nL2EnIHN0eWxlPSdjb2xvcjpyZWQ7ZmxvYXQ6bGVmdDtvcGFjaXR5Oi41NTsnPmE8L2E+PGlucHV0IHR5cGU9J2NoZWNrYm94Jy8+IjsNCnZhciBlPWQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKSxqPWQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImEiKVswXTtpZighKCFlfHwhZS5sZW5ndGh8fCFqKSl7Yy5zdXBwb3J0PXtsZWFkaW5nV2hpdGVzcGFjZTpkLmZpcnN0Q2hpbGQubm9kZVR5cGU9PT0zLHRib2R5OiFkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpLmxlbmd0aCxodG1sU2VyaWFsaXplOiEhZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgibGluayIpLmxlbmd0aCxzdHlsZTovcmVkLy50ZXN0KGouZ2V0QXR0cmlidXRlKCJzdHlsZSIpKSxocmVmTm9ybWFsaXplZDpqLmdldEF0dHJpYnV0ZSgiaHJlZiIpPT09Ii9hIixvcGFjaXR5Oi9eMC41NSQvLnRlc3Qoai5zdHlsZS5vcGFjaXR5KSxjc3NGbG9hdDohIWouc3R5bGUuY3NzRmxvYXQsY2hlY2tPbjpkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJpbnB1dCIpWzBdLnZhbHVlPT09Im9uIixvcHRTZWxlY3RlZDpzLmNyZWF0ZUVsZW1lbnQoInNlbGVjdCIpLmFwcGVuZENoaWxkKHMuY3JlYXRlRWxlbWVudCgib3B0aW9uIikpLnNlbGVjdGVkLA0KcGFyZW50Tm9kZTpkLnJlbW92ZUNoaWxkKGQuYXBwZW5kQ2hpbGQocy5jcmVhdGVFbGVtZW50KCJkaXYiKSkpLnBhcmVudE5vZGU9PT1udWxsLGRlbGV0ZUV4cGFuZG86dHJ1ZSxjaGVja0Nsb25lOmZhbHNlLHNjcmlwdEV2YWw6ZmFsc2Usbm9DbG9uZUV2ZW50OnRydWUsYm94TW9kZWw6bnVsbH07Yi50eXBlPSJ0ZXh0L2phdmFzY3JpcHQiO3RyeXtiLmFwcGVuZENoaWxkKHMuY3JlYXRlVGV4dE5vZGUoIndpbmRvdy4iK2YrIj0xOyIpKX1jYXRjaChpKXt9YS5pbnNlcnRCZWZvcmUoYixhLmZpcnN0Q2hpbGQpO2lmKEFbZl0pe2Muc3VwcG9ydC5zY3JpcHRFdmFsPXRydWU7ZGVsZXRlIEFbZl19dHJ5e2RlbGV0ZSBiLnRlc3R9Y2F0Y2gobyl7Yy5zdXBwb3J0LmRlbGV0ZUV4cGFuZG89ZmFsc2V9YS5yZW1vdmVDaGlsZChiKTtpZihkLmF0dGFjaEV2ZW50JiZkLmZpcmVFdmVudCl7ZC5hdHRhY2hFdmVudCgib25jbGljayIsZnVuY3Rpb24gaygpe2Muc3VwcG9ydC5ub0Nsb25lRXZlbnQ9DQpmYWxzZTtkLmRldGFjaEV2ZW50KCJvbmNsaWNrIixrKX0pO2QuY2xvbmVOb2RlKHRydWUpLmZpcmVFdmVudCgib25jbGljayIpfWQ9cy5jcmVhdGVFbGVtZW50KCJkaXYiKTtkLmlubmVySFRNTD0iPGlucHV0IHR5cGU9J3JhZGlvJyBuYW1lPSdyYWRpb3Rlc3QnIGNoZWNrZWQ9J2NoZWNrZWQnLz4iO2E9cy5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7YS5hcHBlbmRDaGlsZChkLmZpcnN0Q2hpbGQpO2Muc3VwcG9ydC5jaGVja0Nsb25lPWEuY2xvbmVOb2RlKHRydWUpLmNsb25lTm9kZSh0cnVlKS5sYXN0Q2hpbGQuY2hlY2tlZDtjKGZ1bmN0aW9uKCl7dmFyIGs9cy5jcmVhdGVFbGVtZW50KCJkaXYiKTtrLnN0eWxlLndpZHRoPWsuc3R5bGUucGFkZGluZ0xlZnQ9IjFweCI7cy5ib2R5LmFwcGVuZENoaWxkKGspO2MuYm94TW9kZWw9Yy5zdXBwb3J0LmJveE1vZGVsPWsub2Zmc2V0V2lkdGg9PT0yO3MuYm9keS5yZW1vdmVDaGlsZChrKS5zdHlsZS5kaXNwbGF5PSJub25lIn0pO2E9ZnVuY3Rpb24oayl7dmFyIG49DQpzLmNyZWF0ZUVsZW1lbnQoImRpdiIpO2s9Im9uIitrO3ZhciByPWsgaW4gbjtpZighcil7bi5zZXRBdHRyaWJ1dGUoaywicmV0dXJuOyIpO3I9dHlwZW9mIG5ba109PT0iZnVuY3Rpb24ifXJldHVybiByfTtjLnN1cHBvcnQuc3VibWl0QnViYmxlcz1hKCJzdWJtaXQiKTtjLnN1cHBvcnQuY2hhbmdlQnViYmxlcz1hKCJjaGFuZ2UiKTthPWI9ZD1lPWo9bnVsbH19KSgpO2MucHJvcHM9eyJmb3IiOiJodG1sRm9yIiwiY2xhc3MiOiJjbGFzc05hbWUiLHJlYWRvbmx5OiJyZWFkT25seSIsbWF4bGVuZ3RoOiJtYXhMZW5ndGgiLGNlbGxzcGFjaW5nOiJjZWxsU3BhY2luZyIscm93c3Bhbjoicm93U3BhbiIsY29sc3BhbjoiY29sU3BhbiIsdGFiaW5kZXg6InRhYkluZGV4Iix1c2VtYXA6InVzZU1hcCIsZnJhbWVib3JkZXI6ImZyYW1lQm9yZGVyIn07dmFyIEc9ImpRdWVyeSIrSigpLFlhPTAsemE9e307Yy5leHRlbmQoe2NhY2hlOnt9LGV4cGFuZG86Ryxub0RhdGE6e2VtYmVkOnRydWUsb2JqZWN0OnRydWUsDQphcHBsZXQ6dHJ1ZX0sZGF0YTpmdW5jdGlvbihhLGIsZCl7aWYoIShhLm5vZGVOYW1lJiZjLm5vRGF0YVthLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKSl7YT1hPT1BP3phOmE7dmFyIGY9YVtHXSxlPWMuY2FjaGU7aWYoIWYmJnR5cGVvZiBiPT09InN0cmluZyImJmQ9PT13KXJldHVybiBudWxsO2Z8fChmPSsrWWEpO2lmKHR5cGVvZiBiPT09Im9iamVjdCIpe2FbR109ZjtlW2ZdPWMuZXh0ZW5kKHRydWUse30sYil9ZWxzZSBpZighZVtmXSl7YVtHXT1mO2VbZl09e319YT1lW2ZdO2lmKGQhPT13KWFbYl09ZDtyZXR1cm4gdHlwZW9mIGI9PT0ic3RyaW5nIj9hW2JdOmF9fSxyZW1vdmVEYXRhOmZ1bmN0aW9uKGEsYil7aWYoIShhLm5vZGVOYW1lJiZjLm5vRGF0YVthLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKSl7YT1hPT1BP3phOmE7dmFyIGQ9YVtHXSxmPWMuY2FjaGUsZT1mW2RdO2lmKGIpe2lmKGUpe2RlbGV0ZSBlW2JdO2MuaXNFbXB0eU9iamVjdChlKSYmYy5yZW1vdmVEYXRhKGEpfX1lbHNle2lmKGMuc3VwcG9ydC5kZWxldGVFeHBhbmRvKWRlbGV0ZSBhW2MuZXhwYW5kb107DQplbHNlIGEucmVtb3ZlQXR0cmlidXRlJiZhLnJlbW92ZUF0dHJpYnV0ZShjLmV4cGFuZG8pO2RlbGV0ZSBmW2RdfX19fSk7Yy5mbi5leHRlbmQoe2RhdGE6ZnVuY3Rpb24oYSxiKXtpZih0eXBlb2YgYT09PSJ1bmRlZmluZWQiJiZ0aGlzLmxlbmd0aClyZXR1cm4gYy5kYXRhKHRoaXNbMF0pO2Vsc2UgaWYodHlwZW9mIGE9PT0ib2JqZWN0IilyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Yy5kYXRhKHRoaXMsYSl9KTt2YXIgZD1hLnNwbGl0KCIuIik7ZFsxXT1kWzFdPyIuIitkWzFdOiIiO2lmKGI9PT13KXt2YXIgZj10aGlzLnRyaWdnZXJIYW5kbGVyKCJnZXREYXRhIitkWzFdKyIhIixbZFswXV0pO2lmKGY9PT13JiZ0aGlzLmxlbmd0aClmPWMuZGF0YSh0aGlzWzBdLGEpO3JldHVybiBmPT09dyYmZFsxXT90aGlzLmRhdGEoZFswXSk6Zn1lbHNlIHJldHVybiB0aGlzLnRyaWdnZXIoInNldERhdGEiK2RbMV0rIiEiLFtkWzBdLGJdKS5lYWNoKGZ1bmN0aW9uKCl7Yy5kYXRhKHRoaXMsDQphLGIpfSl9LHJlbW92ZURhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2MucmVtb3ZlRGF0YSh0aGlzLGEpfSl9fSk7Yy5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGEsYixkKXtpZihhKXtiPShifHwiZngiKSsicXVldWUiO3ZhciBmPWMuZGF0YShhLGIpO2lmKCFkKXJldHVybiBmfHxbXTtpZighZnx8Yy5pc0FycmF5KGQpKWY9Yy5kYXRhKGEsYixjLm1ha2VBcnJheShkKSk7ZWxzZSBmLnB1c2goZCk7cmV0dXJuIGZ9fSxkZXF1ZXVlOmZ1bmN0aW9uKGEsYil7Yj1ifHwiZngiO3ZhciBkPWMucXVldWUoYSxiKSxmPWQuc2hpZnQoKTtpZihmPT09ImlucHJvZ3Jlc3MiKWY9ZC5zaGlmdCgpO2lmKGYpe2I9PT0iZngiJiZkLnVuc2hpZnQoImlucHJvZ3Jlc3MiKTtmLmNhbGwoYSxmdW5jdGlvbigpe2MuZGVxdWV1ZShhLGIpfSl9fX0pO2MuZm4uZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihhLGIpe2lmKHR5cGVvZiBhIT09InN0cmluZyIpe2I9YTthPSJmeCJ9aWYoYj09PQ0KdylyZXR1cm4gYy5xdWV1ZSh0aGlzWzBdLGEpO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgZD1jLnF1ZXVlKHRoaXMsYSxiKTthPT09ImZ4IiYmZFswXSE9PSJpbnByb2dyZXNzIiYmYy5kZXF1ZXVlKHRoaXMsYSl9KX0sZGVxdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Yy5kZXF1ZXVlKHRoaXMsYSl9KX0sZGVsYXk6ZnVuY3Rpb24oYSxiKXthPWMuZng/Yy5meC5zcGVlZHNbYV18fGE6YTtiPWJ8fCJmeCI7cmV0dXJuIHRoaXMucXVldWUoYixmdW5jdGlvbigpe3ZhciBkPXRoaXM7c2V0VGltZW91dChmdW5jdGlvbigpe2MuZGVxdWV1ZShkLGIpfSxhKX0pfSxjbGVhclF1ZXVlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnF1ZXVlKGF8fCJmeCIsW10pfX0pO3ZhciBBYT0vW1xuXHRdL2csY2E9L1xzKy8sWmE9L1xyL2csJGE9L2hyZWZ8c3JjfHN0eWxlLyxhYj0vKGJ1dHRvbnxpbnB1dCkvaSxiYj0vKGJ1dHRvbnxpbnB1dHxvYmplY3R8c2VsZWN0fHRleHRhcmVhKS9pLA0KY2I9L14oYXxhcmVhKSQvaSxCYT0vcmFkaW98Y2hlY2tib3gvO2MuZm4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIFgodGhpcyxhLGIsdHJ1ZSxjLmF0dHIpfSxyZW1vdmVBdHRyOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtjLmF0dHIodGhpcyxhLCIiKTt0aGlzLm5vZGVUeXBlPT09MSYmdGhpcy5yZW1vdmVBdHRyaWJ1dGUoYSl9KX0sYWRkQ2xhc3M6ZnVuY3Rpb24oYSl7aWYoYy5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24obil7dmFyIHI9Yyh0aGlzKTtyLmFkZENsYXNzKGEuY2FsbCh0aGlzLG4sci5hdHRyKCJjbGFzcyIpKSl9KTtpZihhJiZ0eXBlb2YgYT09PSJzdHJpbmciKWZvcih2YXIgYj0oYXx8IiIpLnNwbGl0KGNhKSxkPTAsZj10aGlzLmxlbmd0aDtkPGY7ZCsrKXt2YXIgZT10aGlzW2RdO2lmKGUubm9kZVR5cGU9PT0xKWlmKGUuY2xhc3NOYW1lKXtmb3IodmFyIGo9IiAiK2UuY2xhc3NOYW1lKyIgIiwNCmk9ZS5jbGFzc05hbWUsbz0wLGs9Yi5sZW5ndGg7bzxrO28rKylpZihqLmluZGV4T2YoIiAiK2Jbb10rIiAiKTwwKWkrPSIgIitiW29dO2UuY2xhc3NOYW1lPWMudHJpbShpKX1lbHNlIGUuY2xhc3NOYW1lPWF9cmV0dXJuIHRoaXN9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGEpe2lmKGMuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGspe3ZhciBuPWModGhpcyk7bi5yZW1vdmVDbGFzcyhhLmNhbGwodGhpcyxrLG4uYXR0cigiY2xhc3MiKSkpfSk7aWYoYSYmdHlwZW9mIGE9PT0ic3RyaW5nInx8YT09PXcpZm9yKHZhciBiPShhfHwiIikuc3BsaXQoY2EpLGQ9MCxmPXRoaXMubGVuZ3RoO2Q8ZjtkKyspe3ZhciBlPXRoaXNbZF07aWYoZS5ub2RlVHlwZT09PTEmJmUuY2xhc3NOYW1lKWlmKGEpe2Zvcih2YXIgaj0oIiAiK2UuY2xhc3NOYW1lKyIgIikucmVwbGFjZShBYSwiICIpLGk9MCxvPWIubGVuZ3RoO2k8bztpKyspaj1qLnJlcGxhY2UoIiAiK2JbaV0rIiAiLA0KIiAiKTtlLmNsYXNzTmFtZT1jLnRyaW0oail9ZWxzZSBlLmNsYXNzTmFtZT0iIn1yZXR1cm4gdGhpc30sdG9nZ2xlQ2xhc3M6ZnVuY3Rpb24oYSxiKXt2YXIgZD10eXBlb2YgYSxmPXR5cGVvZiBiPT09ImJvb2xlYW4iO2lmKGMuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGUpe3ZhciBqPWModGhpcyk7ai50b2dnbGVDbGFzcyhhLmNhbGwodGhpcyxlLGouYXR0cigiY2xhc3MiKSxiKSxiKX0pO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtpZihkPT09InN0cmluZyIpZm9yKHZhciBlLGo9MCxpPWModGhpcyksbz1iLGs9YS5zcGxpdChjYSk7ZT1rW2orK107KXtvPWY/bzohaS5oYXNDbGFzcyhlKTtpW28/ImFkZENsYXNzIjoicmVtb3ZlQ2xhc3MiXShlKX1lbHNlIGlmKGQ9PT0idW5kZWZpbmVkInx8ZD09PSJib29sZWFuIil7dGhpcy5jbGFzc05hbWUmJmMuZGF0YSh0aGlzLCJfX2NsYXNzTmFtZV9fIix0aGlzLmNsYXNzTmFtZSk7dGhpcy5jbGFzc05hbWU9DQp0aGlzLmNsYXNzTmFtZXx8YT09PWZhbHNlPyIiOmMuZGF0YSh0aGlzLCJfX2NsYXNzTmFtZV9fIil8fCIifX0pfSxoYXNDbGFzczpmdW5jdGlvbihhKXthPSIgIithKyIgIjtmb3IodmFyIGI9MCxkPXRoaXMubGVuZ3RoO2I8ZDtiKyspaWYoKCIgIit0aGlzW2JdLmNsYXNzTmFtZSsiICIpLnJlcGxhY2UoQWEsIiAiKS5pbmRleE9mKGEpPi0xKXJldHVybiB0cnVlO3JldHVybiBmYWxzZX0sdmFsOmZ1bmN0aW9uKGEpe2lmKGE9PT13KXt2YXIgYj10aGlzWzBdO2lmKGIpe2lmKGMubm9kZU5hbWUoYiwib3B0aW9uIikpcmV0dXJuKGIuYXR0cmlidXRlcy52YWx1ZXx8e30pLnNwZWNpZmllZD9iLnZhbHVlOmIudGV4dDtpZihjLm5vZGVOYW1lKGIsInNlbGVjdCIpKXt2YXIgZD1iLnNlbGVjdGVkSW5kZXgsZj1bXSxlPWIub3B0aW9ucztiPWIudHlwZT09PSJzZWxlY3Qtb25lIjtpZihkPDApcmV0dXJuIG51bGw7dmFyIGo9Yj9kOjA7Zm9yKGQ9Yj9kKzE6ZS5sZW5ndGg7ajxkO2orKyl7dmFyIGk9DQplW2pdO2lmKGkuc2VsZWN0ZWQpe2E9YyhpKS52YWwoKTtpZihiKXJldHVybiBhO2YucHVzaChhKX19cmV0dXJuIGZ9aWYoQmEudGVzdChiLnR5cGUpJiYhYy5zdXBwb3J0LmNoZWNrT24pcmV0dXJuIGIuZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpPT09bnVsbD8ib24iOmIudmFsdWU7cmV0dXJuKGIudmFsdWV8fCIiKS5yZXBsYWNlKFphLCIiKX1yZXR1cm4gd312YXIgbz1jLmlzRnVuY3Rpb24oYSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihrKXt2YXIgbj1jKHRoaXMpLHI9YTtpZih0aGlzLm5vZGVUeXBlPT09MSl7aWYobylyPWEuY2FsbCh0aGlzLGssbi52YWwoKSk7aWYodHlwZW9mIHI9PT0ibnVtYmVyIilyKz0iIjtpZihjLmlzQXJyYXkocikmJkJhLnRlc3QodGhpcy50eXBlKSl0aGlzLmNoZWNrZWQ9Yy5pbkFycmF5KG4udmFsKCkscik+PTA7ZWxzZSBpZihjLm5vZGVOYW1lKHRoaXMsInNlbGVjdCIpKXt2YXIgdT1jLm1ha2VBcnJheShyKTtjKCJvcHRpb24iLHRoaXMpLmVhY2goZnVuY3Rpb24oKXt0aGlzLnNlbGVjdGVkPQ0KYy5pbkFycmF5KGModGhpcykudmFsKCksdSk+PTB9KTtpZighdS5sZW5ndGgpdGhpcy5zZWxlY3RlZEluZGV4PS0xfWVsc2UgdGhpcy52YWx1ZT1yfX0pfX0pO2MuZXh0ZW5kKHthdHRyRm46e3ZhbDp0cnVlLGNzczp0cnVlLGh0bWw6dHJ1ZSx0ZXh0OnRydWUsZGF0YTp0cnVlLHdpZHRoOnRydWUsaGVpZ2h0OnRydWUsb2Zmc2V0OnRydWV9LGF0dHI6ZnVuY3Rpb24oYSxiLGQsZil7aWYoIWF8fGEubm9kZVR5cGU9PT0zfHxhLm5vZGVUeXBlPT09OClyZXR1cm4gdztpZihmJiZiIGluIGMuYXR0ckZuKXJldHVybiBjKGEpW2JdKGQpO2Y9YS5ub2RlVHlwZSE9PTF8fCFjLmlzWE1MRG9jKGEpO3ZhciBlPWQhPT13O2I9ZiYmYy5wcm9wc1tiXXx8YjtpZihhLm5vZGVUeXBlPT09MSl7dmFyIGo9JGEudGVzdChiKTtpZihiIGluIGEmJmYmJiFqKXtpZihlKXtiPT09InR5cGUiJiZhYi50ZXN0KGEubm9kZU5hbWUpJiZhLnBhcmVudE5vZGUmJmMuZXJyb3IoInR5cGUgcHJvcGVydHkgY2FuJ3QgYmUgY2hhbmdlZCIpOw0KYVtiXT1kfWlmKGMubm9kZU5hbWUoYSwiZm9ybSIpJiZhLmdldEF0dHJpYnV0ZU5vZGUoYikpcmV0dXJuIGEuZ2V0QXR0cmlidXRlTm9kZShiKS5ub2RlVmFsdWU7aWYoYj09PSJ0YWJJbmRleCIpcmV0dXJuKGI9YS5nZXRBdHRyaWJ1dGVOb2RlKCJ0YWJJbmRleCIpKSYmYi5zcGVjaWZpZWQ/Yi52YWx1ZTpiYi50ZXN0KGEubm9kZU5hbWUpfHxjYi50ZXN0KGEubm9kZU5hbWUpJiZhLmhyZWY/MDp3O3JldHVybiBhW2JdfWlmKCFjLnN1cHBvcnQuc3R5bGUmJmYmJmI9PT0ic3R5bGUiKXtpZihlKWEuc3R5bGUuY3NzVGV4dD0iIitkO3JldHVybiBhLnN0eWxlLmNzc1RleHR9ZSYmYS5zZXRBdHRyaWJ1dGUoYiwiIitkKTthPSFjLnN1cHBvcnQuaHJlZk5vcm1hbGl6ZWQmJmYmJmo/YS5nZXRBdHRyaWJ1dGUoYiwyKTphLmdldEF0dHJpYnV0ZShiKTtyZXR1cm4gYT09PW51bGw/dzphfXJldHVybiBjLnN0eWxlKGEsYixkKX19KTt2YXIgTz0vXC4oLiopJC8sZGI9ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZSgvW15cd1xzXC5cfGBdL2csDQpmdW5jdGlvbihiKXtyZXR1cm4iXFwiK2J9KX07Yy5ldmVudD17YWRkOmZ1bmN0aW9uKGEsYixkLGYpe2lmKCEoYS5ub2RlVHlwZT09PTN8fGEubm9kZVR5cGU9PT04KSl7aWYoYS5zZXRJbnRlcnZhbCYmYSE9PUEmJiFhLmZyYW1lRWxlbWVudClhPUE7dmFyIGUsajtpZihkLmhhbmRsZXIpe2U9ZDtkPWUuaGFuZGxlcn1pZighZC5ndWlkKWQuZ3VpZD1jLmd1aWQrKztpZihqPWMuZGF0YShhKSl7dmFyIGk9ai5ldmVudHM9ai5ldmVudHN8fHt9LG89ai5oYW5kbGU7aWYoIW8pai5oYW5kbGU9bz1mdW5jdGlvbigpe3JldHVybiB0eXBlb2YgYyE9PSJ1bmRlZmluZWQiJiYhYy5ldmVudC50cmlnZ2VyZWQ/Yy5ldmVudC5oYW5kbGUuYXBwbHkoby5lbGVtLGFyZ3VtZW50cyk6d307by5lbGVtPWE7Yj1iLnNwbGl0KCIgIik7Zm9yKHZhciBrLG49MCxyO2s9YltuKytdOyl7aj1lP2MuZXh0ZW5kKHt9LGUpOntoYW5kbGVyOmQsZGF0YTpmfTtpZihrLmluZGV4T2YoIi4iKT4tMSl7cj1rLnNwbGl0KCIuIik7DQprPXIuc2hpZnQoKTtqLm5hbWVzcGFjZT1yLnNsaWNlKDApLnNvcnQoKS5qb2luKCIuIil9ZWxzZXtyPVtdO2oubmFtZXNwYWNlPSIifWoudHlwZT1rO2ouZ3VpZD1kLmd1aWQ7dmFyIHU9aVtrXSx6PWMuZXZlbnQuc3BlY2lhbFtrXXx8e307aWYoIXUpe3U9aVtrXT1bXTtpZighei5zZXR1cHx8ei5zZXR1cC5jYWxsKGEsZixyLG8pPT09ZmFsc2UpaWYoYS5hZGRFdmVudExpc3RlbmVyKWEuYWRkRXZlbnRMaXN0ZW5lcihrLG8sZmFsc2UpO2Vsc2UgYS5hdHRhY2hFdmVudCYmYS5hdHRhY2hFdmVudCgib24iK2ssbyl9aWYoei5hZGQpe3ouYWRkLmNhbGwoYSxqKTtpZighai5oYW5kbGVyLmd1aWQpai5oYW5kbGVyLmd1aWQ9ZC5ndWlkfXUucHVzaChqKTtjLmV2ZW50Lmdsb2JhbFtrXT10cnVlfWE9bnVsbH19fSxnbG9iYWw6e30scmVtb3ZlOmZ1bmN0aW9uKGEsYixkLGYpe2lmKCEoYS5ub2RlVHlwZT09PTN8fGEubm9kZVR5cGU9PT04KSl7dmFyIGUsaj0wLGksbyxrLG4scix1LHo9Yy5kYXRhKGEpLA0KQz16JiZ6LmV2ZW50cztpZih6JiZDKXtpZihiJiZiLnR5cGUpe2Q9Yi5oYW5kbGVyO2I9Yi50eXBlfWlmKCFifHx0eXBlb2YgYj09PSJzdHJpbmciJiZiLmNoYXJBdCgwKT09PSIuIil7Yj1ifHwiIjtmb3IoZSBpbiBDKWMuZXZlbnQucmVtb3ZlKGEsZStiKX1lbHNle2ZvcihiPWIuc3BsaXQoIiAiKTtlPWJbaisrXTspe249ZTtpPWUuaW5kZXhPZigiLiIpPDA7bz1bXTtpZighaSl7bz1lLnNwbGl0KCIuIik7ZT1vLnNoaWZ0KCk7az1uZXcgUmVnRXhwKCIoXnxcXC4pIitjLm1hcChvLnNsaWNlKDApLnNvcnQoKSxkYikuam9pbigiXFwuKD86LipcXC4pPyIpKyIoXFwufCQpIil9aWYocj1DW2VdKWlmKGQpe249Yy5ldmVudC5zcGVjaWFsW2VdfHx7fTtmb3IoQj1mfHwwO0I8ci5sZW5ndGg7QisrKXt1PXJbQl07aWYoZC5ndWlkPT09dS5ndWlkKXtpZihpfHxrLnRlc3QodS5uYW1lc3BhY2UpKXtmPT1udWxsJiZyLnNwbGljZShCLS0sMSk7bi5yZW1vdmUmJm4ucmVtb3ZlLmNhbGwoYSx1KX1pZihmIT0NCm51bGwpYnJlYWt9fWlmKHIubGVuZ3RoPT09MHx8ZiE9bnVsbCYmci5sZW5ndGg9PT0xKXtpZighbi50ZWFyZG93bnx8bi50ZWFyZG93bi5jYWxsKGEsbyk9PT1mYWxzZSlDYShhLGUsei5oYW5kbGUpO2RlbGV0ZSBDW2VdfX1lbHNlIGZvcih2YXIgQj0wO0I8ci5sZW5ndGg7QisrKXt1PXJbQl07aWYoaXx8ay50ZXN0KHUubmFtZXNwYWNlKSl7Yy5ldmVudC5yZW1vdmUoYSxuLHUuaGFuZGxlcixCKTtyLnNwbGljZShCLS0sMSl9fX1pZihjLmlzRW1wdHlPYmplY3QoQykpe2lmKGI9ei5oYW5kbGUpYi5lbGVtPW51bGw7ZGVsZXRlIHouZXZlbnRzO2RlbGV0ZSB6LmhhbmRsZTtjLmlzRW1wdHlPYmplY3QoeikmJmMucmVtb3ZlRGF0YShhKX19fX19LHRyaWdnZXI6ZnVuY3Rpb24oYSxiLGQsZil7dmFyIGU9YS50eXBlfHxhO2lmKCFmKXthPXR5cGVvZiBhPT09Im9iamVjdCI/YVtHXT9hOmMuZXh0ZW5kKGMuRXZlbnQoZSksYSk6Yy5FdmVudChlKTtpZihlLmluZGV4T2YoIiEiKT49MCl7YS50eXBlPQ0KZT1lLnNsaWNlKDAsLTEpO2EuZXhjbHVzaXZlPXRydWV9aWYoIWQpe2Euc3RvcFByb3BhZ2F0aW9uKCk7Yy5ldmVudC5nbG9iYWxbZV0mJmMuZWFjaChjLmNhY2hlLGZ1bmN0aW9uKCl7dGhpcy5ldmVudHMmJnRoaXMuZXZlbnRzW2VdJiZjLmV2ZW50LnRyaWdnZXIoYSxiLHRoaXMuaGFuZGxlLmVsZW0pfSl9aWYoIWR8fGQubm9kZVR5cGU9PT0zfHxkLm5vZGVUeXBlPT09OClyZXR1cm4gdzthLnJlc3VsdD13O2EudGFyZ2V0PWQ7Yj1jLm1ha2VBcnJheShiKTtiLnVuc2hpZnQoYSl9YS5jdXJyZW50VGFyZ2V0PWQ7KGY9Yy5kYXRhKGQsImhhbmRsZSIpKSYmZi5hcHBseShkLGIpO2Y9ZC5wYXJlbnROb2RlfHxkLm93bmVyRG9jdW1lbnQ7dHJ5e2lmKCEoZCYmZC5ub2RlTmFtZSYmYy5ub0RhdGFbZC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSkpaWYoZFsib24iK2VdJiZkWyJvbiIrZV0uYXBwbHkoZCxiKT09PWZhbHNlKWEucmVzdWx0PWZhbHNlfWNhdGNoKGope31pZighYS5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpJiYNCmYpYy5ldmVudC50cmlnZ2VyKGEsYixmLHRydWUpO2Vsc2UgaWYoIWEuaXNEZWZhdWx0UHJldmVudGVkKCkpe2Y9YS50YXJnZXQ7dmFyIGksbz1jLm5vZGVOYW1lKGYsImEiKSYmZT09PSJjbGljayIsaz1jLmV2ZW50LnNwZWNpYWxbZV18fHt9O2lmKCghay5fZGVmYXVsdHx8ay5fZGVmYXVsdC5jYWxsKGQsYSk9PT1mYWxzZSkmJiFvJiYhKGYmJmYubm9kZU5hbWUmJmMubm9EYXRhW2Yubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0pKXt0cnl7aWYoZltlXSl7aWYoaT1mWyJvbiIrZV0pZlsib24iK2VdPW51bGw7Yy5ldmVudC50cmlnZ2VyZWQ9dHJ1ZTtmW2VdKCl9fWNhdGNoKG4pe31pZihpKWZbIm9uIitlXT1pO2MuZXZlbnQudHJpZ2dlcmVkPWZhbHNlfX19LGhhbmRsZTpmdW5jdGlvbihhKXt2YXIgYixkLGYsZTthPWFyZ3VtZW50c1swXT1jLmV2ZW50LmZpeChhfHxBLmV2ZW50KTthLmN1cnJlbnRUYXJnZXQ9dGhpcztiPWEudHlwZS5pbmRleE9mKCIuIik8MCYmIWEuZXhjbHVzaXZlOw0KaWYoIWIpe2Q9YS50eXBlLnNwbGl0KCIuIik7YS50eXBlPWQuc2hpZnQoKTtmPW5ldyBSZWdFeHAoIihefFxcLikiK2Quc2xpY2UoMCkuc29ydCgpLmpvaW4oIlxcLig/Oi4qXFwuKT8iKSsiKFxcLnwkKSIpfWU9Yy5kYXRhKHRoaXMsImV2ZW50cyIpO2Q9ZVthLnR5cGVdO2lmKGUmJmQpe2Q9ZC5zbGljZSgwKTtlPTA7Zm9yKHZhciBqPWQubGVuZ3RoO2U8ajtlKyspe3ZhciBpPWRbZV07aWYoYnx8Zi50ZXN0KGkubmFtZXNwYWNlKSl7YS5oYW5kbGVyPWkuaGFuZGxlcjthLmRhdGE9aS5kYXRhO2EuaGFuZGxlT2JqPWk7aT1pLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKGkhPT13KXthLnJlc3VsdD1pO2lmKGk9PT1mYWxzZSl7YS5wcmV2ZW50RGVmYXVsdCgpO2Euc3RvcFByb3BhZ2F0aW9uKCl9fWlmKGEuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSlicmVha319fXJldHVybiBhLnJlc3VsdH0scHJvcHM6ImFsdEtleSBhdHRyQ2hhbmdlIGF0dHJOYW1lIGJ1YmJsZXMgYnV0dG9uIGNhbmNlbGFibGUgY2hhckNvZGUgY2xpZW50WCBjbGllbnRZIGN0cmxLZXkgY3VycmVudFRhcmdldCBkYXRhIGRldGFpbCBldmVudFBoYXNlIGZyb21FbGVtZW50IGhhbmRsZXIga2V5Q29kZSBsYXllclggbGF5ZXJZIG1ldGFLZXkgbmV3VmFsdWUgb2Zmc2V0WCBvZmZzZXRZIG9yaWdpbmFsVGFyZ2V0IHBhZ2VYIHBhZ2VZIHByZXZWYWx1ZSByZWxhdGVkTm9kZSByZWxhdGVkVGFyZ2V0IHNjcmVlblggc2NyZWVuWSBzaGlmdEtleSBzcmNFbGVtZW50IHRhcmdldCB0b0VsZW1lbnQgdmlldyB3aGVlbERlbHRhIHdoaWNoIi5zcGxpdCgiICIpLA0KZml4OmZ1bmN0aW9uKGEpe2lmKGFbR10pcmV0dXJuIGE7dmFyIGI9YTthPWMuRXZlbnQoYik7Zm9yKHZhciBkPXRoaXMucHJvcHMubGVuZ3RoLGY7ZDspe2Y9dGhpcy5wcm9wc1stLWRdO2FbZl09YltmXX1pZighYS50YXJnZXQpYS50YXJnZXQ9YS5zcmNFbGVtZW50fHxzO2lmKGEudGFyZ2V0Lm5vZGVUeXBlPT09MylhLnRhcmdldD1hLnRhcmdldC5wYXJlbnROb2RlO2lmKCFhLnJlbGF0ZWRUYXJnZXQmJmEuZnJvbUVsZW1lbnQpYS5yZWxhdGVkVGFyZ2V0PWEuZnJvbUVsZW1lbnQ9PT1hLnRhcmdldD9hLnRvRWxlbWVudDphLmZyb21FbGVtZW50O2lmKGEucGFnZVg9PW51bGwmJmEuY2xpZW50WCE9bnVsbCl7Yj1zLmRvY3VtZW50RWxlbWVudDtkPXMuYm9keTthLnBhZ2VYPWEuY2xpZW50WCsoYiYmYi5zY3JvbGxMZWZ0fHxkJiZkLnNjcm9sbExlZnR8fDApLShiJiZiLmNsaWVudExlZnR8fGQmJmQuY2xpZW50TGVmdHx8MCk7YS5wYWdlWT1hLmNsaWVudFkrKGImJmIuc2Nyb2xsVG9wfHwNCmQmJmQuc2Nyb2xsVG9wfHwwKS0oYiYmYi5jbGllbnRUb3B8fGQmJmQuY2xpZW50VG9wfHwwKX1pZighYS53aGljaCYmKGEuY2hhckNvZGV8fGEuY2hhckNvZGU9PT0wP2EuY2hhckNvZGU6YS5rZXlDb2RlKSlhLndoaWNoPWEuY2hhckNvZGV8fGEua2V5Q29kZTtpZighYS5tZXRhS2V5JiZhLmN0cmxLZXkpYS5tZXRhS2V5PWEuY3RybEtleTtpZighYS53aGljaCYmYS5idXR0b24hPT13KWEud2hpY2g9YS5idXR0b24mMT8xOmEuYnV0dG9uJjI/MzphLmJ1dHRvbiY0PzI6MDtyZXR1cm4gYX0sZ3VpZDoxRTgscHJveHk6Yy5wcm94eSxzcGVjaWFsOntyZWFkeTp7c2V0dXA6Yy5iaW5kUmVhZHksdGVhcmRvd246Yy5ub29wfSxsaXZlOnthZGQ6ZnVuY3Rpb24oYSl7Yy5ldmVudC5hZGQodGhpcyxhLm9yaWdUeXBlLGMuZXh0ZW5kKHt9LGEse2hhbmRsZXI6b2F9KSl9LHJlbW92ZTpmdW5jdGlvbihhKXt2YXIgYj10cnVlLGQ9YS5vcmlnVHlwZS5yZXBsYWNlKE8sIiIpO2MuZWFjaChjLmRhdGEodGhpcywNCiJldmVudHMiKS5saXZlfHxbXSxmdW5jdGlvbigpe2lmKGQ9PT10aGlzLm9yaWdUeXBlLnJlcGxhY2UoTywiIikpcmV0dXJuIGI9ZmFsc2V9KTtiJiZjLmV2ZW50LnJlbW92ZSh0aGlzLGEub3JpZ1R5cGUsb2EpfX0sYmVmb3JldW5sb2FkOntzZXR1cDpmdW5jdGlvbihhLGIsZCl7aWYodGhpcy5zZXRJbnRlcnZhbCl0aGlzLm9uYmVmb3JldW5sb2FkPWQ7cmV0dXJuIGZhbHNlfSx0ZWFyZG93bjpmdW5jdGlvbihhLGIpe2lmKHRoaXMub25iZWZvcmV1bmxvYWQ9PT1iKXRoaXMub25iZWZvcmV1bmxvYWQ9bnVsbH19fX07dmFyIENhPXMucmVtb3ZlRXZlbnRMaXN0ZW5lcj9mdW5jdGlvbihhLGIsZCl7YS5yZW1vdmVFdmVudExpc3RlbmVyKGIsZCxmYWxzZSl9OmZ1bmN0aW9uKGEsYixkKXthLmRldGFjaEV2ZW50KCJvbiIrYixkKX07Yy5FdmVudD1mdW5jdGlvbihhKXtpZighdGhpcy5wcmV2ZW50RGVmYXVsdClyZXR1cm4gbmV3IGMuRXZlbnQoYSk7aWYoYSYmYS50eXBlKXt0aGlzLm9yaWdpbmFsRXZlbnQ9DQphO3RoaXMudHlwZT1hLnR5cGV9ZWxzZSB0aGlzLnR5cGU9YTt0aGlzLnRpbWVTdGFtcD1KKCk7dGhpc1tHXT10cnVlfTtjLkV2ZW50LnByb3RvdHlwZT17cHJldmVudERlZmF1bHQ6ZnVuY3Rpb24oKXt0aGlzLmlzRGVmYXVsdFByZXZlbnRlZD1aO3ZhciBhPXRoaXMub3JpZ2luYWxFdmVudDtpZihhKXthLnByZXZlbnREZWZhdWx0JiZhLnByZXZlbnREZWZhdWx0KCk7YS5yZXR1cm5WYWx1ZT1mYWxzZX19LHN0b3BQcm9wYWdhdGlvbjpmdW5jdGlvbigpe3RoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQ9Wjt2YXIgYT10aGlzLm9yaWdpbmFsRXZlbnQ7aWYoYSl7YS5zdG9wUHJvcGFnYXRpb24mJmEuc3RvcFByb3BhZ2F0aW9uKCk7YS5jYW5jZWxCdWJibGU9dHJ1ZX19LHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjpmdW5jdGlvbigpe3RoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9Wjt0aGlzLnN0b3BQcm9wYWdhdGlvbigpfSxpc0RlZmF1bHRQcmV2ZW50ZWQ6WSxpc1Byb3BhZ2F0aW9uU3RvcHBlZDpZLA0KaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6WX07dmFyIERhPWZ1bmN0aW9uKGEpe3ZhciBiPWEucmVsYXRlZFRhcmdldDt0cnl7Zm9yKDtiJiZiIT09dGhpczspYj1iLnBhcmVudE5vZGU7aWYoYiE9PXRoaXMpe2EudHlwZT1hLmRhdGE7Yy5ldmVudC5oYW5kbGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX1jYXRjaChkKXt9fSxFYT1mdW5jdGlvbihhKXthLnR5cGU9YS5kYXRhO2MuZXZlbnQuaGFuZGxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX07Yy5lYWNoKHttb3VzZWVudGVyOiJtb3VzZW92ZXIiLG1vdXNlbGVhdmU6Im1vdXNlb3V0In0sZnVuY3Rpb24oYSxiKXtjLmV2ZW50LnNwZWNpYWxbYV09e3NldHVwOmZ1bmN0aW9uKGQpe2MuZXZlbnQuYWRkKHRoaXMsYixkJiZkLnNlbGVjdG9yP0VhOkRhLGEpfSx0ZWFyZG93bjpmdW5jdGlvbihkKXtjLmV2ZW50LnJlbW92ZSh0aGlzLGIsZCYmZC5zZWxlY3Rvcj9FYTpEYSl9fX0pO2lmKCFjLnN1cHBvcnQuc3VibWl0QnViYmxlcyljLmV2ZW50LnNwZWNpYWwuc3VibWl0PQ0Ke3NldHVwOmZ1bmN0aW9uKCl7aWYodGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpIT09ImZvcm0iKXtjLmV2ZW50LmFkZCh0aGlzLCJjbGljay5zcGVjaWFsU3VibWl0IixmdW5jdGlvbihhKXt2YXIgYj1hLnRhcmdldCxkPWIudHlwZTtpZigoZD09PSJzdWJtaXQifHxkPT09ImltYWdlIikmJmMoYikuY2xvc2VzdCgiZm9ybSIpLmxlbmd0aClyZXR1cm4gbmEoInN1Ym1pdCIsdGhpcyxhcmd1bWVudHMpfSk7Yy5ldmVudC5hZGQodGhpcywia2V5cHJlc3Muc3BlY2lhbFN1Ym1pdCIsZnVuY3Rpb24oYSl7dmFyIGI9YS50YXJnZXQsZD1iLnR5cGU7aWYoKGQ9PT0idGV4dCJ8fGQ9PT0icGFzc3dvcmQiKSYmYyhiKS5jbG9zZXN0KCJmb3JtIikubGVuZ3RoJiZhLmtleUNvZGU9PT0xMylyZXR1cm4gbmEoInN1Ym1pdCIsdGhpcyxhcmd1bWVudHMpfSl9ZWxzZSByZXR1cm4gZmFsc2V9LHRlYXJkb3duOmZ1bmN0aW9uKCl7Yy5ldmVudC5yZW1vdmUodGhpcywiLnNwZWNpYWxTdWJtaXQiKX19Ow0KaWYoIWMuc3VwcG9ydC5jaGFuZ2VCdWJibGVzKXt2YXIgZGE9L3RleHRhcmVhfGlucHV0fHNlbGVjdC9pLGVhLEZhPWZ1bmN0aW9uKGEpe3ZhciBiPWEudHlwZSxkPWEudmFsdWU7aWYoYj09PSJyYWRpbyJ8fGI9PT0iY2hlY2tib3giKWQ9YS5jaGVja2VkO2Vsc2UgaWYoYj09PSJzZWxlY3QtbXVsdGlwbGUiKWQ9YS5zZWxlY3RlZEluZGV4Pi0xP2MubWFwKGEub3B0aW9ucyxmdW5jdGlvbihmKXtyZXR1cm4gZi5zZWxlY3RlZH0pLmpvaW4oIi0iKToiIjtlbHNlIGlmKGEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PSJzZWxlY3QiKWQ9YS5zZWxlY3RlZEluZGV4O3JldHVybiBkfSxmYT1mdW5jdGlvbihhLGIpe3ZhciBkPWEudGFyZ2V0LGYsZTtpZighKCFkYS50ZXN0KGQubm9kZU5hbWUpfHxkLnJlYWRPbmx5KSl7Zj1jLmRhdGEoZCwiX2NoYW5nZV9kYXRhIik7ZT1GYShkKTtpZihhLnR5cGUhPT0iZm9jdXNvdXQifHxkLnR5cGUhPT0icmFkaW8iKWMuZGF0YShkLCJfY2hhbmdlX2RhdGEiLA0KZSk7aWYoIShmPT09d3x8ZT09PWYpKWlmKGYhPW51bGx8fGUpe2EudHlwZT0iY2hhbmdlIjtyZXR1cm4gYy5ldmVudC50cmlnZ2VyKGEsYixkKX19fTtjLmV2ZW50LnNwZWNpYWwuY2hhbmdlPXtmaWx0ZXJzOntmb2N1c291dDpmYSxjbGljazpmdW5jdGlvbihhKXt2YXIgYj1hLnRhcmdldCxkPWIudHlwZTtpZihkPT09InJhZGlvInx8ZD09PSJjaGVja2JveCJ8fGIubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PSJzZWxlY3QiKXJldHVybiBmYS5jYWxsKHRoaXMsYSl9LGtleWRvd246ZnVuY3Rpb24oYSl7dmFyIGI9YS50YXJnZXQsZD1iLnR5cGU7aWYoYS5rZXlDb2RlPT09MTMmJmIubm9kZU5hbWUudG9Mb3dlckNhc2UoKSE9PSJ0ZXh0YXJlYSJ8fGEua2V5Q29kZT09PTMyJiYoZD09PSJjaGVja2JveCJ8fGQ9PT0icmFkaW8iKXx8ZD09PSJzZWxlY3QtbXVsdGlwbGUiKXJldHVybiBmYS5jYWxsKHRoaXMsYSl9LGJlZm9yZWFjdGl2YXRlOmZ1bmN0aW9uKGEpe2E9YS50YXJnZXQ7Yy5kYXRhKGEsDQoiX2NoYW5nZV9kYXRhIixGYShhKSl9fSxzZXR1cDpmdW5jdGlvbigpe2lmKHRoaXMudHlwZT09PSJmaWxlIilyZXR1cm4gZmFsc2U7Zm9yKHZhciBhIGluIGVhKWMuZXZlbnQuYWRkKHRoaXMsYSsiLnNwZWNpYWxDaGFuZ2UiLGVhW2FdKTtyZXR1cm4gZGEudGVzdCh0aGlzLm5vZGVOYW1lKX0sdGVhcmRvd246ZnVuY3Rpb24oKXtjLmV2ZW50LnJlbW92ZSh0aGlzLCIuc3BlY2lhbENoYW5nZSIpO3JldHVybiBkYS50ZXN0KHRoaXMubm9kZU5hbWUpfX07ZWE9Yy5ldmVudC5zcGVjaWFsLmNoYW5nZS5maWx0ZXJzfXMuYWRkRXZlbnRMaXN0ZW5lciYmYy5lYWNoKHtmb2N1czoiZm9jdXNpbiIsYmx1cjoiZm9jdXNvdXQifSxmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGQoZil7Zj1jLmV2ZW50LmZpeChmKTtmLnR5cGU9YjtyZXR1cm4gYy5ldmVudC5oYW5kbGUuY2FsbCh0aGlzLGYpfWMuZXZlbnQuc3BlY2lhbFtiXT17c2V0dXA6ZnVuY3Rpb24oKXt0aGlzLmFkZEV2ZW50TGlzdGVuZXIoYSwNCmQsdHJ1ZSl9LHRlYXJkb3duOmZ1bmN0aW9uKCl7dGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKGEsZCx0cnVlKX19fSk7Yy5lYWNoKFsiYmluZCIsIm9uZSJdLGZ1bmN0aW9uKGEsYil7Yy5mbltiXT1mdW5jdGlvbihkLGYsZSl7aWYodHlwZW9mIGQ9PT0ib2JqZWN0Iil7Zm9yKHZhciBqIGluIGQpdGhpc1tiXShqLGYsZFtqXSxlKTtyZXR1cm4gdGhpc31pZihjLmlzRnVuY3Rpb24oZikpe2U9ZjtmPXd9dmFyIGk9Yj09PSJvbmUiP2MucHJveHkoZSxmdW5jdGlvbihrKXtjKHRoaXMpLnVuYmluZChrLGkpO3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pOmU7aWYoZD09PSJ1bmxvYWQiJiZiIT09Im9uZSIpdGhpcy5vbmUoZCxmLGUpO2Vsc2V7aj0wO2Zvcih2YXIgbz10aGlzLmxlbmd0aDtqPG87aisrKWMuZXZlbnQuYWRkKHRoaXNbal0sZCxpLGYpfXJldHVybiB0aGlzfX0pO2MuZm4uZXh0ZW5kKHt1bmJpbmQ6ZnVuY3Rpb24oYSxiKXtpZih0eXBlb2YgYT09PSJvYmplY3QiJiYNCiFhLnByZXZlbnREZWZhdWx0KWZvcih2YXIgZCBpbiBhKXRoaXMudW5iaW5kKGQsYVtkXSk7ZWxzZXtkPTA7Zm9yKHZhciBmPXRoaXMubGVuZ3RoO2Q8ZjtkKyspYy5ldmVudC5yZW1vdmUodGhpc1tkXSxhLGIpfXJldHVybiB0aGlzfSxkZWxlZ2F0ZTpmdW5jdGlvbihhLGIsZCxmKXtyZXR1cm4gdGhpcy5saXZlKGIsZCxmLGEpfSx1bmRlbGVnYXRlOmZ1bmN0aW9uKGEsYixkKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD09PTA/dGhpcy51bmJpbmQoImxpdmUiKTp0aGlzLmRpZShiLG51bGwsZCxhKX0sdHJpZ2dlcjpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtjLmV2ZW50LnRyaWdnZXIoYSxiLHRoaXMpfSl9LHRyaWdnZXJIYW5kbGVyOmZ1bmN0aW9uKGEsYil7aWYodGhpc1swXSl7YT1jLkV2ZW50KGEpO2EucHJldmVudERlZmF1bHQoKTthLnN0b3BQcm9wYWdhdGlvbigpO2MuZXZlbnQudHJpZ2dlcihhLGIsdGhpc1swXSk7cmV0dXJuIGEucmVzdWx0fX0sDQp0b2dnbGU6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWFyZ3VtZW50cyxkPTE7ZDxiLmxlbmd0aDspYy5wcm94eShhLGJbZCsrXSk7cmV0dXJuIHRoaXMuY2xpY2soYy5wcm94eShhLGZ1bmN0aW9uKGYpe3ZhciBlPShjLmRhdGEodGhpcywibGFzdFRvZ2dsZSIrYS5ndWlkKXx8MCklZDtjLmRhdGEodGhpcywibGFzdFRvZ2dsZSIrYS5ndWlkLGUrMSk7Zi5wcmV2ZW50RGVmYXVsdCgpO3JldHVybiBiW2VdLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8ZmFsc2V9KSl9LGhvdmVyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMubW91c2VlbnRlcihhKS5tb3VzZWxlYXZlKGJ8fGEpfX0pO3ZhciBHYT17Zm9jdXM6ImZvY3VzaW4iLGJsdXI6ImZvY3Vzb3V0Iixtb3VzZWVudGVyOiJtb3VzZW92ZXIiLG1vdXNlbGVhdmU6Im1vdXNlb3V0In07Yy5lYWNoKFsibGl2ZSIsImRpZSJdLGZ1bmN0aW9uKGEsYil7Yy5mbltiXT1mdW5jdGlvbihkLGYsZSxqKXt2YXIgaSxvPTAsayxuLHI9anx8dGhpcy5zZWxlY3RvciwNCnU9aj90aGlzOmModGhpcy5jb250ZXh0KTtpZihjLmlzRnVuY3Rpb24oZikpe2U9ZjtmPXd9Zm9yKGQ9KGR8fCIiKS5zcGxpdCgiICIpOyhpPWRbbysrXSkhPW51bGw7KXtqPU8uZXhlYyhpKTtrPSIiO2lmKGope2s9alswXTtpPWkucmVwbGFjZShPLCIiKX1pZihpPT09ImhvdmVyIilkLnB1c2goIm1vdXNlZW50ZXIiK2ssIm1vdXNlbGVhdmUiK2spO2Vsc2V7bj1pO2lmKGk9PT0iZm9jdXMifHxpPT09ImJsdXIiKXtkLnB1c2goR2FbaV0rayk7aSs9a31lbHNlIGk9KEdhW2ldfHxpKStrO2I9PT0ibGl2ZSI/dS5lYWNoKGZ1bmN0aW9uKCl7Yy5ldmVudC5hZGQodGhpcyxwYShpLHIpLHtkYXRhOmYsc2VsZWN0b3I6cixoYW5kbGVyOmUsb3JpZ1R5cGU6aSxvcmlnSGFuZGxlcjplLHByZVR5cGU6bn0pfSk6dS51bmJpbmQocGEoaSxyKSxlKX19cmV0dXJuIHRoaXN9fSk7Yy5lYWNoKCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgbG9hZCByZXNpemUgc2Nyb2xsIHVubG9hZCBjbGljayBkYmxjbGljayBtb3VzZWRvd24gbW91c2V1cCBtb3VzZW1vdmUgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZW50ZXIgbW91c2VsZWF2ZSBjaGFuZ2Ugc2VsZWN0IHN1Ym1pdCBrZXlkb3duIGtleXByZXNzIGtleXVwIGVycm9yIi5zcGxpdCgiICIpLA0KZnVuY3Rpb24oYSxiKXtjLmZuW2JdPWZ1bmN0aW9uKGQpe3JldHVybiBkP3RoaXMuYmluZChiLGQpOnRoaXMudHJpZ2dlcihiKX07aWYoYy5hdHRyRm4pYy5hdHRyRm5bYl09dHJ1ZX0pO0EuYXR0YWNoRXZlbnQmJiFBLmFkZEV2ZW50TGlzdGVuZXImJkEuYXR0YWNoRXZlbnQoIm9udW5sb2FkIixmdW5jdGlvbigpe2Zvcih2YXIgYSBpbiBjLmNhY2hlKWlmKGMuY2FjaGVbYV0uaGFuZGxlKXRyeXtjLmV2ZW50LnJlbW92ZShjLmNhY2hlW2FdLmhhbmRsZS5lbGVtKX1jYXRjaChiKXt9fSk7KGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShnKXtmb3IodmFyIGg9IiIsbCxtPTA7Z1ttXTttKyspe2w9Z1ttXTtpZihsLm5vZGVUeXBlPT09M3x8bC5ub2RlVHlwZT09PTQpaCs9bC5ub2RlVmFsdWU7ZWxzZSBpZihsLm5vZGVUeXBlIT09OCloKz1hKGwuY2hpbGROb2Rlcyl9cmV0dXJuIGh9ZnVuY3Rpb24gYihnLGgsbCxtLHEscCl7cT0wO2Zvcih2YXIgdj1tLmxlbmd0aDtxPHY7cSsrKXt2YXIgdD1tW3FdOw0KaWYodCl7dD10W2ddO2Zvcih2YXIgeT1mYWxzZTt0Oyl7aWYodC5zaXpjYWNoZT09PWwpe3k9bVt0LnNpenNldF07YnJlYWt9aWYodC5ub2RlVHlwZT09PTEmJiFwKXt0LnNpemNhY2hlPWw7dC5zaXpzZXQ9cX1pZih0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1oKXt5PXQ7YnJlYWt9dD10W2ddfW1bcV09eX19fWZ1bmN0aW9uIGQoZyxoLGwsbSxxLHApe3E9MDtmb3IodmFyIHY9bS5sZW5ndGg7cTx2O3ErKyl7dmFyIHQ9bVtxXTtpZih0KXt0PXRbZ107Zm9yKHZhciB5PWZhbHNlO3Q7KXtpZih0LnNpemNhY2hlPT09bCl7eT1tW3Quc2l6c2V0XTticmVha31pZih0Lm5vZGVUeXBlPT09MSl7aWYoIXApe3Quc2l6Y2FjaGU9bDt0LnNpenNldD1xfWlmKHR5cGVvZiBoIT09InN0cmluZyIpe2lmKHQ9PT1oKXt5PXRydWU7YnJlYWt9fWVsc2UgaWYoay5maWx0ZXIoaCxbdF0pLmxlbmd0aD4wKXt5PXQ7YnJlYWt9fXQ9dFtnXX1tW3FdPXl9fX12YXIgZj0vKCg/OlwoKD86XChbXigpXStcKXxbXigpXSspK1wpfFxbKD86XFtbXltcXV0qXF18WyciXVteJyJdKlsnIl18W15bXF0nIl0rKStcXXxcXC58W14gPit+LChcW1xcXSspK3xbPit+XSkoXHMqLFxzKik/KCg/Oi58XHJ8XG4pKikvZywNCmU9MCxqPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsaT1mYWxzZSxvPXRydWU7WzAsMF0uc29ydChmdW5jdGlvbigpe289ZmFsc2U7cmV0dXJuIDB9KTt2YXIgaz1mdW5jdGlvbihnLGgsbCxtKXtsPWx8fFtdO3ZhciBxPWg9aHx8cztpZihoLm5vZGVUeXBlIT09MSYmaC5ub2RlVHlwZSE9PTkpcmV0dXJuW107aWYoIWd8fHR5cGVvZiBnIT09InN0cmluZyIpcmV0dXJuIGw7Zm9yKHZhciBwPVtdLHYsdCx5LFMsSD10cnVlLE09eChoKSxJPWc7KGYuZXhlYygiIiksdj1mLmV4ZWMoSSkpIT09bnVsbDspe0k9dlszXTtwLnB1c2godlsxXSk7aWYodlsyXSl7Uz12WzNdO2JyZWFrfX1pZihwLmxlbmd0aD4xJiZyLmV4ZWMoZykpaWYocC5sZW5ndGg9PT0yJiZuLnJlbGF0aXZlW3BbMF1dKXQ9Z2EocFswXStwWzFdLGgpO2Vsc2UgZm9yKHQ9bi5yZWxhdGl2ZVtwWzBdXT9baF06ayhwLnNoaWZ0KCksaCk7cC5sZW5ndGg7KXtnPXAuc2hpZnQoKTtpZihuLnJlbGF0aXZlW2ddKWcrPXAuc2hpZnQoKTsNCnQ9Z2EoZyx0KX1lbHNle2lmKCFtJiZwLmxlbmd0aD4xJiZoLm5vZGVUeXBlPT09OSYmIU0mJm4ubWF0Y2guSUQudGVzdChwWzBdKSYmIW4ubWF0Y2guSUQudGVzdChwW3AubGVuZ3RoLTFdKSl7dj1rLmZpbmQocC5zaGlmdCgpLGgsTSk7aD12LmV4cHI/ay5maWx0ZXIodi5leHByLHYuc2V0KVswXTp2LnNldFswXX1pZihoKXt2PW0/e2V4cHI6cC5wb3AoKSxzZXQ6eihtKX06ay5maW5kKHAucG9wKCkscC5sZW5ndGg9PT0xJiYocFswXT09PSJ+Inx8cFswXT09PSIrIikmJmgucGFyZW50Tm9kZT9oLnBhcmVudE5vZGU6aCxNKTt0PXYuZXhwcj9rLmZpbHRlcih2LmV4cHIsdi5zZXQpOnYuc2V0O2lmKHAubGVuZ3RoPjApeT16KHQpO2Vsc2UgSD1mYWxzZTtmb3IoO3AubGVuZ3RoOyl7dmFyIEQ9cC5wb3AoKTt2PUQ7aWYobi5yZWxhdGl2ZVtEXSl2PXAucG9wKCk7ZWxzZSBEPSIiO2lmKHY9PW51bGwpdj1oO24ucmVsYXRpdmVbRF0oeSx2LE0pfX1lbHNlIHk9W119eXx8KHk9dCk7eXx8ay5lcnJvcihEfHwNCmcpO2lmKGouY2FsbCh5KT09PSJbb2JqZWN0IEFycmF5XSIpaWYoSClpZihoJiZoLm5vZGVUeXBlPT09MSlmb3IoZz0wO3lbZ10hPW51bGw7ZysrKXtpZih5W2ddJiYoeVtnXT09PXRydWV8fHlbZ10ubm9kZVR5cGU9PT0xJiZFKGgseVtnXSkpKWwucHVzaCh0W2ddKX1lbHNlIGZvcihnPTA7eVtnXSE9bnVsbDtnKyspeVtnXSYmeVtnXS5ub2RlVHlwZT09PTEmJmwucHVzaCh0W2ddKTtlbHNlIGwucHVzaC5hcHBseShsLHkpO2Vsc2Ugeih5LGwpO2lmKFMpe2soUyxxLGwsbSk7ay51bmlxdWVTb3J0KGwpfXJldHVybiBsfTtrLnVuaXF1ZVNvcnQ9ZnVuY3Rpb24oZyl7aWYoQil7aT1vO2cuc29ydChCKTtpZihpKWZvcih2YXIgaD0xO2g8Zy5sZW5ndGg7aCsrKWdbaF09PT1nW2gtMV0mJmcuc3BsaWNlKGgtLSwxKX1yZXR1cm4gZ307ay5tYXRjaGVzPWZ1bmN0aW9uKGcsaCl7cmV0dXJuIGsoZyxudWxsLG51bGwsaCl9O2suZmluZD1mdW5jdGlvbihnLGgsbCl7dmFyIG0scTtpZighZylyZXR1cm5bXTsNCmZvcih2YXIgcD0wLHY9bi5vcmRlci5sZW5ndGg7cDx2O3ArKyl7dmFyIHQ9bi5vcmRlcltwXTtpZihxPW4ubGVmdE1hdGNoW3RdLmV4ZWMoZykpe3ZhciB5PXFbMV07cS5zcGxpY2UoMSwxKTtpZih5LnN1YnN0cih5Lmxlbmd0aC0xKSE9PSJcXCIpe3FbMV09KHFbMV18fCIiKS5yZXBsYWNlKC9cXC9nLCIiKTttPW4uZmluZFt0XShxLGgsbCk7aWYobSE9bnVsbCl7Zz1nLnJlcGxhY2Uobi5tYXRjaFt0XSwiIik7YnJlYWt9fX19bXx8KG09aC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpKTtyZXR1cm57c2V0Om0sZXhwcjpnfX07ay5maWx0ZXI9ZnVuY3Rpb24oZyxoLGwsbSl7Zm9yKHZhciBxPWcscD1bXSx2PWgsdCx5LFM9aCYmaFswXSYmeChoWzBdKTtnJiZoLmxlbmd0aDspe2Zvcih2YXIgSCBpbiBuLmZpbHRlcilpZigodD1uLmxlZnRNYXRjaFtIXS5leGVjKGcpKSE9bnVsbCYmdFsyXSl7dmFyIE09bi5maWx0ZXJbSF0sSSxEO0Q9dFsxXTt5PWZhbHNlO3Quc3BsaWNlKDEsMSk7aWYoRC5zdWJzdHIoRC5sZW5ndGgtDQoxKSE9PSJcXCIpe2lmKHY9PT1wKXA9W107aWYobi5wcmVGaWx0ZXJbSF0paWYodD1uLnByZUZpbHRlcltIXSh0LHYsbCxwLG0sUykpe2lmKHQ9PT10cnVlKWNvbnRpbnVlfWVsc2UgeT1JPXRydWU7aWYodClmb3IodmFyIFU9MDsoRD12W1VdKSE9bnVsbDtVKyspaWYoRCl7ST1NKEQsdCxVLHYpO3ZhciBIYT1tXiEhSTtpZihsJiZJIT1udWxsKWlmKEhhKXk9dHJ1ZTtlbHNlIHZbVV09ZmFsc2U7ZWxzZSBpZihIYSl7cC5wdXNoKEQpO3k9dHJ1ZX19aWYoSSE9PXcpe2x8fCh2PXApO2c9Zy5yZXBsYWNlKG4ubWF0Y2hbSF0sIiIpO2lmKCF5KXJldHVybltdO2JyZWFrfX19aWYoZz09PXEpaWYoeT09bnVsbClrLmVycm9yKGcpO2Vsc2UgYnJlYWs7cT1nfXJldHVybiB2fTtrLmVycm9yPWZ1bmN0aW9uKGcpe3Rocm93IlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246ICIrZzt9O3ZhciBuPWsuc2VsZWN0b3JzPXtvcmRlcjpbIklEIiwiTkFNRSIsIlRBRyJdLG1hdGNoOntJRDovIygoPzpbXHdcdTAwYzAtXHVGRkZGLV18XFwuKSspLywNCkNMQVNTOi9cLigoPzpbXHdcdTAwYzAtXHVGRkZGLV18XFwuKSspLyxOQU1FOi9cW25hbWU9WyciXSooKD86W1x3XHUwMGMwLVx1RkZGRi1dfFxcLikrKVsnIl0qXF0vLEFUVFI6L1xbXHMqKCg/Oltcd1x1MDBjMC1cdUZGRkYtXXxcXC4pKylccyooPzooXFM/PSlccyooWyciXSopKC4qPylcM3wpXHMqXF0vLFRBRzovXigoPzpbXHdcdTAwYzAtXHVGRkZGXCotXXxcXC4pKykvLENISUxEOi86KG9ubHl8bnRofGxhc3R8Zmlyc3QpLWNoaWxkKD86XCgoZXZlbnxvZGR8W1xkbistXSopXCkpPy8sUE9TOi86KG50aHxlcXxndHxsdHxmaXJzdHxsYXN0fGV2ZW58b2RkKSg/OlwoKFxkKilcKSk/KD89W14tXXwkKS8sUFNFVURPOi86KCg/Oltcd1x1MDBjMC1cdUZGRkYtXXxcXC4pKykoPzpcKChbJyJdPykoKD86XChbXlwpXStcKXxbXlwoXCldKikrKVwyXCkpPy99LGxlZnRNYXRjaDp7fSxhdHRyTWFwOnsiY2xhc3MiOiJjbGFzc05hbWUiLCJmb3IiOiJodG1sRm9yIn0sYXR0ckhhbmRsZTp7aHJlZjpmdW5jdGlvbihnKXtyZXR1cm4gZy5nZXRBdHRyaWJ1dGUoImhyZWYiKX19LA0KcmVsYXRpdmU6eyIrIjpmdW5jdGlvbihnLGgpe3ZhciBsPXR5cGVvZiBoPT09InN0cmluZyIsbT1sJiYhL1xXLy50ZXN0KGgpO2w9bCYmIW07aWYobSloPWgudG9Mb3dlckNhc2UoKTttPTA7Zm9yKHZhciBxPWcubGVuZ3RoLHA7bTxxO20rKylpZihwPWdbbV0pe2Zvcig7KHA9cC5wcmV2aW91c1NpYmxpbmcpJiZwLm5vZGVUeXBlIT09MTspO2dbbV09bHx8cCYmcC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09aD9wfHxmYWxzZTpwPT09aH1sJiZrLmZpbHRlcihoLGcsdHJ1ZSl9LCI+IjpmdW5jdGlvbihnLGgpe3ZhciBsPXR5cGVvZiBoPT09InN0cmluZyI7aWYobCYmIS9cVy8udGVzdChoKSl7aD1oLnRvTG93ZXJDYXNlKCk7Zm9yKHZhciBtPTAscT1nLmxlbmd0aDttPHE7bSsrKXt2YXIgcD1nW21dO2lmKHApe2w9cC5wYXJlbnROb2RlO2dbbV09bC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09aD9sOmZhbHNlfX19ZWxzZXttPTA7Zm9yKHE9Zy5sZW5ndGg7bTxxO20rKylpZihwPWdbbV0pZ1ttXT0NCmw/cC5wYXJlbnROb2RlOnAucGFyZW50Tm9kZT09PWg7bCYmay5maWx0ZXIoaCxnLHRydWUpfX0sIiI6ZnVuY3Rpb24oZyxoLGwpe3ZhciBtPWUrKyxxPWQ7aWYodHlwZW9mIGg9PT0ic3RyaW5nIiYmIS9cVy8udGVzdChoKSl7dmFyIHA9aD1oLnRvTG93ZXJDYXNlKCk7cT1ifXEoInBhcmVudE5vZGUiLGgsbSxnLHAsbCl9LCJ+IjpmdW5jdGlvbihnLGgsbCl7dmFyIG09ZSsrLHE9ZDtpZih0eXBlb2YgaD09PSJzdHJpbmciJiYhL1xXLy50ZXN0KGgpKXt2YXIgcD1oPWgudG9Mb3dlckNhc2UoKTtxPWJ9cSgicHJldmlvdXNTaWJsaW5nIixoLG0sZyxwLGwpfX0sZmluZDp7SUQ6ZnVuY3Rpb24oZyxoLGwpe2lmKHR5cGVvZiBoLmdldEVsZW1lbnRCeUlkIT09InVuZGVmaW5lZCImJiFsKXJldHVybihnPWguZ2V0RWxlbWVudEJ5SWQoZ1sxXSkpP1tnXTpbXX0sTkFNRTpmdW5jdGlvbihnLGgpe2lmKHR5cGVvZiBoLmdldEVsZW1lbnRzQnlOYW1lIT09InVuZGVmaW5lZCIpe3ZhciBsPVtdOw0KaD1oLmdldEVsZW1lbnRzQnlOYW1lKGdbMV0pO2Zvcih2YXIgbT0wLHE9aC5sZW5ndGg7bTxxO20rKyloW21dLmdldEF0dHJpYnV0ZSgibmFtZSIpPT09Z1sxXSYmbC5wdXNoKGhbbV0pO3JldHVybiBsLmxlbmd0aD09PTA/bnVsbDpsfX0sVEFHOmZ1bmN0aW9uKGcsaCl7cmV0dXJuIGguZ2V0RWxlbWVudHNCeVRhZ05hbWUoZ1sxXSl9fSxwcmVGaWx0ZXI6e0NMQVNTOmZ1bmN0aW9uKGcsaCxsLG0scSxwKXtnPSIgIitnWzFdLnJlcGxhY2UoL1xcL2csIiIpKyIgIjtpZihwKXJldHVybiBnO3A9MDtmb3IodmFyIHY7KHY9aFtwXSkhPW51bGw7cCsrKWlmKHYpaWYocV4odi5jbGFzc05hbWUmJigiICIrdi5jbGFzc05hbWUrIiAiKS5yZXBsYWNlKC9bXHRcbl0vZywiICIpLmluZGV4T2YoZyk+PTApKWx8fG0ucHVzaCh2KTtlbHNlIGlmKGwpaFtwXT1mYWxzZTtyZXR1cm4gZmFsc2V9LElEOmZ1bmN0aW9uKGcpe3JldHVybiBnWzFdLnJlcGxhY2UoL1xcL2csIiIpfSxUQUc6ZnVuY3Rpb24oZyl7cmV0dXJuIGdbMV0udG9Mb3dlckNhc2UoKX0sDQpDSElMRDpmdW5jdGlvbihnKXtpZihnWzFdPT09Im50aCIpe3ZhciBoPS8oLT8pKFxkKiluKCg/OlwrfC0pP1xkKikvLmV4ZWMoZ1syXT09PSJldmVuIiYmIjJuInx8Z1syXT09PSJvZGQiJiYiMm4rMSJ8fCEvXEQvLnRlc3QoZ1syXSkmJiIwbisiK2dbMl18fGdbMl0pO2dbMl09aFsxXSsoaFsyXXx8MSktMDtnWzNdPWhbM10tMH1nWzBdPWUrKztyZXR1cm4gZ30sQVRUUjpmdW5jdGlvbihnLGgsbCxtLHEscCl7aD1nWzFdLnJlcGxhY2UoL1xcL2csIiIpO2lmKCFwJiZuLmF0dHJNYXBbaF0pZ1sxXT1uLmF0dHJNYXBbaF07aWYoZ1syXT09PSJ+PSIpZ1s0XT0iICIrZ1s0XSsiICI7cmV0dXJuIGd9LFBTRVVETzpmdW5jdGlvbihnLGgsbCxtLHEpe2lmKGdbMV09PT0ibm90IilpZigoZi5leGVjKGdbM10pfHwiIikubGVuZ3RoPjF8fC9eXHcvLnRlc3QoZ1szXSkpZ1szXT1rKGdbM10sbnVsbCxudWxsLGgpO2Vsc2V7Zz1rLmZpbHRlcihnWzNdLGgsbCx0cnVlXnEpO2x8fG0ucHVzaC5hcHBseShtLA0KZyk7cmV0dXJuIGZhbHNlfWVsc2UgaWYobi5tYXRjaC5QT1MudGVzdChnWzBdKXx8bi5tYXRjaC5DSElMRC50ZXN0KGdbMF0pKXJldHVybiB0cnVlO3JldHVybiBnfSxQT1M6ZnVuY3Rpb24oZyl7Zy51bnNoaWZ0KHRydWUpO3JldHVybiBnfX0sZmlsdGVyczp7ZW5hYmxlZDpmdW5jdGlvbihnKXtyZXR1cm4gZy5kaXNhYmxlZD09PWZhbHNlJiZnLnR5cGUhPT0iaGlkZGVuIn0sZGlzYWJsZWQ6ZnVuY3Rpb24oZyl7cmV0dXJuIGcuZGlzYWJsZWQ9PT10cnVlfSxjaGVja2VkOmZ1bmN0aW9uKGcpe3JldHVybiBnLmNoZWNrZWQ9PT10cnVlfSxzZWxlY3RlZDpmdW5jdGlvbihnKXtyZXR1cm4gZy5zZWxlY3RlZD09PXRydWV9LHBhcmVudDpmdW5jdGlvbihnKXtyZXR1cm4hIWcuZmlyc3RDaGlsZH0sZW1wdHk6ZnVuY3Rpb24oZyl7cmV0dXJuIWcuZmlyc3RDaGlsZH0saGFzOmZ1bmN0aW9uKGcsaCxsKXtyZXR1cm4hIWsobFszXSxnKS5sZW5ndGh9LGhlYWRlcjpmdW5jdGlvbihnKXtyZXR1cm4vaFxkL2kudGVzdChnLm5vZGVOYW1lKX0sDQp0ZXh0OmZ1bmN0aW9uKGcpe3JldHVybiJ0ZXh0Ij09PWcudHlwZX0scmFkaW86ZnVuY3Rpb24oZyl7cmV0dXJuInJhZGlvIj09PWcudHlwZX0sY2hlY2tib3g6ZnVuY3Rpb24oZyl7cmV0dXJuImNoZWNrYm94Ij09PWcudHlwZX0sZmlsZTpmdW5jdGlvbihnKXtyZXR1cm4iZmlsZSI9PT1nLnR5cGV9LHBhc3N3b3JkOmZ1bmN0aW9uKGcpe3JldHVybiJwYXNzd29yZCI9PT1nLnR5cGV9LHN1Ym1pdDpmdW5jdGlvbihnKXtyZXR1cm4ic3VibWl0Ij09PWcudHlwZX0saW1hZ2U6ZnVuY3Rpb24oZyl7cmV0dXJuImltYWdlIj09PWcudHlwZX0scmVzZXQ6ZnVuY3Rpb24oZyl7cmV0dXJuInJlc2V0Ij09PWcudHlwZX0sYnV0dG9uOmZ1bmN0aW9uKGcpe3JldHVybiJidXR0b24iPT09Zy50eXBlfHxnLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT0iYnV0dG9uIn0saW5wdXQ6ZnVuY3Rpb24oZyl7cmV0dXJuL2lucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24vaS50ZXN0KGcubm9kZU5hbWUpfX0sDQpzZXRGaWx0ZXJzOntmaXJzdDpmdW5jdGlvbihnLGgpe3JldHVybiBoPT09MH0sbGFzdDpmdW5jdGlvbihnLGgsbCxtKXtyZXR1cm4gaD09PW0ubGVuZ3RoLTF9LGV2ZW46ZnVuY3Rpb24oZyxoKXtyZXR1cm4gaCUyPT09MH0sb2RkOmZ1bmN0aW9uKGcsaCl7cmV0dXJuIGglMj09PTF9LGx0OmZ1bmN0aW9uKGcsaCxsKXtyZXR1cm4gaDxsWzNdLTB9LGd0OmZ1bmN0aW9uKGcsaCxsKXtyZXR1cm4gaD5sWzNdLTB9LG50aDpmdW5jdGlvbihnLGgsbCl7cmV0dXJuIGxbM10tMD09PWh9LGVxOmZ1bmN0aW9uKGcsaCxsKXtyZXR1cm4gbFszXS0wPT09aH19LGZpbHRlcjp7UFNFVURPOmZ1bmN0aW9uKGcsaCxsLG0pe3ZhciBxPWhbMV0scD1uLmZpbHRlcnNbcV07aWYocClyZXR1cm4gcChnLGwsaCxtKTtlbHNlIGlmKHE9PT0iY29udGFpbnMiKXJldHVybihnLnRleHRDb250ZW50fHxnLmlubmVyVGV4dHx8YShbZ10pfHwiIikuaW5kZXhPZihoWzNdKT49MDtlbHNlIGlmKHE9PT0ibm90Iil7aD0NCmhbM107bD0wO2ZvcihtPWgubGVuZ3RoO2w8bTtsKyspaWYoaFtsXT09PWcpcmV0dXJuIGZhbHNlO3JldHVybiB0cnVlfWVsc2Ugay5lcnJvcigiU3ludGF4IGVycm9yLCB1bnJlY29nbml6ZWQgZXhwcmVzc2lvbjogIitxKX0sQ0hJTEQ6ZnVuY3Rpb24oZyxoKXt2YXIgbD1oWzFdLG09Zztzd2l0Y2gobCl7Y2FzZSAib25seSI6Y2FzZSAiZmlyc3QiOmZvcig7bT1tLnByZXZpb3VzU2libGluZzspaWYobS5ub2RlVHlwZT09PTEpcmV0dXJuIGZhbHNlO2lmKGw9PT0iZmlyc3QiKXJldHVybiB0cnVlO209ZztjYXNlICJsYXN0Ijpmb3IoO209bS5uZXh0U2libGluZzspaWYobS5ub2RlVHlwZT09PTEpcmV0dXJuIGZhbHNlO3JldHVybiB0cnVlO2Nhc2UgIm50aCI6bD1oWzJdO3ZhciBxPWhbM107aWYobD09PTEmJnE9PT0wKXJldHVybiB0cnVlO2g9aFswXTt2YXIgcD1nLnBhcmVudE5vZGU7aWYocCYmKHAuc2l6Y2FjaGUhPT1ofHwhZy5ub2RlSW5kZXgpKXt2YXIgdj0wO2ZvcihtPXAuZmlyc3RDaGlsZDttO209DQptLm5leHRTaWJsaW5nKWlmKG0ubm9kZVR5cGU9PT0xKW0ubm9kZUluZGV4PSsrdjtwLnNpemNhY2hlPWh9Zz1nLm5vZGVJbmRleC1xO3JldHVybiBsPT09MD9nPT09MDpnJWw9PT0wJiZnL2w+PTB9fSxJRDpmdW5jdGlvbihnLGgpe3JldHVybiBnLm5vZGVUeXBlPT09MSYmZy5nZXRBdHRyaWJ1dGUoImlkIik9PT1ofSxUQUc6ZnVuY3Rpb24oZyxoKXtyZXR1cm4gaD09PSIqIiYmZy5ub2RlVHlwZT09PTF8fGcubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWh9LENMQVNTOmZ1bmN0aW9uKGcsaCl7cmV0dXJuKCIgIisoZy5jbGFzc05hbWV8fGcuZ2V0QXR0cmlidXRlKCJjbGFzcyIpKSsiICIpLmluZGV4T2YoaCk+LTF9LEFUVFI6ZnVuY3Rpb24oZyxoKXt2YXIgbD1oWzFdO2c9bi5hdHRySGFuZGxlW2xdP24uYXR0ckhhbmRsZVtsXShnKTpnW2xdIT1udWxsP2dbbF06Zy5nZXRBdHRyaWJ1dGUobCk7bD1nKyIiO3ZhciBtPWhbMl07aD1oWzRdO3JldHVybiBnPT1udWxsP209PT0iIT0iOm09PT0NCiI9Ij9sPT09aDptPT09Iio9Ij9sLmluZGV4T2YoaCk+PTA6bT09PSJ+PSI/KCIgIitsKyIgIikuaW5kZXhPZihoKT49MDohaD9sJiZnIT09ZmFsc2U6bT09PSIhPSI/bCE9PWg6bT09PSJePSI/bC5pbmRleE9mKGgpPT09MDptPT09IiQ9Ij9sLnN1YnN0cihsLmxlbmd0aC1oLmxlbmd0aCk9PT1oOm09PT0ifD0iP2w9PT1ofHxsLnN1YnN0cigwLGgubGVuZ3RoKzEpPT09aCsiLSI6ZmFsc2V9LFBPUzpmdW5jdGlvbihnLGgsbCxtKXt2YXIgcT1uLnNldEZpbHRlcnNbaFsyXV07aWYocSlyZXR1cm4gcShnLGwsaCxtKX19fSxyPW4ubWF0Y2guUE9TO2Zvcih2YXIgdSBpbiBuLm1hdGNoKXtuLm1hdGNoW3VdPW5ldyBSZWdFeHAobi5tYXRjaFt1XS5zb3VyY2UrLyg/IVteXFtdKlxdKSg/IVteXChdKlwpKS8uc291cmNlKTtuLmxlZnRNYXRjaFt1XT1uZXcgUmVnRXhwKC8oXig/Oi58XHJ8XG4pKj8pLy5zb3VyY2Urbi5tYXRjaFt1XS5zb3VyY2UucmVwbGFjZSgvXFwoXGQrKS9nLGZ1bmN0aW9uKGcsDQpoKXtyZXR1cm4iXFwiKyhoLTArMSl9KSl9dmFyIHo9ZnVuY3Rpb24oZyxoKXtnPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGcsMCk7aWYoaCl7aC5wdXNoLmFwcGx5KGgsZyk7cmV0dXJuIGh9cmV0dXJuIGd9O3RyeXtBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChzLmRvY3VtZW50RWxlbWVudC5jaGlsZE5vZGVzLDApfWNhdGNoKEMpe3o9ZnVuY3Rpb24oZyxoKXtoPWh8fFtdO2lmKGouY2FsbChnKT09PSJbb2JqZWN0IEFycmF5XSIpQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoaCxnKTtlbHNlIGlmKHR5cGVvZiBnLmxlbmd0aD09PSJudW1iZXIiKWZvcih2YXIgbD0wLG09Zy5sZW5ndGg7bDxtO2wrKyloLnB1c2goZ1tsXSk7ZWxzZSBmb3IobD0wO2dbbF07bCsrKWgucHVzaChnW2xdKTtyZXR1cm4gaH19dmFyIEI7aWYocy5kb2N1bWVudEVsZW1lbnQuY29tcGFyZURvY3VtZW50UG9zaXRpb24pQj1mdW5jdGlvbihnLGgpe2lmKCFnLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9ufHwNCiFoLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKXtpZihnPT1oKWk9dHJ1ZTtyZXR1cm4gZy5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbj8tMToxfWc9Zy5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihoKSY0Py0xOmc9PT1oPzA6MTtpZihnPT09MClpPXRydWU7cmV0dXJuIGd9O2Vsc2UgaWYoInNvdXJjZUluZGV4ImluIHMuZG9jdW1lbnRFbGVtZW50KUI9ZnVuY3Rpb24oZyxoKXtpZighZy5zb3VyY2VJbmRleHx8IWguc291cmNlSW5kZXgpe2lmKGc9PWgpaT10cnVlO3JldHVybiBnLnNvdXJjZUluZGV4Py0xOjF9Zz1nLnNvdXJjZUluZGV4LWguc291cmNlSW5kZXg7aWYoZz09PTApaT10cnVlO3JldHVybiBnfTtlbHNlIGlmKHMuY3JlYXRlUmFuZ2UpQj1mdW5jdGlvbihnLGgpe2lmKCFnLm93bmVyRG9jdW1lbnR8fCFoLm93bmVyRG9jdW1lbnQpe2lmKGc9PWgpaT10cnVlO3JldHVybiBnLm93bmVyRG9jdW1lbnQ/LTE6MX12YXIgbD1nLm93bmVyRG9jdW1lbnQuY3JlYXRlUmFuZ2UoKSxtPQ0KaC5vd25lckRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7bC5zZXRTdGFydChnLDApO2wuc2V0RW5kKGcsMCk7bS5zZXRTdGFydChoLDApO20uc2V0RW5kKGgsMCk7Zz1sLmNvbXBhcmVCb3VuZGFyeVBvaW50cyhSYW5nZS5TVEFSVF9UT19FTkQsbSk7aWYoZz09PTApaT10cnVlO3JldHVybiBnfTsoZnVuY3Rpb24oKXt2YXIgZz1zLmNyZWF0ZUVsZW1lbnQoImRpdiIpLGg9InNjcmlwdCIrKG5ldyBEYXRlKS5nZXRUaW1lKCk7Zy5pbm5lckhUTUw9IjxhIG5hbWU9JyIraCsiJy8+Ijt2YXIgbD1zLmRvY3VtZW50RWxlbWVudDtsLmluc2VydEJlZm9yZShnLGwuZmlyc3RDaGlsZCk7aWYocy5nZXRFbGVtZW50QnlJZChoKSl7bi5maW5kLklEPWZ1bmN0aW9uKG0scSxwKXtpZih0eXBlb2YgcS5nZXRFbGVtZW50QnlJZCE9PSJ1bmRlZmluZWQiJiYhcClyZXR1cm4ocT1xLmdldEVsZW1lbnRCeUlkKG1bMV0pKT9xLmlkPT09bVsxXXx8dHlwZW9mIHEuZ2V0QXR0cmlidXRlTm9kZSE9PSJ1bmRlZmluZWQiJiYNCnEuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKS5ub2RlVmFsdWU9PT1tWzFdP1txXTp3OltdfTtuLmZpbHRlci5JRD1mdW5jdGlvbihtLHEpe3ZhciBwPXR5cGVvZiBtLmdldEF0dHJpYnV0ZU5vZGUhPT0idW5kZWZpbmVkIiYmbS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpO3JldHVybiBtLm5vZGVUeXBlPT09MSYmcCYmcC5ub2RlVmFsdWU9PT1xfX1sLnJlbW92ZUNoaWxkKGcpO2w9Zz1udWxsfSkoKTsoZnVuY3Rpb24oKXt2YXIgZz1zLmNyZWF0ZUVsZW1lbnQoImRpdiIpO2cuYXBwZW5kQ2hpbGQocy5jcmVhdGVDb21tZW50KCIiKSk7aWYoZy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLmxlbmd0aD4wKW4uZmluZC5UQUc9ZnVuY3Rpb24oaCxsKXtsPWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoaFsxXSk7aWYoaFsxXT09PSIqIil7aD1bXTtmb3IodmFyIG09MDtsW21dO20rKylsW21dLm5vZGVUeXBlPT09MSYmaC5wdXNoKGxbbV0pO2w9aH1yZXR1cm4gbH07Zy5pbm5lckhUTUw9IjxhIGhyZWY9JyMnPjwvYT4iOw0KaWYoZy5maXJzdENoaWxkJiZ0eXBlb2YgZy5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSE9PSJ1bmRlZmluZWQiJiZnLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCJocmVmIikhPT0iIyIpbi5hdHRySGFuZGxlLmhyZWY9ZnVuY3Rpb24oaCl7cmV0dXJuIGguZ2V0QXR0cmlidXRlKCJocmVmIiwyKX07Zz1udWxsfSkoKTtzLnF1ZXJ5U2VsZWN0b3JBbGwmJmZ1bmN0aW9uKCl7dmFyIGc9ayxoPXMuY3JlYXRlRWxlbWVudCgiZGl2Iik7aC5pbm5lckhUTUw9IjxwIGNsYXNzPSdURVNUJz48L3A+IjtpZighKGgucXVlcnlTZWxlY3RvckFsbCYmaC5xdWVyeVNlbGVjdG9yQWxsKCIuVEVTVCIpLmxlbmd0aD09PTApKXtrPWZ1bmN0aW9uKG0scSxwLHYpe3E9cXx8cztpZighdiYmcS5ub2RlVHlwZT09PTkmJiF4KHEpKXRyeXtyZXR1cm4geihxLnF1ZXJ5U2VsZWN0b3JBbGwobSkscCl9Y2F0Y2godCl7fXJldHVybiBnKG0scSxwLHYpfTtmb3IodmFyIGwgaW4gZylrW2xdPWdbbF07aD1udWxsfX0oKTsNCihmdW5jdGlvbigpe3ZhciBnPXMuY3JlYXRlRWxlbWVudCgiZGl2Iik7Zy5pbm5lckhUTUw9IjxkaXYgY2xhc3M9J3Rlc3QgZSc+PC9kaXY+PGRpdiBjbGFzcz0ndGVzdCc+PC9kaXY+IjtpZighKCFnLmdldEVsZW1lbnRzQnlDbGFzc05hbWV8fGcuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiZSIpLmxlbmd0aD09PTApKXtnLmxhc3RDaGlsZC5jbGFzc05hbWU9ImUiO2lmKGcuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiZSIpLmxlbmd0aCE9PTEpe24ub3JkZXIuc3BsaWNlKDEsMCwiQ0xBU1MiKTtuLmZpbmQuQ0xBU1M9ZnVuY3Rpb24oaCxsLG0pe2lmKHR5cGVvZiBsLmdldEVsZW1lbnRzQnlDbGFzc05hbWUhPT0idW5kZWZpbmVkIiYmIW0pcmV0dXJuIGwuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShoWzFdKX07Zz1udWxsfX19KSgpO3ZhciBFPXMuY29tcGFyZURvY3VtZW50UG9zaXRpb24/ZnVuY3Rpb24oZyxoKXtyZXR1cm4hIShnLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGgpJjE2KX06DQpmdW5jdGlvbihnLGgpe3JldHVybiBnIT09aCYmKGcuY29udGFpbnM/Zy5jb250YWlucyhoKTp0cnVlKX0seD1mdW5jdGlvbihnKXtyZXR1cm4oZz0oZz9nLm93bmVyRG9jdW1lbnR8fGc6MCkuZG9jdW1lbnRFbGVtZW50KT9nLm5vZGVOYW1lIT09IkhUTUwiOmZhbHNlfSxnYT1mdW5jdGlvbihnLGgpe3ZhciBsPVtdLG09IiIscTtmb3IoaD1oLm5vZGVUeXBlP1toXTpoO3E9bi5tYXRjaC5QU0VVRE8uZXhlYyhnKTspe20rPXFbMF07Zz1nLnJlcGxhY2Uobi5tYXRjaC5QU0VVRE8sIiIpfWc9bi5yZWxhdGl2ZVtnXT9nKyIqIjpnO3E9MDtmb3IodmFyIHA9aC5sZW5ndGg7cTxwO3ErKylrKGcsaFtxXSxsKTtyZXR1cm4gay5maWx0ZXIobSxsKX07Yy5maW5kPWs7Yy5leHByPWsuc2VsZWN0b3JzO2MuZXhwclsiOiJdPWMuZXhwci5maWx0ZXJzO2MudW5pcXVlPWsudW5pcXVlU29ydDtjLnRleHQ9YTtjLmlzWE1MRG9jPXg7Yy5jb250YWlucz1FfSkoKTt2YXIgZWI9L1VudGlsJC8sZmI9L14oPzpwYXJlbnRzfHByZXZVbnRpbHxwcmV2QWxsKS8sDQpnYj0vLC87Uj1BcnJheS5wcm90b3R5cGUuc2xpY2U7dmFyIElhPWZ1bmN0aW9uKGEsYixkKXtpZihjLmlzRnVuY3Rpb24oYikpcmV0dXJuIGMuZ3JlcChhLGZ1bmN0aW9uKGUsail7cmV0dXJuISFiLmNhbGwoZSxqLGUpPT09ZH0pO2Vsc2UgaWYoYi5ub2RlVHlwZSlyZXR1cm4gYy5ncmVwKGEsZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT1iPT09ZH0pO2Vsc2UgaWYodHlwZW9mIGI9PT0ic3RyaW5nIil7dmFyIGY9Yy5ncmVwKGEsZnVuY3Rpb24oZSl7cmV0dXJuIGUubm9kZVR5cGU9PT0xfSk7aWYoVWEudGVzdChiKSlyZXR1cm4gYy5maWx0ZXIoYixmLCFkKTtlbHNlIGI9Yy5maWx0ZXIoYixmKX1yZXR1cm4gYy5ncmVwKGEsZnVuY3Rpb24oZSl7cmV0dXJuIGMuaW5BcnJheShlLGIpPj0wPT09ZH0pfTtjLmZuLmV4dGVuZCh7ZmluZDpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5wdXNoU3RhY2soIiIsImZpbmQiLGEpLGQ9MCxmPTAsZT10aGlzLmxlbmd0aDtmPGU7ZisrKXtkPWIubGVuZ3RoOw0KYy5maW5kKGEsdGhpc1tmXSxiKTtpZihmPjApZm9yKHZhciBqPWQ7ajxiLmxlbmd0aDtqKyspZm9yKHZhciBpPTA7aTxkO2krKylpZihiW2ldPT09YltqXSl7Yi5zcGxpY2Uoai0tLDEpO2JyZWFrfX1yZXR1cm4gYn0saGFzOmZ1bmN0aW9uKGEpe3ZhciBiPWMoYSk7cmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKCl7Zm9yKHZhciBkPTAsZj1iLmxlbmd0aDtkPGY7ZCsrKWlmKGMuY29udGFpbnModGhpcyxiW2RdKSlyZXR1cm4gdHJ1ZX0pfSxub3Q6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKElhKHRoaXMsYSxmYWxzZSksIm5vdCIsYSl9LGZpbHRlcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soSWEodGhpcyxhLHRydWUpLCJmaWx0ZXIiLGEpfSxpczpmdW5jdGlvbihhKXtyZXR1cm4hIWEmJmMuZmlsdGVyKGEsdGhpcykubGVuZ3RoPjB9LGNsb3Nlc3Q6ZnVuY3Rpb24oYSxiKXtpZihjLmlzQXJyYXkoYSkpe3ZhciBkPVtdLGY9dGhpc1swXSxlLGo9DQp7fSxpO2lmKGYmJmEubGVuZ3RoKXtlPTA7Zm9yKHZhciBvPWEubGVuZ3RoO2U8bztlKyspe2k9YVtlXTtqW2ldfHwoaltpXT1jLmV4cHIubWF0Y2guUE9TLnRlc3QoaSk/YyhpLGJ8fHRoaXMuY29udGV4dCk6aSl9Zm9yKDtmJiZmLm93bmVyRG9jdW1lbnQmJmYhPT1iOyl7Zm9yKGkgaW4gail7ZT1qW2ldO2lmKGUuanF1ZXJ5P2UuaW5kZXgoZik+LTE6YyhmKS5pcyhlKSl7ZC5wdXNoKHtzZWxlY3RvcjppLGVsZW06Zn0pO2RlbGV0ZSBqW2ldfX1mPWYucGFyZW50Tm9kZX19cmV0dXJuIGR9dmFyIGs9Yy5leHByLm1hdGNoLlBPUy50ZXN0KGEpP2MoYSxifHx0aGlzLmNvbnRleHQpOm51bGw7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKG4scil7Zm9yKDtyJiZyLm93bmVyRG9jdW1lbnQmJnIhPT1iOyl7aWYoaz9rLmluZGV4KHIpPi0xOmMocikuaXMoYSkpcmV0dXJuIHI7cj1yLnBhcmVudE5vZGV9cmV0dXJuIG51bGx9KX0saW5kZXg6ZnVuY3Rpb24oYSl7aWYoIWF8fHR5cGVvZiBhPT09DQoic3RyaW5nIilyZXR1cm4gYy5pbkFycmF5KHRoaXNbMF0sYT9jKGEpOnRoaXMucGFyZW50KCkuY2hpbGRyZW4oKSk7cmV0dXJuIGMuaW5BcnJheShhLmpxdWVyeT9hWzBdOmEsdGhpcyl9LGFkZDpmdW5jdGlvbihhLGIpe2E9dHlwZW9mIGE9PT0ic3RyaW5nIj9jKGEsYnx8dGhpcy5jb250ZXh0KTpjLm1ha2VBcnJheShhKTtiPWMubWVyZ2UodGhpcy5nZXQoKSxhKTtyZXR1cm4gdGhpcy5wdXNoU3RhY2socWEoYVswXSl8fHFhKGJbMF0pP2I6Yy51bmlxdWUoYikpfSxhbmRTZWxmOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWRkKHRoaXMucHJldk9iamVjdCl9fSk7Yy5lYWNoKHtwYXJlbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuKGE9YS5wYXJlbnROb2RlKSYmYS5ub2RlVHlwZSE9PTExP2E6bnVsbH0scGFyZW50czpmdW5jdGlvbihhKXtyZXR1cm4gYy5kaXIoYSwicGFyZW50Tm9kZSIpfSxwYXJlbnRzVW50aWw6ZnVuY3Rpb24oYSxiLGQpe3JldHVybiBjLmRpcihhLCJwYXJlbnROb2RlIiwNCmQpfSxuZXh0OmZ1bmN0aW9uKGEpe3JldHVybiBjLm50aChhLDIsIm5leHRTaWJsaW5nIil9LHByZXY6ZnVuY3Rpb24oYSl7cmV0dXJuIGMubnRoKGEsMiwicHJldmlvdXNTaWJsaW5nIil9LG5leHRBbGw6ZnVuY3Rpb24oYSl7cmV0dXJuIGMuZGlyKGEsIm5leHRTaWJsaW5nIil9LHByZXZBbGw6ZnVuY3Rpb24oYSl7cmV0dXJuIGMuZGlyKGEsInByZXZpb3VzU2libGluZyIpfSxuZXh0VW50aWw6ZnVuY3Rpb24oYSxiLGQpe3JldHVybiBjLmRpcihhLCJuZXh0U2libGluZyIsZCl9LHByZXZVbnRpbDpmdW5jdGlvbihhLGIsZCl7cmV0dXJuIGMuZGlyKGEsInByZXZpb3VzU2libGluZyIsZCl9LHNpYmxpbmdzOmZ1bmN0aW9uKGEpe3JldHVybiBjLnNpYmxpbmcoYS5wYXJlbnROb2RlLmZpcnN0Q2hpbGQsYSl9LGNoaWxkcmVuOmZ1bmN0aW9uKGEpe3JldHVybiBjLnNpYmxpbmcoYS5maXJzdENoaWxkKX0sY29udGVudHM6ZnVuY3Rpb24oYSl7cmV0dXJuIGMubm9kZU5hbWUoYSwiaWZyYW1lIik/DQphLmNvbnRlbnREb2N1bWVudHx8YS5jb250ZW50V2luZG93LmRvY3VtZW50OmMubWFrZUFycmF5KGEuY2hpbGROb2Rlcyl9fSxmdW5jdGlvbihhLGIpe2MuZm5bYV09ZnVuY3Rpb24oZCxmKXt2YXIgZT1jLm1hcCh0aGlzLGIsZCk7ZWIudGVzdChhKXx8KGY9ZCk7aWYoZiYmdHlwZW9mIGY9PT0ic3RyaW5nIillPWMuZmlsdGVyKGYsZSk7ZT10aGlzLmxlbmd0aD4xP2MudW5pcXVlKGUpOmU7aWYoKHRoaXMubGVuZ3RoPjF8fGdiLnRlc3QoZikpJiZmYi50ZXN0KGEpKWU9ZS5yZXZlcnNlKCk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGUsYSxSLmNhbGwoYXJndW1lbnRzKS5qb2luKCIsIikpfX0pO2MuZXh0ZW5kKHtmaWx0ZXI6ZnVuY3Rpb24oYSxiLGQpe2lmKGQpYT0iOm5vdCgiK2ErIikiO3JldHVybiBjLmZpbmQubWF0Y2hlcyhhLGIpfSxkaXI6ZnVuY3Rpb24oYSxiLGQpe3ZhciBmPVtdO2ZvcihhPWFbYl07YSYmYS5ub2RlVHlwZSE9PTkmJihkPT09d3x8YS5ub2RlVHlwZSE9PTF8fCFjKGEpLmlzKGQpKTspe2Eubm9kZVR5cGU9PT0NCjEmJmYucHVzaChhKTthPWFbYl19cmV0dXJuIGZ9LG50aDpmdW5jdGlvbihhLGIsZCl7Yj1ifHwxO2Zvcih2YXIgZj0wO2E7YT1hW2RdKWlmKGEubm9kZVR5cGU9PT0xJiYrK2Y9PT1iKWJyZWFrO3JldHVybiBhfSxzaWJsaW5nOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBkPVtdO2E7YT1hLm5leHRTaWJsaW5nKWEubm9kZVR5cGU9PT0xJiZhIT09YiYmZC5wdXNoKGEpO3JldHVybiBkfX0pO3ZhciBKYT0vIGpRdWVyeVxkKz0iKD86XGQrfG51bGwpIi9nLFY9L15ccysvLEthPS8oPChbXHc6XSspW14+XSo/KVwvPi9nLGhiPS9eKD86YXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkkL2ksTGE9LzwoW1x3Ol0rKS8saWI9Lzx0Ym9keS9pLGpiPS88fCYjP1x3KzsvLHRhPS88c2NyaXB0fDxvYmplY3R8PGVtYmVkfDxvcHRpb258PHN0eWxlL2ksdWE9L2NoZWNrZWRccyooPzpbXj1dfD1ccyouY2hlY2tlZC4pL2ksTWE9ZnVuY3Rpb24oYSxiLGQpe3JldHVybiBoYi50ZXN0KGQpPw0KYTpiKyI+PC8iK2QrIj4ifSxGPXtvcHRpb246WzEsIjxzZWxlY3QgbXVsdGlwbGU9J211bHRpcGxlJz4iLCI8L3NlbGVjdD4iXSxsZWdlbmQ6WzEsIjxmaWVsZHNldD4iLCI8L2ZpZWxkc2V0PiJdLHRoZWFkOlsxLCI8dGFibGU+IiwiPC90YWJsZT4iXSx0cjpbMiwiPHRhYmxlPjx0Ym9keT4iLCI8L3Rib2R5PjwvdGFibGU+Il0sdGQ6WzMsIjx0YWJsZT48dGJvZHk+PHRyPiIsIjwvdHI+PC90Ym9keT48L3RhYmxlPiJdLGNvbDpbMiwiPHRhYmxlPjx0Ym9keT48L3Rib2R5Pjxjb2xncm91cD4iLCI8L2NvbGdyb3VwPjwvdGFibGU+Il0sYXJlYTpbMSwiPG1hcD4iLCI8L21hcD4iXSxfZGVmYXVsdDpbMCwiIiwiIl19O0Yub3B0Z3JvdXA9Ri5vcHRpb247Ri50Ym9keT1GLnRmb290PUYuY29sZ3JvdXA9Ri5jYXB0aW9uPUYudGhlYWQ7Ri50aD1GLnRkO2lmKCFjLnN1cHBvcnQuaHRtbFNlcmlhbGl6ZSlGLl9kZWZhdWx0PVsxLCJkaXY8ZGl2PiIsIjwvZGl2PiJdO2MuZm4uZXh0ZW5kKHt0ZXh0OmZ1bmN0aW9uKGEpe2lmKGMuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3ZhciBkPQ0KYyh0aGlzKTtkLnRleHQoYS5jYWxsKHRoaXMsYixkLnRleHQoKSkpfSk7aWYodHlwZW9mIGEhPT0ib2JqZWN0IiYmYSE9PXcpcmV0dXJuIHRoaXMuZW1wdHkoKS5hcHBlbmQoKHRoaXNbMF0mJnRoaXNbMF0ub3duZXJEb2N1bWVudHx8cykuY3JlYXRlVGV4dE5vZGUoYSkpO3JldHVybiBjLnRleHQodGhpcyl9LHdyYXBBbGw6ZnVuY3Rpb24oYSl7aWYoYy5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oZCl7Yyh0aGlzKS53cmFwQWxsKGEuY2FsbCh0aGlzLGQpKX0pO2lmKHRoaXNbMF0pe3ZhciBiPWMoYSx0aGlzWzBdLm93bmVyRG9jdW1lbnQpLmVxKDApLmNsb25lKHRydWUpO3RoaXNbMF0ucGFyZW50Tm9kZSYmYi5pbnNlcnRCZWZvcmUodGhpc1swXSk7Yi5tYXAoZnVuY3Rpb24oKXtmb3IodmFyIGQ9dGhpcztkLmZpcnN0Q2hpbGQmJmQuZmlyc3RDaGlsZC5ub2RlVHlwZT09PTE7KWQ9ZC5maXJzdENoaWxkO3JldHVybiBkfSkuYXBwZW5kKHRoaXMpfXJldHVybiB0aGlzfSwNCndyYXBJbm5lcjpmdW5jdGlvbihhKXtpZihjLmlzRnVuY3Rpb24oYSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihiKXtjKHRoaXMpLndyYXBJbm5lcihhLmNhbGwodGhpcyxiKSl9KTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGI9Yyh0aGlzKSxkPWIuY29udGVudHMoKTtkLmxlbmd0aD9kLndyYXBBbGwoYSk6Yi5hcHBlbmQoYSl9KX0sd3JhcDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Yyh0aGlzKS53cmFwQWxsKGEpfSl9LHVud3JhcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmVudCgpLmVhY2goZnVuY3Rpb24oKXtjLm5vZGVOYW1lKHRoaXMsImJvZHkiKXx8Yyh0aGlzKS5yZXBsYWNlV2l0aCh0aGlzLmNoaWxkTm9kZXMpfSkuZW5kKCl9LGFwcGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cyx0cnVlLGZ1bmN0aW9uKGEpe3RoaXMubm9kZVR5cGU9PT0xJiZ0aGlzLmFwcGVuZENoaWxkKGEpfSl9LA0KcHJlcGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cyx0cnVlLGZ1bmN0aW9uKGEpe3RoaXMubm9kZVR5cGU9PT0xJiZ0aGlzLmluc2VydEJlZm9yZShhLHRoaXMuZmlyc3RDaGlsZCl9KX0sYmVmb3JlOmZ1bmN0aW9uKCl7aWYodGhpc1swXSYmdGhpc1swXS5wYXJlbnROb2RlKXJldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cyxmYWxzZSxmdW5jdGlvbihiKXt0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGIsdGhpcyl9KTtlbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGgpe3ZhciBhPWMoYXJndW1lbnRzWzBdKTthLnB1c2guYXBwbHkoYSx0aGlzLnRvQXJyYXkoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGEsImJlZm9yZSIsYXJndW1lbnRzKX19LGFmdGVyOmZ1bmN0aW9uKCl7aWYodGhpc1swXSYmdGhpc1swXS5wYXJlbnROb2RlKXJldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cyxmYWxzZSxmdW5jdGlvbihiKXt0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGIsDQp0aGlzLm5leHRTaWJsaW5nKX0pO2Vsc2UgaWYoYXJndW1lbnRzLmxlbmd0aCl7dmFyIGE9dGhpcy5wdXNoU3RhY2sodGhpcywiYWZ0ZXIiLGFyZ3VtZW50cyk7YS5wdXNoLmFwcGx5KGEsYyhhcmd1bWVudHNbMF0pLnRvQXJyYXkoKSk7cmV0dXJuIGF9fSxyZW1vdmU6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGQ9MCxmOyhmPXRoaXNbZF0pIT1udWxsO2QrKylpZighYXx8Yy5maWx0ZXIoYSxbZl0pLmxlbmd0aCl7aWYoIWImJmYubm9kZVR5cGU9PT0xKXtjLmNsZWFuRGF0YShmLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikpO2MuY2xlYW5EYXRhKFtmXSl9Zi5wYXJlbnROb2RlJiZmLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZil9cmV0dXJuIHRoaXN9LGVtcHR5OmZ1bmN0aW9uKCl7Zm9yKHZhciBhPTAsYjsoYj10aGlzW2FdKSE9bnVsbDthKyspZm9yKGIubm9kZVR5cGU9PT0xJiZjLmNsZWFuRGF0YShiLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikpO2IuZmlyc3RDaGlsZDspYi5yZW1vdmVDaGlsZChiLmZpcnN0Q2hpbGQpOw0KcmV0dXJuIHRoaXN9LGNsb25lOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMubWFwKGZ1bmN0aW9uKCl7aWYoIWMuc3VwcG9ydC5ub0Nsb25lRXZlbnQmJiFjLmlzWE1MRG9jKHRoaXMpKXt2YXIgZD10aGlzLm91dGVySFRNTCxmPXRoaXMub3duZXJEb2N1bWVudDtpZighZCl7ZD1mLmNyZWF0ZUVsZW1lbnQoImRpdiIpO2QuYXBwZW5kQ2hpbGQodGhpcy5jbG9uZU5vZGUodHJ1ZSkpO2Q9ZC5pbm5lckhUTUx9cmV0dXJuIGMuY2xlYW4oW2QucmVwbGFjZShKYSwiIikucmVwbGFjZSgvPShbXj0iJz5cc10rXC8pPi9nLCc9IiQxIj4nKS5yZXBsYWNlKFYsIiIpXSxmKVswXX1lbHNlIHJldHVybiB0aGlzLmNsb25lTm9kZSh0cnVlKX0pO2lmKGE9PT10cnVlKXtyYSh0aGlzLGIpO3JhKHRoaXMuZmluZCgiKiIpLGIuZmluZCgiKiIpKX1yZXR1cm4gYn0saHRtbDpmdW5jdGlvbihhKXtpZihhPT09dylyZXR1cm4gdGhpc1swXSYmdGhpc1swXS5ub2RlVHlwZT09PTE/dGhpc1swXS5pbm5lckhUTUwucmVwbGFjZShKYSwNCiIiKTpudWxsO2Vsc2UgaWYodHlwZW9mIGE9PT0ic3RyaW5nIiYmIXRhLnRlc3QoYSkmJihjLnN1cHBvcnQubGVhZGluZ1doaXRlc3BhY2V8fCFWLnRlc3QoYSkpJiYhRlsoTGEuZXhlYyhhKXx8WyIiLCIiXSlbMV0udG9Mb3dlckNhc2UoKV0pe2E9YS5yZXBsYWNlKEthLE1hKTt0cnl7Zm9yKHZhciBiPTAsZD10aGlzLmxlbmd0aDtiPGQ7YisrKWlmKHRoaXNbYl0ubm9kZVR5cGU9PT0xKXtjLmNsZWFuRGF0YSh0aGlzW2JdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikpO3RoaXNbYl0uaW5uZXJIVE1MPWF9fWNhdGNoKGYpe3RoaXMuZW1wdHkoKS5hcHBlbmQoYSl9fWVsc2UgYy5pc0Z1bmN0aW9uKGEpP3RoaXMuZWFjaChmdW5jdGlvbihlKXt2YXIgaj1jKHRoaXMpLGk9ai5odG1sKCk7ai5lbXB0eSgpLmFwcGVuZChmdW5jdGlvbigpe3JldHVybiBhLmNhbGwodGhpcyxlLGkpfSl9KTp0aGlzLmVtcHR5KCkuYXBwZW5kKGEpO3JldHVybiB0aGlzfSxyZXBsYWNlV2l0aDpmdW5jdGlvbihhKXtpZih0aGlzWzBdJiYNCnRoaXNbMF0ucGFyZW50Tm9kZSl7aWYoYy5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7dmFyIGQ9Yyh0aGlzKSxmPWQuaHRtbCgpO2QucmVwbGFjZVdpdGgoYS5jYWxsKHRoaXMsYixmKSl9KTtpZih0eXBlb2YgYSE9PSJzdHJpbmciKWE9YyhhKS5kZXRhY2goKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGI9dGhpcy5uZXh0U2libGluZyxkPXRoaXMucGFyZW50Tm9kZTtjKHRoaXMpLnJlbW92ZSgpO2I/YyhiKS5iZWZvcmUoYSk6YyhkKS5hcHBlbmQoYSl9KX1lbHNlIHJldHVybiB0aGlzLnB1c2hTdGFjayhjKGMuaXNGdW5jdGlvbihhKT9hKCk6YSksInJlcGxhY2VXaXRoIixhKX0sZGV0YWNoOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnJlbW92ZShhLHRydWUpfSxkb21NYW5pcDpmdW5jdGlvbihhLGIsZCl7ZnVuY3Rpb24gZih1KXtyZXR1cm4gYy5ub2RlTmFtZSh1LCJ0YWJsZSIpP3UuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRib2R5IilbMF18fA0KdS5hcHBlbmRDaGlsZCh1Lm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGJvZHkiKSk6dX12YXIgZSxqLGk9YVswXSxvPVtdLGs7aWYoIWMuc3VwcG9ydC5jaGVja0Nsb25lJiZhcmd1bWVudHMubGVuZ3RoPT09MyYmdHlwZW9mIGk9PT0ic3RyaW5nIiYmdWEudGVzdChpKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Yyh0aGlzKS5kb21NYW5pcChhLGIsZCx0cnVlKX0pO2lmKGMuaXNGdW5jdGlvbihpKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKHUpe3ZhciB6PWModGhpcyk7YVswXT1pLmNhbGwodGhpcyx1LGI/ei5odG1sKCk6dyk7ei5kb21NYW5pcChhLGIsZCl9KTtpZih0aGlzWzBdKXtlPWkmJmkucGFyZW50Tm9kZTtlPWMuc3VwcG9ydC5wYXJlbnROb2RlJiZlJiZlLm5vZGVUeXBlPT09MTEmJmUuY2hpbGROb2Rlcy5sZW5ndGg9PT10aGlzLmxlbmd0aD97ZnJhZ21lbnQ6ZX06c2EoYSx0aGlzLG8pO2s9ZS5mcmFnbWVudDtpZihqPWsuY2hpbGROb2Rlcy5sZW5ndGg9PT0NCjE/KGs9ay5maXJzdENoaWxkKTprLmZpcnN0Q2hpbGQpe2I9YiYmYy5ub2RlTmFtZShqLCJ0ciIpO2Zvcih2YXIgbj0wLHI9dGhpcy5sZW5ndGg7bjxyO24rKylkLmNhbGwoYj9mKHRoaXNbbl0saik6dGhpc1tuXSxuPjB8fGUuY2FjaGVhYmxlfHx0aGlzLmxlbmd0aD4xP2suY2xvbmVOb2RlKHRydWUpOmspfW8ubGVuZ3RoJiZjLmVhY2gobyxRYSl9cmV0dXJuIHRoaXN9fSk7Yy5mcmFnbWVudHM9e307Yy5lYWNoKHthcHBlbmRUbzoiYXBwZW5kIixwcmVwZW5kVG86InByZXBlbmQiLGluc2VydEJlZm9yZToiYmVmb3JlIixpbnNlcnRBZnRlcjoiYWZ0ZXIiLHJlcGxhY2VBbGw6InJlcGxhY2VXaXRoIn0sZnVuY3Rpb24oYSxiKXtjLmZuW2FdPWZ1bmN0aW9uKGQpe3ZhciBmPVtdO2Q9YyhkKTt2YXIgZT10aGlzLmxlbmd0aD09PTEmJnRoaXNbMF0ucGFyZW50Tm9kZTtpZihlJiZlLm5vZGVUeXBlPT09MTEmJmUuY2hpbGROb2Rlcy5sZW5ndGg9PT0xJiZkLmxlbmd0aD09PTEpe2RbYl0odGhpc1swXSk7DQpyZXR1cm4gdGhpc31lbHNle2U9MDtmb3IodmFyIGo9ZC5sZW5ndGg7ZTxqO2UrKyl7dmFyIGk9KGU+MD90aGlzLmNsb25lKHRydWUpOnRoaXMpLmdldCgpO2MuZm5bYl0uYXBwbHkoYyhkW2VdKSxpKTtmPWYuY29uY2F0KGkpfXJldHVybiB0aGlzLnB1c2hTdGFjayhmLGEsZC5zZWxlY3Rvcil9fX0pO2MuZXh0ZW5kKHtjbGVhbjpmdW5jdGlvbihhLGIsZCxmKXtiPWJ8fHM7aWYodHlwZW9mIGIuY3JlYXRlRWxlbWVudD09PSJ1bmRlZmluZWQiKWI9Yi5vd25lckRvY3VtZW50fHxiWzBdJiZiWzBdLm93bmVyRG9jdW1lbnR8fHM7Zm9yKHZhciBlPVtdLGo9MCxpOyhpPWFbal0pIT1udWxsO2orKyl7aWYodHlwZW9mIGk9PT0ibnVtYmVyIilpKz0iIjtpZihpKXtpZih0eXBlb2YgaT09PSJzdHJpbmciJiYhamIudGVzdChpKSlpPWIuY3JlYXRlVGV4dE5vZGUoaSk7ZWxzZSBpZih0eXBlb2YgaT09PSJzdHJpbmciKXtpPWkucmVwbGFjZShLYSxNYSk7dmFyIG89KExhLmV4ZWMoaSl8fFsiIiwNCiIiXSlbMV0udG9Mb3dlckNhc2UoKSxrPUZbb118fEYuX2RlZmF1bHQsbj1rWzBdLHI9Yi5jcmVhdGVFbGVtZW50KCJkaXYiKTtmb3Ioci5pbm5lckhUTUw9a1sxXStpK2tbMl07bi0tOylyPXIubGFzdENoaWxkO2lmKCFjLnN1cHBvcnQudGJvZHkpe249aWIudGVzdChpKTtvPW89PT0idGFibGUiJiYhbj9yLmZpcnN0Q2hpbGQmJnIuZmlyc3RDaGlsZC5jaGlsZE5vZGVzOmtbMV09PT0iPHRhYmxlPiImJiFuP3IuY2hpbGROb2RlczpbXTtmb3Ioaz1vLmxlbmd0aC0xO2s+PTA7LS1rKWMubm9kZU5hbWUob1trXSwidGJvZHkiKSYmIW9ba10uY2hpbGROb2Rlcy5sZW5ndGgmJm9ba10ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChvW2tdKX0hYy5zdXBwb3J0LmxlYWRpbmdXaGl0ZXNwYWNlJiZWLnRlc3QoaSkmJnIuaW5zZXJ0QmVmb3JlKGIuY3JlYXRlVGV4dE5vZGUoVi5leGVjKGkpWzBdKSxyLmZpcnN0Q2hpbGQpO2k9ci5jaGlsZE5vZGVzfWlmKGkubm9kZVR5cGUpZS5wdXNoKGkpO2Vsc2UgZT0NCmMubWVyZ2UoZSxpKX19aWYoZClmb3Ioaj0wO2Vbal07aisrKWlmKGYmJmMubm9kZU5hbWUoZVtqXSwic2NyaXB0IikmJighZVtqXS50eXBlfHxlW2pdLnR5cGUudG9Mb3dlckNhc2UoKT09PSJ0ZXh0L2phdmFzY3JpcHQiKSlmLnB1c2goZVtqXS5wYXJlbnROb2RlP2Vbal0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlW2pdKTplW2pdKTtlbHNle2Vbal0ubm9kZVR5cGU9PT0xJiZlLnNwbGljZS5hcHBseShlLFtqKzEsMF0uY29uY2F0KGMubWFrZUFycmF5KGVbal0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoInNjcmlwdCIpKSkpO2QuYXBwZW5kQ2hpbGQoZVtqXSl9cmV0dXJuIGV9LGNsZWFuRGF0YTpmdW5jdGlvbihhKXtmb3IodmFyIGIsZCxmPWMuY2FjaGUsZT1jLmV2ZW50LnNwZWNpYWwsaj1jLnN1cHBvcnQuZGVsZXRlRXhwYW5kbyxpPTAsbzsobz1hW2ldKSE9bnVsbDtpKyspaWYoZD1vW2MuZXhwYW5kb10pe2I9ZltkXTtpZihiLmV2ZW50cylmb3IodmFyIGsgaW4gYi5ldmVudHMpZVtrXT8NCmMuZXZlbnQucmVtb3ZlKG8sayk6Q2EobyxrLGIuaGFuZGxlKTtpZihqKWRlbGV0ZSBvW2MuZXhwYW5kb107ZWxzZSBvLnJlbW92ZUF0dHJpYnV0ZSYmby5yZW1vdmVBdHRyaWJ1dGUoYy5leHBhbmRvKTtkZWxldGUgZltkXX19fSk7dmFyIGtiPS96LT9pbmRleHxmb250LT93ZWlnaHR8b3BhY2l0eXx6b29tfGxpbmUtP2hlaWdodC9pLE5hPS9hbHBoYVwoW14pXSpcKS8sT2E9L29wYWNpdHk9KFteKV0qKS8saGE9L2Zsb2F0L2ksaWE9Ly0oW2Etel0pL2lnLGxiPS8oW0EtWl0pL2csbWI9L14tP1xkKyg/OnB4KT8kL2ksbmI9L14tP1xkLyxvYj17cG9zaXRpb246ImFic29sdXRlIix2aXNpYmlsaXR5OiJoaWRkZW4iLGRpc3BsYXk6ImJsb2NrIn0scGI9WyJMZWZ0IiwiUmlnaHQiXSxxYj1bIlRvcCIsIkJvdHRvbSJdLHJiPXMuZGVmYXVsdFZpZXcmJnMuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZSxQYT1jLnN1cHBvcnQuY3NzRmxvYXQ/ImNzc0Zsb2F0Ijoic3R5bGVGbG9hdCIsamE9DQpmdW5jdGlvbihhLGIpe3JldHVybiBiLnRvVXBwZXJDYXNlKCl9O2MuZm4uY3NzPWZ1bmN0aW9uKGEsYil7cmV0dXJuIFgodGhpcyxhLGIsdHJ1ZSxmdW5jdGlvbihkLGYsZSl7aWYoZT09PXcpcmV0dXJuIGMuY3VyQ1NTKGQsZik7aWYodHlwZW9mIGU9PT0ibnVtYmVyIiYmIWtiLnRlc3QoZikpZSs9InB4IjtjLnN0eWxlKGQsZixlKX0pfTtjLmV4dGVuZCh7c3R5bGU6ZnVuY3Rpb24oYSxiLGQpe2lmKCFhfHxhLm5vZGVUeXBlPT09M3x8YS5ub2RlVHlwZT09PTgpcmV0dXJuIHc7aWYoKGI9PT0id2lkdGgifHxiPT09ImhlaWdodCIpJiZwYXJzZUZsb2F0KGQpPDApZD13O3ZhciBmPWEuc3R5bGV8fGEsZT1kIT09dztpZighYy5zdXBwb3J0Lm9wYWNpdHkmJmI9PT0ib3BhY2l0eSIpe2lmKGUpe2Yuem9vbT0xO2I9cGFyc2VJbnQoZCwxMCkrIiI9PT0iTmFOIj8iIjoiYWxwaGEob3BhY2l0eT0iK2QqMTAwKyIpIjthPWYuZmlsdGVyfHxjLmN1ckNTUyhhLCJmaWx0ZXIiKXx8IiI7Zi5maWx0ZXI9DQpOYS50ZXN0KGEpP2EucmVwbGFjZShOYSxiKTpifXJldHVybiBmLmZpbHRlciYmZi5maWx0ZXIuaW5kZXhPZigib3BhY2l0eT0iKT49MD9wYXJzZUZsb2F0KE9hLmV4ZWMoZi5maWx0ZXIpWzFdKS8xMDArIiI6IiJ9aWYoaGEudGVzdChiKSliPVBhO2I9Yi5yZXBsYWNlKGlhLGphKTtpZihlKWZbYl09ZDtyZXR1cm4gZltiXX0sY3NzOmZ1bmN0aW9uKGEsYixkLGYpe2lmKGI9PT0id2lkdGgifHxiPT09ImhlaWdodCIpe3ZhciBlLGo9Yj09PSJ3aWR0aCI/cGI6cWI7ZnVuY3Rpb24gaSgpe2U9Yj09PSJ3aWR0aCI/YS5vZmZzZXRXaWR0aDphLm9mZnNldEhlaWdodDtmIT09ImJvcmRlciImJmMuZWFjaChqLGZ1bmN0aW9uKCl7Znx8KGUtPXBhcnNlRmxvYXQoYy5jdXJDU1MoYSwicGFkZGluZyIrdGhpcyx0cnVlKSl8fDApO2lmKGY9PT0ibWFyZ2luIillKz1wYXJzZUZsb2F0KGMuY3VyQ1NTKGEsIm1hcmdpbiIrdGhpcyx0cnVlKSl8fDA7ZWxzZSBlLT1wYXJzZUZsb2F0KGMuY3VyQ1NTKGEsDQoiYm9yZGVyIit0aGlzKyJXaWR0aCIsdHJ1ZSkpfHwwfSl9YS5vZmZzZXRXaWR0aCE9PTA/aSgpOmMuc3dhcChhLG9iLGkpO3JldHVybiBNYXRoLm1heCgwLE1hdGgucm91bmQoZSkpfXJldHVybiBjLmN1ckNTUyhhLGIsZCl9LGN1ckNTUzpmdW5jdGlvbihhLGIsZCl7dmFyIGYsZT1hLnN0eWxlO2lmKCFjLnN1cHBvcnQub3BhY2l0eSYmYj09PSJvcGFjaXR5IiYmYS5jdXJyZW50U3R5bGUpe2Y9T2EudGVzdChhLmN1cnJlbnRTdHlsZS5maWx0ZXJ8fCIiKT9wYXJzZUZsb2F0KFJlZ0V4cC4kMSkvMTAwKyIiOiIiO3JldHVybiBmPT09IiI/IjEiOmZ9aWYoaGEudGVzdChiKSliPVBhO2lmKCFkJiZlJiZlW2JdKWY9ZVtiXTtlbHNlIGlmKHJiKXtpZihoYS50ZXN0KGIpKWI9ImZsb2F0IjtiPWIucmVwbGFjZShsYiwiLSQxIikudG9Mb3dlckNhc2UoKTtlPWEub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldztpZighZSlyZXR1cm4gbnVsbDtpZihhPWUuZ2V0Q29tcHV0ZWRTdHlsZShhLG51bGwpKWY9DQphLmdldFByb3BlcnR5VmFsdWUoYik7aWYoYj09PSJvcGFjaXR5IiYmZj09PSIiKWY9IjEifWVsc2UgaWYoYS5jdXJyZW50U3R5bGUpe2Q9Yi5yZXBsYWNlKGlhLGphKTtmPWEuY3VycmVudFN0eWxlW2JdfHxhLmN1cnJlbnRTdHlsZVtkXTtpZighbWIudGVzdChmKSYmbmIudGVzdChmKSl7Yj1lLmxlZnQ7dmFyIGo9YS5ydW50aW1lU3R5bGUubGVmdDthLnJ1bnRpbWVTdHlsZS5sZWZ0PWEuY3VycmVudFN0eWxlLmxlZnQ7ZS5sZWZ0PWQ9PT0iZm9udFNpemUiPyIxZW0iOmZ8fDA7Zj1lLnBpeGVsTGVmdCsicHgiO2UubGVmdD1iO2EucnVudGltZVN0eWxlLmxlZnQ9an19cmV0dXJuIGZ9LHN3YXA6ZnVuY3Rpb24oYSxiLGQpe3ZhciBmPXt9O2Zvcih2YXIgZSBpbiBiKXtmW2VdPWEuc3R5bGVbZV07YS5zdHlsZVtlXT1iW2VdfWQuY2FsbChhKTtmb3IoZSBpbiBiKWEuc3R5bGVbZV09ZltlXX19KTtpZihjLmV4cHImJmMuZXhwci5maWx0ZXJzKXtjLmV4cHIuZmlsdGVycy5oaWRkZW49ZnVuY3Rpb24oYSl7dmFyIGI9DQphLm9mZnNldFdpZHRoLGQ9YS5vZmZzZXRIZWlnaHQsZj1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT0idHIiO3JldHVybiBiPT09MCYmZD09PTAmJiFmP3RydWU6Yj4wJiZkPjAmJiFmP2ZhbHNlOmMuY3VyQ1NTKGEsImRpc3BsYXkiKT09PSJub25lIn07Yy5leHByLmZpbHRlcnMudmlzaWJsZT1mdW5jdGlvbihhKXtyZXR1cm4hYy5leHByLmZpbHRlcnMuaGlkZGVuKGEpfX12YXIgc2I9SigpLHRiPS88c2NyaXB0KC58XHMpKj9cL3NjcmlwdD4vZ2ksdWI9L3NlbGVjdHx0ZXh0YXJlYS9pLHZiPS9jb2xvcnxkYXRlfGRhdGV0aW1lfGVtYWlsfGhpZGRlbnxtb250aHxudW1iZXJ8cGFzc3dvcmR8cmFuZ2V8c2VhcmNofHRlbHx0ZXh0fHRpbWV8dXJsfHdlZWsvaSxOPS89XD8oJnwkKS8sa2E9L1w/Lyx3Yj0vKFw/fCYpXz0uKj8oJnwkKS8seGI9L14oXHcrOik/XC9cLyhbXlwvPyNdKykvLHliPS8lMjAvZyx6Yj1jLmZuLmxvYWQ7Yy5mbi5leHRlbmQoe2xvYWQ6ZnVuY3Rpb24oYSxiLGQpe2lmKHR5cGVvZiBhIT09DQoic3RyaW5nIilyZXR1cm4gemIuY2FsbCh0aGlzLGEpO2Vsc2UgaWYoIXRoaXMubGVuZ3RoKXJldHVybiB0aGlzO3ZhciBmPWEuaW5kZXhPZigiICIpO2lmKGY+PTApe3ZhciBlPWEuc2xpY2UoZixhLmxlbmd0aCk7YT1hLnNsaWNlKDAsZil9Zj0iR0VUIjtpZihiKWlmKGMuaXNGdW5jdGlvbihiKSl7ZD1iO2I9bnVsbH1lbHNlIGlmKHR5cGVvZiBiPT09Im9iamVjdCIpe2I9Yy5wYXJhbShiLGMuYWpheFNldHRpbmdzLnRyYWRpdGlvbmFsKTtmPSJQT1NUIn12YXIgaj10aGlzO2MuYWpheCh7dXJsOmEsdHlwZTpmLGRhdGFUeXBlOiJodG1sIixkYXRhOmIsY29tcGxldGU6ZnVuY3Rpb24oaSxvKXtpZihvPT09InN1Y2Nlc3MifHxvPT09Im5vdG1vZGlmaWVkIilqLmh0bWwoZT9jKCI8ZGl2IC8+IikuYXBwZW5kKGkucmVzcG9uc2VUZXh0LnJlcGxhY2UodGIsIiIpKS5maW5kKGUpOmkucmVzcG9uc2VUZXh0KTtkJiZqLmVhY2goZCxbaS5yZXNwb25zZVRleHQsbyxpXSl9fSk7cmV0dXJuIHRoaXN9LA0Kc2VyaWFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIGMucGFyYW0odGhpcy5zZXJpYWxpemVBcnJheSgpKX0sc2VyaWFsaXplQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbGVtZW50cz9jLm1ha2VBcnJheSh0aGlzLmVsZW1lbnRzKTp0aGlzfSkuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmFtZSYmIXRoaXMuZGlzYWJsZWQmJih0aGlzLmNoZWNrZWR8fHViLnRlc3QodGhpcy5ub2RlTmFtZSl8fHZiLnRlc3QodGhpcy50eXBlKSl9KS5tYXAoZnVuY3Rpb24oYSxiKXthPWModGhpcykudmFsKCk7cmV0dXJuIGE9PW51bGw/bnVsbDpjLmlzQXJyYXkoYSk/Yy5tYXAoYSxmdW5jdGlvbihkKXtyZXR1cm57bmFtZTpiLm5hbWUsdmFsdWU6ZH19KTp7bmFtZTpiLm5hbWUsdmFsdWU6YX19KS5nZXQoKX19KTtjLmVhY2goImFqYXhTdGFydCBhamF4U3RvcCBhamF4Q29tcGxldGUgYWpheEVycm9yIGFqYXhTdWNjZXNzIGFqYXhTZW5kIi5zcGxpdCgiICIpLA0KZnVuY3Rpb24oYSxiKXtjLmZuW2JdPWZ1bmN0aW9uKGQpe3JldHVybiB0aGlzLmJpbmQoYixkKX19KTtjLmV4dGVuZCh7Z2V0OmZ1bmN0aW9uKGEsYixkLGYpe2lmKGMuaXNGdW5jdGlvbihiKSl7Zj1mfHxkO2Q9YjtiPW51bGx9cmV0dXJuIGMuYWpheCh7dHlwZToiR0VUIix1cmw6YSxkYXRhOmIsc3VjY2VzczpkLGRhdGFUeXBlOmZ9KX0sZ2V0U2NyaXB0OmZ1bmN0aW9uKGEsYil7cmV0dXJuIGMuZ2V0KGEsbnVsbCxiLCJzY3JpcHQiKX0sZ2V0SlNPTjpmdW5jdGlvbihhLGIsZCl7cmV0dXJuIGMuZ2V0KGEsYixkLCJqc29uIil9LHBvc3Q6ZnVuY3Rpb24oYSxiLGQsZil7aWYoYy5pc0Z1bmN0aW9uKGIpKXtmPWZ8fGQ7ZD1iO2I9e319cmV0dXJuIGMuYWpheCh7dHlwZToiUE9TVCIsdXJsOmEsZGF0YTpiLHN1Y2Nlc3M6ZCxkYXRhVHlwZTpmfSl9LGFqYXhTZXR1cDpmdW5jdGlvbihhKXtjLmV4dGVuZChjLmFqYXhTZXR0aW5ncyxhKX0sYWpheFNldHRpbmdzOnt1cmw6bG9jYXRpb24uaHJlZiwNCmdsb2JhbDp0cnVlLHR5cGU6IkdFVCIsY29udGVudFR5cGU6ImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIscHJvY2Vzc0RhdGE6dHJ1ZSxhc3luYzp0cnVlLHhocjpBLlhNTEh0dHBSZXF1ZXN0JiYoQS5sb2NhdGlvbi5wcm90b2NvbCE9PSJmaWxlOiJ8fCFBLkFjdGl2ZVhPYmplY3QpP2Z1bmN0aW9uKCl7cmV0dXJuIG5ldyBBLlhNTEh0dHBSZXF1ZXN0fTpmdW5jdGlvbigpe3RyeXtyZXR1cm4gbmV3IEEuQWN0aXZlWE9iamVjdCgiTWljcm9zb2Z0LlhNTEhUVFAiKX1jYXRjaChhKXt9fSxhY2NlcHRzOnt4bWw6ImFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwiLGh0bWw6InRleHQvaHRtbCIsc2NyaXB0OiJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQiLGpzb246ImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCIsdGV4dDoidGV4dC9wbGFpbiIsX2RlZmF1bHQ6IiovKiJ9fSxsYXN0TW9kaWZpZWQ6e30sZXRhZzp7fSxhamF4OmZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXtlLnN1Y2Nlc3MmJg0KZS5zdWNjZXNzLmNhbGwoayxvLGkseCk7ZS5nbG9iYWwmJmYoImFqYXhTdWNjZXNzIixbeCxlXSl9ZnVuY3Rpb24gZCgpe2UuY29tcGxldGUmJmUuY29tcGxldGUuY2FsbChrLHgsaSk7ZS5nbG9iYWwmJmYoImFqYXhDb21wbGV0ZSIsW3gsZV0pO2UuZ2xvYmFsJiYhLS1jLmFjdGl2ZSYmYy5ldmVudC50cmlnZ2VyKCJhamF4U3RvcCIpfWZ1bmN0aW9uIGYocSxwKXsoZS5jb250ZXh0P2MoZS5jb250ZXh0KTpjLmV2ZW50KS50cmlnZ2VyKHEscCl9dmFyIGU9Yy5leHRlbmQodHJ1ZSx7fSxjLmFqYXhTZXR0aW5ncyxhKSxqLGksbyxrPWEmJmEuY29udGV4dHx8ZSxuPWUudHlwZS50b1VwcGVyQ2FzZSgpO2lmKGUuZGF0YSYmZS5wcm9jZXNzRGF0YSYmdHlwZW9mIGUuZGF0YSE9PSJzdHJpbmciKWUuZGF0YT1jLnBhcmFtKGUuZGF0YSxlLnRyYWRpdGlvbmFsKTtpZihlLmRhdGFUeXBlPT09Impzb25wIil7aWYobj09PSJHRVQiKU4udGVzdChlLnVybCl8fChlLnVybCs9KGthLnRlc3QoZS51cmwpPw0KIiYiOiI/IikrKGUuanNvbnB8fCJjYWxsYmFjayIpKyI9PyIpO2Vsc2UgaWYoIWUuZGF0YXx8IU4udGVzdChlLmRhdGEpKWUuZGF0YT0oZS5kYXRhP2UuZGF0YSsiJiI6IiIpKyhlLmpzb25wfHwiY2FsbGJhY2siKSsiPT8iO2UuZGF0YVR5cGU9Impzb24ifWlmKGUuZGF0YVR5cGU9PT0ianNvbiImJihlLmRhdGEmJk4udGVzdChlLmRhdGEpfHxOLnRlc3QoZS51cmwpKSl7aj1lLmpzb25wQ2FsbGJhY2t8fCJqc29ucCIrc2IrKztpZihlLmRhdGEpZS5kYXRhPShlLmRhdGErIiIpLnJlcGxhY2UoTiwiPSIraisiJDEiKTtlLnVybD1lLnVybC5yZXBsYWNlKE4sIj0iK2orIiQxIik7ZS5kYXRhVHlwZT0ic2NyaXB0IjtBW2pdPUFbal18fGZ1bmN0aW9uKHEpe289cTtiKCk7ZCgpO0Fbal09dzt0cnl7ZGVsZXRlIEFbal19Y2F0Y2gocCl7fXomJnoucmVtb3ZlQ2hpbGQoQyl9fWlmKGUuZGF0YVR5cGU9PT0ic2NyaXB0IiYmZS5jYWNoZT09PW51bGwpZS5jYWNoZT1mYWxzZTtpZihlLmNhY2hlPT09DQpmYWxzZSYmbj09PSJHRVQiKXt2YXIgcj1KKCksdT1lLnVybC5yZXBsYWNlKHdiLCIkMV89IityKyIkMiIpO2UudXJsPXUrKHU9PT1lLnVybD8oa2EudGVzdChlLnVybCk/IiYiOiI/IikrIl89IityOiIiKX1pZihlLmRhdGEmJm49PT0iR0VUIillLnVybCs9KGthLnRlc3QoZS51cmwpPyImIjoiPyIpK2UuZGF0YTtlLmdsb2JhbCYmIWMuYWN0aXZlKysmJmMuZXZlbnQudHJpZ2dlcigiYWpheFN0YXJ0Iik7cj0ocj14Yi5leGVjKGUudXJsKSkmJihyWzFdJiZyWzFdIT09bG9jYXRpb24ucHJvdG9jb2x8fHJbMl0hPT1sb2NhdGlvbi5ob3N0KTtpZihlLmRhdGFUeXBlPT09InNjcmlwdCImJm49PT0iR0VUIiYmcil7dmFyIHo9cy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdfHxzLmRvY3VtZW50RWxlbWVudCxDPXMuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7Qy5zcmM9ZS51cmw7aWYoZS5zY3JpcHRDaGFyc2V0KUMuY2hhcnNldD1lLnNjcmlwdENoYXJzZXQ7aWYoIWope3ZhciBCPQ0KZmFsc2U7Qy5vbmxvYWQ9Qy5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXtpZighQiYmKCF0aGlzLnJlYWR5U3RhdGV8fHRoaXMucmVhZHlTdGF0ZT09PSJsb2FkZWQifHx0aGlzLnJlYWR5U3RhdGU9PT0iY29tcGxldGUiKSl7Qj10cnVlO2IoKTtkKCk7Qy5vbmxvYWQ9Qy5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbDt6JiZDLnBhcmVudE5vZGUmJnoucmVtb3ZlQ2hpbGQoQyl9fX16Lmluc2VydEJlZm9yZShDLHouZmlyc3RDaGlsZCk7cmV0dXJuIHd9dmFyIEU9ZmFsc2UseD1lLnhocigpO2lmKHgpe2UudXNlcm5hbWU/eC5vcGVuKG4sZS51cmwsZS5hc3luYyxlLnVzZXJuYW1lLGUucGFzc3dvcmQpOngub3BlbihuLGUudXJsLGUuYXN5bmMpO3RyeXtpZihlLmRhdGF8fGEmJmEuY29udGVudFR5cGUpeC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLGUuY29udGVudFR5cGUpO2lmKGUuaWZNb2RpZmllZCl7Yy5sYXN0TW9kaWZpZWRbZS51cmxdJiZ4LnNldFJlcXVlc3RIZWFkZXIoIklmLU1vZGlmaWVkLVNpbmNlIiwNCmMubGFzdE1vZGlmaWVkW2UudXJsXSk7Yy5ldGFnW2UudXJsXSYmeC5zZXRSZXF1ZXN0SGVhZGVyKCJJZi1Ob25lLU1hdGNoIixjLmV0YWdbZS51cmxdKX1yfHx4LnNldFJlcXVlc3RIZWFkZXIoIlgtUmVxdWVzdGVkLVdpdGgiLCJYTUxIdHRwUmVxdWVzdCIpO3guc2V0UmVxdWVzdEhlYWRlcigiQWNjZXB0IixlLmRhdGFUeXBlJiZlLmFjY2VwdHNbZS5kYXRhVHlwZV0/ZS5hY2NlcHRzW2UuZGF0YVR5cGVdKyIsICovKiI6ZS5hY2NlcHRzLl9kZWZhdWx0KX1jYXRjaChnYSl7fWlmKGUuYmVmb3JlU2VuZCYmZS5iZWZvcmVTZW5kLmNhbGwoayx4LGUpPT09ZmFsc2Upe2UuZ2xvYmFsJiYhLS1jLmFjdGl2ZSYmYy5ldmVudC50cmlnZ2VyKCJhamF4U3RvcCIpO3guYWJvcnQoKTtyZXR1cm4gZmFsc2V9ZS5nbG9iYWwmJmYoImFqYXhTZW5kIixbeCxlXSk7dmFyIGc9eC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24ocSl7aWYoIXh8fHgucmVhZHlTdGF0ZT09PTB8fHE9PT0iYWJvcnQiKXtFfHwNCmQoKTtFPXRydWU7aWYoeCl4Lm9ucmVhZHlzdGF0ZWNoYW5nZT1jLm5vb3B9ZWxzZSBpZighRSYmeCYmKHgucmVhZHlTdGF0ZT09PTR8fHE9PT0idGltZW91dCIpKXtFPXRydWU7eC5vbnJlYWR5c3RhdGVjaGFuZ2U9Yy5ub29wO2k9cT09PSJ0aW1lb3V0Ij8idGltZW91dCI6IWMuaHR0cFN1Y2Nlc3MoeCk/ImVycm9yIjplLmlmTW9kaWZpZWQmJmMuaHR0cE5vdE1vZGlmaWVkKHgsZS51cmwpPyJub3Rtb2RpZmllZCI6InN1Y2Nlc3MiO3ZhciBwO2lmKGk9PT0ic3VjY2VzcyIpdHJ5e289Yy5odHRwRGF0YSh4LGUuZGF0YVR5cGUsZSl9Y2F0Y2godil7aT0icGFyc2VyZXJyb3IiO3A9dn1pZihpPT09InN1Y2Nlc3MifHxpPT09Im5vdG1vZGlmaWVkIilqfHxiKCk7ZWxzZSBjLmhhbmRsZUVycm9yKGUseCxpLHApO2QoKTtxPT09InRpbWVvdXQiJiZ4LmFib3J0KCk7aWYoZS5hc3luYyl4PW51bGx9fTt0cnl7dmFyIGg9eC5hYm9ydDt4LmFib3J0PWZ1bmN0aW9uKCl7eCYmaC5jYWxsKHgpOw0KZygiYWJvcnQiKX19Y2F0Y2gobCl7fWUuYXN5bmMmJmUudGltZW91dD4wJiZzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7eCYmIUUmJmcoInRpbWVvdXQiKX0sZS50aW1lb3V0KTt0cnl7eC5zZW5kKG49PT0iUE9TVCJ8fG49PT0iUFVUInx8bj09PSJERUxFVEUiP2UuZGF0YTpudWxsKX1jYXRjaChtKXtjLmhhbmRsZUVycm9yKGUseCxudWxsLG0pO2QoKX1lLmFzeW5jfHxnKCk7cmV0dXJuIHh9fSxoYW5kbGVFcnJvcjpmdW5jdGlvbihhLGIsZCxmKXtpZihhLmVycm9yKWEuZXJyb3IuY2FsbChhLmNvbnRleHR8fGEsYixkLGYpO2lmKGEuZ2xvYmFsKShhLmNvbnRleHQ/YyhhLmNvbnRleHQpOmMuZXZlbnQpLnRyaWdnZXIoImFqYXhFcnJvciIsW2IsYSxmXSl9LGFjdGl2ZTowLGh0dHBTdWNjZXNzOmZ1bmN0aW9uKGEpe3RyeXtyZXR1cm4hYS5zdGF0dXMmJmxvY2F0aW9uLnByb3RvY29sPT09ImZpbGU6Inx8YS5zdGF0dXM+PTIwMCYmYS5zdGF0dXM8MzAwfHxhLnN0YXR1cz09PTMwNHx8YS5zdGF0dXM9PT0NCjEyMjN8fGEuc3RhdHVzPT09MH1jYXRjaChiKXt9cmV0dXJuIGZhbHNlfSxodHRwTm90TW9kaWZpZWQ6ZnVuY3Rpb24oYSxiKXt2YXIgZD1hLmdldFJlc3BvbnNlSGVhZGVyKCJMYXN0LU1vZGlmaWVkIiksZj1hLmdldFJlc3BvbnNlSGVhZGVyKCJFdGFnIik7aWYoZCljLmxhc3RNb2RpZmllZFtiXT1kO2lmKGYpYy5ldGFnW2JdPWY7cmV0dXJuIGEuc3RhdHVzPT09MzA0fHxhLnN0YXR1cz09PTB9LGh0dHBEYXRhOmZ1bmN0aW9uKGEsYixkKXt2YXIgZj1hLmdldFJlc3BvbnNlSGVhZGVyKCJjb250ZW50LXR5cGUiKXx8IiIsZT1iPT09InhtbCJ8fCFiJiZmLmluZGV4T2YoInhtbCIpPj0wO2E9ZT9hLnJlc3BvbnNlWE1MOmEucmVzcG9uc2VUZXh0O2UmJmEuZG9jdW1lbnRFbGVtZW50Lm5vZGVOYW1lPT09InBhcnNlcmVycm9yIiYmYy5lcnJvcigicGFyc2VyZXJyb3IiKTtpZihkJiZkLmRhdGFGaWx0ZXIpYT1kLmRhdGFGaWx0ZXIoYSxiKTtpZih0eXBlb2YgYT09PSJzdHJpbmciKWlmKGI9PT0NCiJqc29uInx8IWImJmYuaW5kZXhPZigianNvbiIpPj0wKWE9Yy5wYXJzZUpTT04oYSk7ZWxzZSBpZihiPT09InNjcmlwdCJ8fCFiJiZmLmluZGV4T2YoImphdmFzY3JpcHQiKT49MCljLmdsb2JhbEV2YWwoYSk7cmV0dXJuIGF9LHBhcmFtOmZ1bmN0aW9uKGEsYil7ZnVuY3Rpb24gZChpLG8pe2lmKGMuaXNBcnJheShvKSljLmVhY2gobyxmdW5jdGlvbihrLG4pe2J8fC9cW1xdJC8udGVzdChpKT9mKGksbik6ZChpKyJbIisodHlwZW9mIG49PT0ib2JqZWN0Inx8Yy5pc0FycmF5KG4pP2s6IiIpKyJdIixuKX0pO2Vsc2UhYiYmbyE9bnVsbCYmdHlwZW9mIG89PT0ib2JqZWN0Ij9jLmVhY2gobyxmdW5jdGlvbihrLG4pe2QoaSsiWyIraysiXSIsbil9KTpmKGksbyl9ZnVuY3Rpb24gZihpLG8pe289Yy5pc0Z1bmN0aW9uKG8pP28oKTpvO2VbZS5sZW5ndGhdPWVuY29kZVVSSUNvbXBvbmVudChpKSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KG8pfXZhciBlPVtdO2lmKGI9PT13KWI9Yy5hamF4U2V0dGluZ3MudHJhZGl0aW9uYWw7DQppZihjLmlzQXJyYXkoYSl8fGEuanF1ZXJ5KWMuZWFjaChhLGZ1bmN0aW9uKCl7Zih0aGlzLm5hbWUsdGhpcy52YWx1ZSl9KTtlbHNlIGZvcih2YXIgaiBpbiBhKWQoaixhW2pdKTtyZXR1cm4gZS5qb2luKCImIikucmVwbGFjZSh5YiwiKyIpfX0pO3ZhciBsYT17fSxBYj0vdG9nZ2xlfHNob3d8aGlkZS8sQmI9L14oWystXT0pPyhbXGQrLS5dKykoLiopJC8sVyx2YT1bWyJoZWlnaHQiLCJtYXJnaW5Ub3AiLCJtYXJnaW5Cb3R0b20iLCJwYWRkaW5nVG9wIiwicGFkZGluZ0JvdHRvbSJdLFsid2lkdGgiLCJtYXJnaW5MZWZ0IiwibWFyZ2luUmlnaHQiLCJwYWRkaW5nTGVmdCIsInBhZGRpbmdSaWdodCJdLFsib3BhY2l0eSJdXTtjLmZuLmV4dGVuZCh7c2hvdzpmdW5jdGlvbihhLGIpe2lmKGF8fGE9PT0wKXJldHVybiB0aGlzLmFuaW1hdGUoSygic2hvdyIsMyksYSxiKTtlbHNle2E9MDtmb3IoYj10aGlzLmxlbmd0aDthPGI7YSsrKXt2YXIgZD1jLmRhdGEodGhpc1thXSwib2xkZGlzcGxheSIpOw0KdGhpc1thXS5zdHlsZS5kaXNwbGF5PWR8fCIiO2lmKGMuY3NzKHRoaXNbYV0sImRpc3BsYXkiKT09PSJub25lIil7ZD10aGlzW2FdLm5vZGVOYW1lO3ZhciBmO2lmKGxhW2RdKWY9bGFbZF07ZWxzZXt2YXIgZT1jKCI8IitkKyIgLz4iKS5hcHBlbmRUbygiYm9keSIpO2Y9ZS5jc3MoImRpc3BsYXkiKTtpZihmPT09Im5vbmUiKWY9ImJsb2NrIjtlLnJlbW92ZSgpO2xhW2RdPWZ9Yy5kYXRhKHRoaXNbYV0sIm9sZGRpc3BsYXkiLGYpfX1hPTA7Zm9yKGI9dGhpcy5sZW5ndGg7YTxiO2ErKyl0aGlzW2FdLnN0eWxlLmRpc3BsYXk9Yy5kYXRhKHRoaXNbYV0sIm9sZGRpc3BsYXkiKXx8IiI7cmV0dXJuIHRoaXN9fSxoaWRlOmZ1bmN0aW9uKGEsYil7aWYoYXx8YT09PTApcmV0dXJuIHRoaXMuYW5pbWF0ZShLKCJoaWRlIiwzKSxhLGIpO2Vsc2V7YT0wO2ZvcihiPXRoaXMubGVuZ3RoO2E8YjthKyspe3ZhciBkPWMuZGF0YSh0aGlzW2FdLCJvbGRkaXNwbGF5Iik7IWQmJmQhPT0ibm9uZSImJmMuZGF0YSh0aGlzW2FdLA0KIm9sZGRpc3BsYXkiLGMuY3NzKHRoaXNbYV0sImRpc3BsYXkiKSl9YT0wO2ZvcihiPXRoaXMubGVuZ3RoO2E8YjthKyspdGhpc1thXS5zdHlsZS5kaXNwbGF5PSJub25lIjtyZXR1cm4gdGhpc319LF90b2dnbGU6Yy5mbi50b2dnbGUsdG9nZ2xlOmZ1bmN0aW9uKGEsYil7dmFyIGQ9dHlwZW9mIGE9PT0iYm9vbGVhbiI7aWYoYy5pc0Z1bmN0aW9uKGEpJiZjLmlzRnVuY3Rpb24oYikpdGhpcy5fdG9nZ2xlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtlbHNlIGE9PW51bGx8fGQ/dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGY9ZD9hOmModGhpcykuaXMoIjpoaWRkZW4iKTtjKHRoaXMpW2Y/InNob3ciOiJoaWRlIl0oKX0pOnRoaXMuYW5pbWF0ZShLKCJ0b2dnbGUiLDMpLGEsYik7cmV0dXJuIHRoaXN9LGZhZGVUbzpmdW5jdGlvbihhLGIsZCl7cmV0dXJuIHRoaXMuZmlsdGVyKCI6aGlkZGVuIikuY3NzKCJvcGFjaXR5IiwwKS5zaG93KCkuZW5kKCkuYW5pbWF0ZSh7b3BhY2l0eTpifSxhLGQpfSwNCmFuaW1hdGU6ZnVuY3Rpb24oYSxiLGQsZil7dmFyIGU9Yy5zcGVlZChiLGQsZik7aWYoYy5pc0VtcHR5T2JqZWN0KGEpKXJldHVybiB0aGlzLmVhY2goZS5jb21wbGV0ZSk7cmV0dXJuIHRoaXNbZS5xdWV1ZT09PWZhbHNlPyJlYWNoIjoicXVldWUiXShmdW5jdGlvbigpe3ZhciBqPWMuZXh0ZW5kKHt9LGUpLGksbz10aGlzLm5vZGVUeXBlPT09MSYmYyh0aGlzKS5pcygiOmhpZGRlbiIpLGs9dGhpcztmb3IoaSBpbiBhKXt2YXIgbj1pLnJlcGxhY2UoaWEsamEpO2lmKGkhPT1uKXthW25dPWFbaV07ZGVsZXRlIGFbaV07aT1ufWlmKGFbaV09PT0iaGlkZSImJm98fGFbaV09PT0ic2hvdyImJiFvKXJldHVybiBqLmNvbXBsZXRlLmNhbGwodGhpcyk7aWYoKGk9PT0iaGVpZ2h0Inx8aT09PSJ3aWR0aCIpJiZ0aGlzLnN0eWxlKXtqLmRpc3BsYXk9Yy5jc3ModGhpcywiZGlzcGxheSIpO2oub3ZlcmZsb3c9dGhpcy5zdHlsZS5vdmVyZmxvd31pZihjLmlzQXJyYXkoYVtpXSkpeyhqLnNwZWNpYWxFYXNpbmc9DQpqLnNwZWNpYWxFYXNpbmd8fHt9KVtpXT1hW2ldWzFdO2FbaV09YVtpXVswXX19aWYoai5vdmVyZmxvdyE9bnVsbCl0aGlzLnN0eWxlLm92ZXJmbG93PSJoaWRkZW4iO2ouY3VyQW5pbT1jLmV4dGVuZCh7fSxhKTtjLmVhY2goYSxmdW5jdGlvbihyLHUpe3ZhciB6PW5ldyBjLmZ4KGssaixyKTtpZihBYi50ZXN0KHUpKXpbdT09PSJ0b2dnbGUiP28/InNob3ciOiJoaWRlIjp1XShhKTtlbHNle3ZhciBDPUJiLmV4ZWModSksQj16LmN1cih0cnVlKXx8MDtpZihDKXt1PXBhcnNlRmxvYXQoQ1syXSk7dmFyIEU9Q1szXXx8InB4IjtpZihFIT09InB4Iil7ay5zdHlsZVtyXT0odXx8MSkrRTtCPSh1fHwxKS96LmN1cih0cnVlKSpCO2suc3R5bGVbcl09QitFfWlmKENbMV0pdT0oQ1sxXT09PSItPSI/LTE6MSkqdStCO3ouY3VzdG9tKEIsdSxFKX1lbHNlIHouY3VzdG9tKEIsdSwiIil9fSk7cmV0dXJuIHRydWV9KX0sc3RvcDpmdW5jdGlvbihhLGIpe3ZhciBkPWMudGltZXJzO2EmJnRoaXMucXVldWUoW10pOw0KdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Zm9yKHZhciBmPWQubGVuZ3RoLTE7Zj49MDtmLS0paWYoZFtmXS5lbGVtPT09dGhpcyl7YiYmZFtmXSh0cnVlKTtkLnNwbGljZShmLDEpfX0pO2J8fHRoaXMuZGVxdWV1ZSgpO3JldHVybiB0aGlzfX0pO2MuZWFjaCh7c2xpZGVEb3duOksoInNob3ciLDEpLHNsaWRlVXA6SygiaGlkZSIsMSksc2xpZGVUb2dnbGU6SygidG9nZ2xlIiwxKSxmYWRlSW46e29wYWNpdHk6InNob3cifSxmYWRlT3V0OntvcGFjaXR5OiJoaWRlIn19LGZ1bmN0aW9uKGEsYil7Yy5mblthXT1mdW5jdGlvbihkLGYpe3JldHVybiB0aGlzLmFuaW1hdGUoYixkLGYpfX0pO2MuZXh0ZW5kKHtzcGVlZDpmdW5jdGlvbihhLGIsZCl7dmFyIGY9YSYmdHlwZW9mIGE9PT0ib2JqZWN0Ij9hOntjb21wbGV0ZTpkfHwhZCYmYnx8Yy5pc0Z1bmN0aW9uKGEpJiZhLGR1cmF0aW9uOmEsZWFzaW5nOmQmJmJ8fGImJiFjLmlzRnVuY3Rpb24oYikmJmJ9O2YuZHVyYXRpb249Yy5meC5vZmY/MDp0eXBlb2YgZi5kdXJhdGlvbj09PQ0KIm51bWJlciI/Zi5kdXJhdGlvbjpjLmZ4LnNwZWVkc1tmLmR1cmF0aW9uXXx8Yy5meC5zcGVlZHMuX2RlZmF1bHQ7Zi5vbGQ9Zi5jb21wbGV0ZTtmLmNvbXBsZXRlPWZ1bmN0aW9uKCl7Zi5xdWV1ZSE9PWZhbHNlJiZjKHRoaXMpLmRlcXVldWUoKTtjLmlzRnVuY3Rpb24oZi5vbGQpJiZmLm9sZC5jYWxsKHRoaXMpfTtyZXR1cm4gZn0sZWFzaW5nOntsaW5lYXI6ZnVuY3Rpb24oYSxiLGQsZil7cmV0dXJuIGQrZiphfSxzd2luZzpmdW5jdGlvbihhLGIsZCxmKXtyZXR1cm4oLU1hdGguY29zKGEqTWF0aC5QSSkvMiswLjUpKmYrZH19LHRpbWVyczpbXSxmeDpmdW5jdGlvbihhLGIsZCl7dGhpcy5vcHRpb25zPWI7dGhpcy5lbGVtPWE7dGhpcy5wcm9wPWQ7aWYoIWIub3JpZyliLm9yaWc9e319fSk7Yy5meC5wcm90b3R5cGU9e3VwZGF0ZTpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5zdGVwJiZ0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKHRoaXMuZWxlbSx0aGlzLm5vdyx0aGlzKTsoYy5meC5zdGVwW3RoaXMucHJvcF18fA0KYy5meC5zdGVwLl9kZWZhdWx0KSh0aGlzKTtpZigodGhpcy5wcm9wPT09ImhlaWdodCJ8fHRoaXMucHJvcD09PSJ3aWR0aCIpJiZ0aGlzLmVsZW0uc3R5bGUpdGhpcy5lbGVtLnN0eWxlLmRpc3BsYXk9ImJsb2NrIn0sY3VyOmZ1bmN0aW9uKGEpe2lmKHRoaXMuZWxlbVt0aGlzLnByb3BdIT1udWxsJiYoIXRoaXMuZWxlbS5zdHlsZXx8dGhpcy5lbGVtLnN0eWxlW3RoaXMucHJvcF09PW51bGwpKXJldHVybiB0aGlzLmVsZW1bdGhpcy5wcm9wXTtyZXR1cm4oYT1wYXJzZUZsb2F0KGMuY3NzKHRoaXMuZWxlbSx0aGlzLnByb3AsYSkpKSYmYT4tMTAwMDA/YTpwYXJzZUZsb2F0KGMuY3VyQ1NTKHRoaXMuZWxlbSx0aGlzLnByb3ApKXx8MH0sY3VzdG9tOmZ1bmN0aW9uKGEsYixkKXtmdW5jdGlvbiBmKGope3JldHVybiBlLnN0ZXAoail9dGhpcy5zdGFydFRpbWU9SigpO3RoaXMuc3RhcnQ9YTt0aGlzLmVuZD1iO3RoaXMudW5pdD1kfHx0aGlzLnVuaXR8fCJweCI7dGhpcy5ub3c9dGhpcy5zdGFydDsNCnRoaXMucG9zPXRoaXMuc3RhdGU9MDt2YXIgZT10aGlzO2YuZWxlbT10aGlzLmVsZW07aWYoZigpJiZjLnRpbWVycy5wdXNoKGYpJiYhVylXPXNldEludGVydmFsKGMuZngudGljaywxMyl9LHNob3c6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMub3JpZ1t0aGlzLnByb3BdPWMuc3R5bGUodGhpcy5lbGVtLHRoaXMucHJvcCk7dGhpcy5vcHRpb25zLnNob3c9dHJ1ZTt0aGlzLmN1c3RvbSh0aGlzLnByb3A9PT0id2lkdGgifHx0aGlzLnByb3A9PT0iaGVpZ2h0Ij8xOjAsdGhpcy5jdXIoKSk7Yyh0aGlzLmVsZW0pLnNob3coKX0saGlkZTpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5vcmlnW3RoaXMucHJvcF09Yy5zdHlsZSh0aGlzLmVsZW0sdGhpcy5wcm9wKTt0aGlzLm9wdGlvbnMuaGlkZT10cnVlO3RoaXMuY3VzdG9tKHRoaXMuY3VyKCksMCl9LHN0ZXA6ZnVuY3Rpb24oYSl7dmFyIGI9SigpLGQ9dHJ1ZTtpZihhfHxiPj10aGlzLm9wdGlvbnMuZHVyYXRpb24rdGhpcy5zdGFydFRpbWUpe3RoaXMubm93PQ0KdGhpcy5lbmQ7dGhpcy5wb3M9dGhpcy5zdGF0ZT0xO3RoaXMudXBkYXRlKCk7dGhpcy5vcHRpb25zLmN1ckFuaW1bdGhpcy5wcm9wXT10cnVlO2Zvcih2YXIgZiBpbiB0aGlzLm9wdGlvbnMuY3VyQW5pbSlpZih0aGlzLm9wdGlvbnMuY3VyQW5pbVtmXSE9PXRydWUpZD1mYWxzZTtpZihkKXtpZih0aGlzLm9wdGlvbnMuZGlzcGxheSE9bnVsbCl7dGhpcy5lbGVtLnN0eWxlLm92ZXJmbG93PXRoaXMub3B0aW9ucy5vdmVyZmxvdzthPWMuZGF0YSh0aGlzLmVsZW0sIm9sZGRpc3BsYXkiKTt0aGlzLmVsZW0uc3R5bGUuZGlzcGxheT1hP2E6dGhpcy5vcHRpb25zLmRpc3BsYXk7aWYoYy5jc3ModGhpcy5lbGVtLCJkaXNwbGF5Iik9PT0ibm9uZSIpdGhpcy5lbGVtLnN0eWxlLmRpc3BsYXk9ImJsb2NrIn10aGlzLm9wdGlvbnMuaGlkZSYmYyh0aGlzLmVsZW0pLmhpZGUoKTtpZih0aGlzLm9wdGlvbnMuaGlkZXx8dGhpcy5vcHRpb25zLnNob3cpZm9yKHZhciBlIGluIHRoaXMub3B0aW9ucy5jdXJBbmltKWMuc3R5bGUodGhpcy5lbGVtLA0KZSx0aGlzLm9wdGlvbnMub3JpZ1tlXSk7dGhpcy5vcHRpb25zLmNvbXBsZXRlLmNhbGwodGhpcy5lbGVtKX1yZXR1cm4gZmFsc2V9ZWxzZXtlPWItdGhpcy5zdGFydFRpbWU7dGhpcy5zdGF0ZT1lL3RoaXMub3B0aW9ucy5kdXJhdGlvbjthPXRoaXMub3B0aW9ucy5lYXNpbmd8fChjLmVhc2luZy5zd2luZz8ic3dpbmciOiJsaW5lYXIiKTt0aGlzLnBvcz1jLmVhc2luZ1t0aGlzLm9wdGlvbnMuc3BlY2lhbEVhc2luZyYmdGhpcy5vcHRpb25zLnNwZWNpYWxFYXNpbmdbdGhpcy5wcm9wXXx8YV0odGhpcy5zdGF0ZSxlLDAsMSx0aGlzLm9wdGlvbnMuZHVyYXRpb24pO3RoaXMubm93PXRoaXMuc3RhcnQrKHRoaXMuZW5kLXRoaXMuc3RhcnQpKnRoaXMucG9zO3RoaXMudXBkYXRlKCl9cmV0dXJuIHRydWV9fTtjLmV4dGVuZChjLmZ4LHt0aWNrOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPWMudGltZXJzLGI9MDtiPGEubGVuZ3RoO2IrKylhW2JdKCl8fGEuc3BsaWNlKGItLSwxKTthLmxlbmd0aHx8DQpjLmZ4LnN0b3AoKX0sc3RvcDpmdW5jdGlvbigpe2NsZWFySW50ZXJ2YWwoVyk7Vz1udWxsfSxzcGVlZHM6e3Nsb3c6NjAwLGZhc3Q6MjAwLF9kZWZhdWx0OjQwMH0sc3RlcDp7b3BhY2l0eTpmdW5jdGlvbihhKXtjLnN0eWxlKGEuZWxlbSwib3BhY2l0eSIsYS5ub3cpfSxfZGVmYXVsdDpmdW5jdGlvbihhKXtpZihhLmVsZW0uc3R5bGUmJmEuZWxlbS5zdHlsZVthLnByb3BdIT1udWxsKWEuZWxlbS5zdHlsZVthLnByb3BdPShhLnByb3A9PT0id2lkdGgifHxhLnByb3A9PT0iaGVpZ2h0Ij9NYXRoLm1heCgwLGEubm93KTphLm5vdykrYS51bml0O2Vsc2UgYS5lbGVtW2EucHJvcF09YS5ub3d9fX0pO2lmKGMuZXhwciYmYy5leHByLmZpbHRlcnMpYy5leHByLmZpbHRlcnMuYW5pbWF0ZWQ9ZnVuY3Rpb24oYSl7cmV0dXJuIGMuZ3JlcChjLnRpbWVycyxmdW5jdGlvbihiKXtyZXR1cm4gYT09PWIuZWxlbX0pLmxlbmd0aH07Yy5mbi5vZmZzZXQ9ImdldEJvdW5kaW5nQ2xpZW50UmVjdCJpbiBzLmRvY3VtZW50RWxlbWVudD8NCmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXNbMF07aWYoYSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGUpe2Mub2Zmc2V0LnNldE9mZnNldCh0aGlzLGEsZSl9KTtpZighYnx8IWIub3duZXJEb2N1bWVudClyZXR1cm4gbnVsbDtpZihiPT09Yi5vd25lckRvY3VtZW50LmJvZHkpcmV0dXJuIGMub2Zmc2V0LmJvZHlPZmZzZXQoYik7dmFyIGQ9Yi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxmPWIub3duZXJEb2N1bWVudDtiPWYuYm9keTtmPWYuZG9jdW1lbnRFbGVtZW50O3JldHVybnt0b3A6ZC50b3ArKHNlbGYucGFnZVlPZmZzZXR8fGMuc3VwcG9ydC5ib3hNb2RlbCYmZi5zY3JvbGxUb3B8fGIuc2Nyb2xsVG9wKS0oZi5jbGllbnRUb3B8fGIuY2xpZW50VG9wfHwwKSxsZWZ0OmQubGVmdCsoc2VsZi5wYWdlWE9mZnNldHx8Yy5zdXBwb3J0LmJveE1vZGVsJiZmLnNjcm9sbExlZnR8fGIuc2Nyb2xsTGVmdCktKGYuY2xpZW50TGVmdHx8Yi5jbGllbnRMZWZ0fHwwKX19OmZ1bmN0aW9uKGEpe3ZhciBiPQ0KdGhpc1swXTtpZihhKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24ocil7Yy5vZmZzZXQuc2V0T2Zmc2V0KHRoaXMsYSxyKX0pO2lmKCFifHwhYi5vd25lckRvY3VtZW50KXJldHVybiBudWxsO2lmKGI9PT1iLm93bmVyRG9jdW1lbnQuYm9keSlyZXR1cm4gYy5vZmZzZXQuYm9keU9mZnNldChiKTtjLm9mZnNldC5pbml0aWFsaXplKCk7dmFyIGQ9Yi5vZmZzZXRQYXJlbnQsZj1iLGU9Yi5vd25lckRvY3VtZW50LGosaT1lLmRvY3VtZW50RWxlbWVudCxvPWUuYm9keTtmPShlPWUuZGVmYXVsdFZpZXcpP2UuZ2V0Q29tcHV0ZWRTdHlsZShiLG51bGwpOmIuY3VycmVudFN0eWxlO2Zvcih2YXIgaz1iLm9mZnNldFRvcCxuPWIub2Zmc2V0TGVmdDsoYj1iLnBhcmVudE5vZGUpJiZiIT09byYmYiE9PWk7KXtpZihjLm9mZnNldC5zdXBwb3J0c0ZpeGVkUG9zaXRpb24mJmYucG9zaXRpb249PT0iZml4ZWQiKWJyZWFrO2o9ZT9lLmdldENvbXB1dGVkU3R5bGUoYixudWxsKTpiLmN1cnJlbnRTdHlsZTsNCmstPWIuc2Nyb2xsVG9wO24tPWIuc2Nyb2xsTGVmdDtpZihiPT09ZCl7ays9Yi5vZmZzZXRUb3A7bis9Yi5vZmZzZXRMZWZ0O2lmKGMub2Zmc2V0LmRvZXNOb3RBZGRCb3JkZXImJiEoYy5vZmZzZXQuZG9lc0FkZEJvcmRlckZvclRhYmxlQW5kQ2VsbHMmJi9edChhYmxlfGR8aCkkL2kudGVzdChiLm5vZGVOYW1lKSkpe2srPXBhcnNlRmxvYXQoai5ib3JkZXJUb3BXaWR0aCl8fDA7bis9cGFyc2VGbG9hdChqLmJvcmRlckxlZnRXaWR0aCl8fDB9Zj1kO2Q9Yi5vZmZzZXRQYXJlbnR9aWYoYy5vZmZzZXQuc3VidHJhY3RzQm9yZGVyRm9yT3ZlcmZsb3dOb3RWaXNpYmxlJiZqLm92ZXJmbG93IT09InZpc2libGUiKXtrKz1wYXJzZUZsb2F0KGouYm9yZGVyVG9wV2lkdGgpfHwwO24rPXBhcnNlRmxvYXQoai5ib3JkZXJMZWZ0V2lkdGgpfHwwfWY9an1pZihmLnBvc2l0aW9uPT09InJlbGF0aXZlInx8Zi5wb3NpdGlvbj09PSJzdGF0aWMiKXtrKz1vLm9mZnNldFRvcDtuKz1vLm9mZnNldExlZnR9aWYoYy5vZmZzZXQuc3VwcG9ydHNGaXhlZFBvc2l0aW9uJiYNCmYucG9zaXRpb249PT0iZml4ZWQiKXtrKz1NYXRoLm1heChpLnNjcm9sbFRvcCxvLnNjcm9sbFRvcCk7bis9TWF0aC5tYXgoaS5zY3JvbGxMZWZ0LG8uc2Nyb2xsTGVmdCl9cmV0dXJue3RvcDprLGxlZnQ6bn19O2Mub2Zmc2V0PXtpbml0aWFsaXplOmZ1bmN0aW9uKCl7dmFyIGE9cy5ib2R5LGI9cy5jcmVhdGVFbGVtZW50KCJkaXYiKSxkLGYsZSxqPXBhcnNlRmxvYXQoYy5jdXJDU1MoYSwibWFyZ2luVG9wIix0cnVlKSl8fDA7Yy5leHRlbmQoYi5zdHlsZSx7cG9zaXRpb246ImFic29sdXRlIix0b3A6MCxsZWZ0OjAsbWFyZ2luOjAsYm9yZGVyOjAsd2lkdGg6IjFweCIsaGVpZ2h0OiIxcHgiLHZpc2liaWxpdHk6ImhpZGRlbiJ9KTtiLmlubmVySFRNTD0iPGRpdiBzdHlsZT0ncG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO21hcmdpbjowO2JvcmRlcjo1cHggc29saWQgIzAwMDtwYWRkaW5nOjA7d2lkdGg6MXB4O2hlaWdodDoxcHg7Jz48ZGl2PjwvZGl2PjwvZGl2Pjx0YWJsZSBzdHlsZT0ncG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO21hcmdpbjowO2JvcmRlcjo1cHggc29saWQgIzAwMDtwYWRkaW5nOjA7d2lkdGg6MXB4O2hlaWdodDoxcHg7JyBjZWxscGFkZGluZz0nMCcgY2VsbHNwYWNpbmc9JzAnPjx0cj48dGQ+PC90ZD48L3RyPjwvdGFibGU+IjsNCmEuaW5zZXJ0QmVmb3JlKGIsYS5maXJzdENoaWxkKTtkPWIuZmlyc3RDaGlsZDtmPWQuZmlyc3RDaGlsZDtlPWQubmV4dFNpYmxpbmcuZmlyc3RDaGlsZC5maXJzdENoaWxkO3RoaXMuZG9lc05vdEFkZEJvcmRlcj1mLm9mZnNldFRvcCE9PTU7dGhpcy5kb2VzQWRkQm9yZGVyRm9yVGFibGVBbmRDZWxscz1lLm9mZnNldFRvcD09PTU7Zi5zdHlsZS5wb3NpdGlvbj0iZml4ZWQiO2Yuc3R5bGUudG9wPSIyMHB4Ijt0aGlzLnN1cHBvcnRzRml4ZWRQb3NpdGlvbj1mLm9mZnNldFRvcD09PTIwfHxmLm9mZnNldFRvcD09PTE1O2Yuc3R5bGUucG9zaXRpb249Zi5zdHlsZS50b3A9IiI7ZC5zdHlsZS5vdmVyZmxvdz0iaGlkZGVuIjtkLnN0eWxlLnBvc2l0aW9uPSJyZWxhdGl2ZSI7dGhpcy5zdWJ0cmFjdHNCb3JkZXJGb3JPdmVyZmxvd05vdFZpc2libGU9Zi5vZmZzZXRUb3A9PT0tNTt0aGlzLmRvZXNOb3RJbmNsdWRlTWFyZ2luSW5Cb2R5T2Zmc2V0PWEub2Zmc2V0VG9wIT09ajthLnJlbW92ZUNoaWxkKGIpOw0KYy5vZmZzZXQuaW5pdGlhbGl6ZT1jLm5vb3B9LGJvZHlPZmZzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9YS5vZmZzZXRUb3AsZD1hLm9mZnNldExlZnQ7Yy5vZmZzZXQuaW5pdGlhbGl6ZSgpO2lmKGMub2Zmc2V0LmRvZXNOb3RJbmNsdWRlTWFyZ2luSW5Cb2R5T2Zmc2V0KXtiKz1wYXJzZUZsb2F0KGMuY3VyQ1NTKGEsIm1hcmdpblRvcCIsdHJ1ZSkpfHwwO2QrPXBhcnNlRmxvYXQoYy5jdXJDU1MoYSwibWFyZ2luTGVmdCIsdHJ1ZSkpfHwwfXJldHVybnt0b3A6YixsZWZ0OmR9fSxzZXRPZmZzZXQ6ZnVuY3Rpb24oYSxiLGQpe2lmKC9zdGF0aWMvLnRlc3QoYy5jdXJDU1MoYSwicG9zaXRpb24iKSkpYS5zdHlsZS5wb3NpdGlvbj0icmVsYXRpdmUiO3ZhciBmPWMoYSksZT1mLm9mZnNldCgpLGo9cGFyc2VJbnQoYy5jdXJDU1MoYSwidG9wIix0cnVlKSwxMCl8fDAsaT1wYXJzZUludChjLmN1ckNTUyhhLCJsZWZ0Iix0cnVlKSwxMCl8fDA7aWYoYy5pc0Z1bmN0aW9uKGIpKWI9Yi5jYWxsKGEsDQpkLGUpO2Q9e3RvcDpiLnRvcC1lLnRvcCtqLGxlZnQ6Yi5sZWZ0LWUubGVmdCtpfTsidXNpbmciaW4gYj9iLnVzaW5nLmNhbGwoYSxkKTpmLmNzcyhkKX19O2MuZm4uZXh0ZW5kKHtwb3NpdGlvbjpmdW5jdGlvbigpe2lmKCF0aGlzWzBdKXJldHVybiBudWxsO3ZhciBhPXRoaXNbMF0sYj10aGlzLm9mZnNldFBhcmVudCgpLGQ9dGhpcy5vZmZzZXQoKSxmPS9eYm9keXxodG1sJC9pLnRlc3QoYlswXS5ub2RlTmFtZSk/e3RvcDowLGxlZnQ6MH06Yi5vZmZzZXQoKTtkLnRvcC09cGFyc2VGbG9hdChjLmN1ckNTUyhhLCJtYXJnaW5Ub3AiLHRydWUpKXx8MDtkLmxlZnQtPXBhcnNlRmxvYXQoYy5jdXJDU1MoYSwibWFyZ2luTGVmdCIsdHJ1ZSkpfHwwO2YudG9wKz1wYXJzZUZsb2F0KGMuY3VyQ1NTKGJbMF0sImJvcmRlclRvcFdpZHRoIix0cnVlKSl8fDA7Zi5sZWZ0Kz1wYXJzZUZsb2F0KGMuY3VyQ1NTKGJbMF0sImJvcmRlckxlZnRXaWR0aCIsdHJ1ZSkpfHwwO3JldHVybnt0b3A6ZC50b3AtDQpmLnRvcCxsZWZ0OmQubGVmdC1mLmxlZnR9fSxvZmZzZXRQYXJlbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5vZmZzZXRQYXJlbnR8fHMuYm9keTthJiYhL15ib2R5fGh0bWwkL2kudGVzdChhLm5vZGVOYW1lKSYmYy5jc3MoYSwicG9zaXRpb24iKT09PSJzdGF0aWMiOylhPWEub2Zmc2V0UGFyZW50O3JldHVybiBhfSl9fSk7Yy5lYWNoKFsiTGVmdCIsIlRvcCJdLGZ1bmN0aW9uKGEsYil7dmFyIGQ9InNjcm9sbCIrYjtjLmZuW2RdPWZ1bmN0aW9uKGYpe3ZhciBlPXRoaXNbMF0sajtpZighZSlyZXR1cm4gbnVsbDtpZihmIT09dylyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7aWYoaj13YSh0aGlzKSlqLnNjcm9sbFRvKCFhP2Y6YyhqKS5zY3JvbGxMZWZ0KCksYT9mOmMoaikuc2Nyb2xsVG9wKCkpO2Vsc2UgdGhpc1tkXT1mfSk7ZWxzZSByZXR1cm4oaj13YShlKSk/InBhZ2VYT2Zmc2V0ImluIGo/althPyJwYWdlWU9mZnNldCI6DQoicGFnZVhPZmZzZXQiXTpjLnN1cHBvcnQuYm94TW9kZWwmJmouZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50W2RdfHxqLmRvY3VtZW50LmJvZHlbZF06ZVtkXX19KTtjLmVhY2goWyJIZWlnaHQiLCJXaWR0aCJdLGZ1bmN0aW9uKGEsYil7dmFyIGQ9Yi50b0xvd2VyQ2FzZSgpO2MuZm5bImlubmVyIitiXT1mdW5jdGlvbigpe3JldHVybiB0aGlzWzBdP2MuY3NzKHRoaXNbMF0sZCxmYWxzZSwicGFkZGluZyIpOm51bGx9O2MuZm5bIm91dGVyIitiXT1mdW5jdGlvbihmKXtyZXR1cm4gdGhpc1swXT9jLmNzcyh0aGlzWzBdLGQsZmFsc2UsZj8ibWFyZ2luIjoiYm9yZGVyIik6bnVsbH07Yy5mbltkXT1mdW5jdGlvbihmKXt2YXIgZT10aGlzWzBdO2lmKCFlKXJldHVybiBmPT1udWxsP251bGw6dGhpcztpZihjLmlzRnVuY3Rpb24oZikpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihqKXt2YXIgaT1jKHRoaXMpO2lbZF0oZi5jYWxsKHRoaXMsaixpW2RdKCkpKX0pO3JldHVybiJzY3JvbGxUbyJpbg0KZSYmZS5kb2N1bWVudD9lLmRvY3VtZW50LmNvbXBhdE1vZGU9PT0iQ1NTMUNvbXBhdCImJmUuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyJjbGllbnQiK2JdfHxlLmRvY3VtZW50LmJvZHlbImNsaWVudCIrYl06ZS5ub2RlVHlwZT09PTk/TWF0aC5tYXgoZS5kb2N1bWVudEVsZW1lbnRbImNsaWVudCIrYl0sZS5ib2R5WyJzY3JvbGwiK2JdLGUuZG9jdW1lbnRFbGVtZW50WyJzY3JvbGwiK2JdLGUuYm9keVsib2Zmc2V0IitiXSxlLmRvY3VtZW50RWxlbWVudFsib2Zmc2V0IitiXSk6Zj09PXc/Yy5jc3MoZSxkKTp0aGlzLmNzcyhkLHR5cGVvZiBmPT09InN0cmluZyI/ZjpmKyJweCIpfX0pO0EualF1ZXJ5PUEuJD1jfSkod2luZG93KTsNCg==" );
			// jQuery Context Menu Plugin - http://abeautifulsite.net/blog/2008/09/jquery-context-menu-plugin/
			echo base64_decode( "Ly8galF1ZXJ5IENvbnRleHQgTWVudSBQbHVnaW4NCi8vDQovLyBWZXJzaW9uIDEuMDENCi8vDQovLyBDb3J5IFMuTi4gTGFWaXNrYQ0KLy8gQSBCZWF1dGlmdWwgU2l0ZSAoaHR0cDovL2FiZWF1dGlmdWxzaXRlLm5ldC8pDQovLw0KLy8gTW9yZSBpbmZvOiBodHRwOi8vYWJlYXV0aWZ1bHNpdGUubmV0LzIwMDgvMDkvanF1ZXJ5LWNvbnRleHQtbWVudS1wbHVnaW4vDQovLw0KLy8gVGVybXMgb2YgVXNlDQovLw0KLy8gVGhpcyBwbHVnaW4gaXMgZHVhbC1saWNlbnNlZCB1bmRlciB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UNCi8vICAgYW5kIHRoZSBNSVQgTGljZW5zZSBhbmQgaXMgY29weXJpZ2h0IEEgQmVhdXRpZnVsIFNpdGUsIExMQy4NCi8vDQppZihqUXVlcnkpKCBmdW5jdGlvbigpIHsNCgkkLmV4dGVuZCgkLmZuLCB7DQoJCQ0KCQljb250ZXh0TWVudTogZnVuY3Rpb24obywgY2FsbGJhY2spIHsNCgkJCS8vIERlZmF1bHRzDQoJCQlpZiggby5tZW51ID09IHVuZGVmaW5lZCApIHJldHVybiBmYWxzZTsNCgkJCWlmKCBvLmluU3BlZWQgPT0gdW5kZWZpbmVkICkgby5pblNwZWVkID0gMTUwOw0KCQkJaWYoIG8ub3V0U3BlZWQgPT0gdW5kZWZpbmVkICkgby5vdXRTcGVlZCA9IDc1Ow0KCQkJLy8gMCBuZWVkcyB0byBiZSAtMSBmb3IgZXhwZWN0ZWQgcmVzdWx0cyAobm8gZmFkZSkNCgkJCWlmKCBvLmluU3BlZWQgPT0gMCApIG8uaW5TcGVlZCA9IC0xOw0KCQkJaWYoIG8ub3V0U3BlZWQgPT0gMCApIG8ub3V0U3BlZWQgPSAtMTsNCgkJCS8vIExvb3AgZWFjaCBjb250ZXh0IG1lbnUNCgkJCSQodGhpcykuZWFjaCggZnVuY3Rpb24oKSB7DQoJCQkJdmFyIGVsID0gJCh0aGlzKTsNCgkJCQl2YXIgb2Zmc2V0ID0gJChlbCkub2Zmc2V0KCk7DQoJCQkJLy8gQWRkIGNvbnRleHRNZW51IGNsYXNzDQoJCQkJJCgnIycgKyBvLm1lbnUpLmFkZENsYXNzKCdjb250ZXh0TWVudScpOw0KCQkJCS8vIFNpbXVsYXRlIGEgdHJ1ZSByaWdodCBjbGljaw0KCQkJCSQodGhpcykubW91c2Vkb3duKCBmdW5jdGlvbihlKSB7DQoJCQkJCXZhciBldnQgPSBlOw0KCQkJCQlldnQuc3RvcFByb3BhZ2F0aW9uKCk7DQoJCQkJCSQodGhpcykubW91c2V1cCggZnVuY3Rpb24oZSkgew0KCQkJCQkJZS5zdG9wUHJvcGFnYXRpb24oKTsNCgkJCQkJCXZhciBzcmNFbGVtZW50ID0gJCh0aGlzKTsNCgkJCQkJCSQodGhpcykudW5iaW5kKCdtb3VzZXVwJyk7DQoJCQkJCQlpZiggZXZ0LmJ1dHRvbiA9PSAyICkgew0KCQkJCQkJCS8vIEhpZGUgY29udGV4dCBtZW51cyB0aGF0IG1heSBiZSBzaG93aW5nDQoJCQkJCQkJJCgiLmNvbnRleHRNZW51IikuaGlkZSgpOw0KCQkJCQkJCS8vIEdldCB0aGlzIGNvbnRleHQgbWVudQ0KCQkJCQkJCXZhciBtZW51ID0gJCgnIycgKyBvLm1lbnUpOw0KCQkJCQkJCQ0KCQkJCQkJCWlmKCAkKGVsKS5oYXNDbGFzcygnZGlzYWJsZWQnKSApIHJldHVybiBmYWxzZTsNCgkJCQkJCQkNCgkJCQkJCQkvLyBEZXRlY3QgbW91c2UgcG9zaXRpb24NCgkJCQkJCQl2YXIgZCA9IHt9LCB4LCB5Ow0KCQkJCQkJCWlmKCBzZWxmLmlubmVySGVpZ2h0ICkgew0KCQkJCQkJCQlkLnBhZ2VZT2Zmc2V0ID0gc2VsZi5wYWdlWU9mZnNldDsNCgkJCQkJCQkJZC5wYWdlWE9mZnNldCA9IHNlbGYucGFnZVhPZmZzZXQ7DQoJCQkJCQkJCWQuaW5uZXJIZWlnaHQgPSBzZWxmLmlubmVySGVpZ2h0Ow0KCQkJCQkJCQlkLmlubmVyV2lkdGggPSBzZWxmLmlubmVyV2lkdGg7DQoJCQkJCQkJfSBlbHNlIGlmKCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgJiYNCgkJCQkJCQkJZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCApIHsNCgkJCQkJCQkJZC5wYWdlWU9mZnNldCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7DQoJCQkJCQkJCWQucGFnZVhPZmZzZXQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdDsNCgkJCQkJCQkJZC5pbm5lckhlaWdodCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7DQoJCQkJCQkJCWQuaW5uZXJXaWR0aCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDsNCgkJCQkJCQl9IGVsc2UgaWYoIGRvY3VtZW50LmJvZHkgKSB7DQoJCQkJCQkJCWQucGFnZVlPZmZzZXQgPSBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcDsNCgkJCQkJCQkJZC5wYWdlWE9mZnNldCA9IGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdDsNCgkJCQkJCQkJZC5pbm5lckhlaWdodCA9IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0Ow0KCQkJCQkJCQlkLmlubmVyV2lkdGggPSBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoOw0KCQkJCQkJCX0NCgkJCQkJCQkoZS5wYWdlWCkgPyB4ID0gZS5wYWdlWCA6IHggPSBlLmNsaWVudFggKyBkLnNjcm9sbExlZnQ7DQoJCQkJCQkJKGUucGFnZVkpID8geSA9IGUucGFnZVkgOiB5ID0gZS5jbGllbnRZICsgZC5zY3JvbGxUb3A7DQoJCQkJCQkJDQoJCQkJCQkJLy8gU2hvdyB0aGUgbWVudQ0KCQkJCQkJCSQoZG9jdW1lbnQpLnVuYmluZCgnY2xpY2snKTsNCgkJCQkJCQkkKG1lbnUpLmNzcyh7IHRvcDogeSwgbGVmdDogeCB9KS5mYWRlSW4oby5pblNwZWVkKTsNCgkJCQkJCQkvLyBIb3ZlciBldmVudHMNCgkJCQkJCQkkKG1lbnUpLmZpbmQoJ0EnKS5tb3VzZW92ZXIoIGZ1bmN0aW9uKCkgew0KCQkJCQkJCQkkKG1lbnUpLmZpbmQoJ0xJLmhvdmVyJykucmVtb3ZlQ2xhc3MoJ2hvdmVyJyk7DQoJCQkJCQkJCSQodGhpcykucGFyZW50KCkuYWRkQ2xhc3MoJ2hvdmVyJyk7DQoJCQkJCQkJfSkubW91c2VvdXQoIGZ1bmN0aW9uKCkgew0KCQkJCQkJCQkkKG1lbnUpLmZpbmQoJ0xJLmhvdmVyJykucmVtb3ZlQ2xhc3MoJ2hvdmVyJyk7DQoJCQkJCQkJfSk7DQoJCQkJCQkJDQoJCQkJCQkJLy8gS2V5Ym9hcmQNCgkJCQkJCQkkKGRvY3VtZW50KS5rZXlwcmVzcyggZnVuY3Rpb24oZSkgew0KCQkJCQkJCQlzd2l0Y2goIGUua2V5Q29kZSApIHsNCgkJCQkJCQkJCWNhc2UgMzg6IC8vIHVwDQoJCQkJCQkJCQkJaWYoICQobWVudSkuZmluZCgnTEkuaG92ZXInKS5zaXplKCkgPT0gMCApIHsNCgkJCQkJCQkJCQkJJChtZW51KS5maW5kKCdMSTpsYXN0JykuYWRkQ2xhc3MoJ2hvdmVyJyk7DQoJCQkJCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQkJCQkJJChtZW51KS5maW5kKCdMSS5ob3ZlcicpLnJlbW92ZUNsYXNzKCdob3ZlcicpLnByZXZBbGwoJ0xJOm5vdCguZGlzYWJsZWQpJykuZXEoMCkuYWRkQ2xhc3MoJ2hvdmVyJyk7DQoJCQkJCQkJCQkJCWlmKCAkKG1lbnUpLmZpbmQoJ0xJLmhvdmVyJykuc2l6ZSgpID09IDAgKSAkKG1lbnUpLmZpbmQoJ0xJOmxhc3QnKS5hZGRDbGFzcygnaG92ZXInKTsNCgkJCQkJCQkJCQl9DQoJCQkJCQkJCQlicmVhazsNCgkJCQkJCQkJCWNhc2UgNDA6IC8vIGRvd24NCgkJCQkJCQkJCQlpZiggJChtZW51KS5maW5kKCdMSS5ob3ZlcicpLnNpemUoKSA9PSAwICkgew0KCQkJCQkJCQkJCQkkKG1lbnUpLmZpbmQoJ0xJOmZpcnN0JykuYWRkQ2xhc3MoJ2hvdmVyJyk7DQoJCQkJCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQkJCQkJJChtZW51KS5maW5kKCdMSS5ob3ZlcicpLnJlbW92ZUNsYXNzKCdob3ZlcicpLm5leHRBbGwoJ0xJOm5vdCguZGlzYWJsZWQpJykuZXEoMCkuYWRkQ2xhc3MoJ2hvdmVyJyk7DQoJCQkJCQkJCQkJCWlmKCAkKG1lbnUpLmZpbmQoJ0xJLmhvdmVyJykuc2l6ZSgpID09IDAgKSAkKG1lbnUpLmZpbmQoJ0xJOmZpcnN0JykuYWRkQ2xhc3MoJ2hvdmVyJyk7DQoJCQkJCQkJCQkJfQ0KCQkJCQkJCQkJYnJlYWs7DQoJCQkJCQkJCQljYXNlIDEzOiAvLyBlbnRlcg0KCQkJCQkJCQkJCSQobWVudSkuZmluZCgnTEkuaG92ZXIgQScpLnRyaWdnZXIoJ2NsaWNrJyk7DQoJCQkJCQkJCQlicmVhazsNCgkJCQkJCQkJCWNhc2UgMjc6IC8vIGVzYw0KCQkJCQkJCQkJCSQoZG9jdW1lbnQpLnRyaWdnZXIoJ2NsaWNrJyk7DQoJCQkJCQkJCQlicmVhaw0KCQkJCQkJCQl9DQoJCQkJCQkJfSk7DQoJCQkJCQkJDQoJCQkJCQkJLy8gV2hlbiBpdGVtcyBhcmUgc2VsZWN0ZWQNCgkJCQkJCQkkKCcjJyArIG8ubWVudSkuZmluZCgnQScpLnVuYmluZCgnY2xpY2snKTsNCgkJCQkJCQkkKCcjJyArIG8ubWVudSkuZmluZCgnTEk6bm90KC5kaXNhYmxlZCkgQScpLmNsaWNrKCBmdW5jdGlvbigpIHsNCgkJCQkJCQkJJChkb2N1bWVudCkudW5iaW5kKCdjbGljaycpLnVuYmluZCgna2V5cHJlc3MnKTsNCgkJCQkJCQkJJCgiLmNvbnRleHRNZW51IikuaGlkZSgpOw0KCQkJCQkJCQkvLyBDYWxsYmFjaw0KCQkJCQkJCQlpZiggY2FsbGJhY2sgKSBjYWxsYmFjayggJCh0aGlzKS5hdHRyKCdocmVmJykuc3Vic3RyKDEpLCAkKHNyY0VsZW1lbnQpLCB7eDogeCAtIG9mZnNldC5sZWZ0LCB5OiB5IC0gb2Zmc2V0LnRvcCwgZG9jWDogeCwgZG9jWTogeX0gKTsNCgkJCQkJCQkJcmV0dXJuIGZhbHNlOw0KCQkJCQkJCX0pOw0KCQkJCQkJCQ0KCQkJCQkJCS8vIEhpZGUgYmluZGluZ3MNCgkJCQkJCQlzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHsgLy8gRGVsYXkgZm9yIE1vemlsbGENCgkJCQkJCQkJJChkb2N1bWVudCkuY2xpY2soIGZ1bmN0aW9uKCkgew0KCQkJCQkJCQkJJChkb2N1bWVudCkudW5iaW5kKCdjbGljaycpLnVuYmluZCgna2V5cHJlc3MnKTsNCgkJCQkJCQkJCSQobWVudSkuZmFkZU91dChvLm91dFNwZWVkKTsNCgkJCQkJCQkJCXJldHVybiBmYWxzZTsNCgkJCQkJCQkJfSk7DQoJCQkJCQkJfSwgMCk7DQoJCQkJCQl9DQoJCQkJCX0pOw0KCQkJCX0pOw0KCQkJCQ0KCQkJCS8vIERpc2FibGUgdGV4dCBzZWxlY3Rpb24NCgkJCQlpZiggJC5icm93c2VyLm1vemlsbGEgKSB7DQoJCQkJCSQoJyMnICsgby5tZW51KS5lYWNoKCBmdW5jdGlvbigpIHsgJCh0aGlzKS5jc3MoeyAnTW96VXNlclNlbGVjdCcgOiAnbm9uZScgfSk7IH0pOw0KCQkJCX0gZWxzZSBpZiggJC5icm93c2VyLm1zaWUgKSB7DQoJCQkJCSQoJyMnICsgby5tZW51KS5lYWNoKCBmdW5jdGlvbigpIHsgJCh0aGlzKS5iaW5kKCdzZWxlY3RzdGFydC5kaXNhYmxlVGV4dFNlbGVjdCcsIGZ1bmN0aW9uKCkgeyByZXR1cm4gZmFsc2U7IH0pOyB9KTsNCgkJCQl9IGVsc2Ugew0KCQkJCQkkKCcjJyArIG8ubWVudSkuZWFjaChmdW5jdGlvbigpIHsgJCh0aGlzKS5iaW5kKCdtb3VzZWRvd24uZGlzYWJsZVRleHRTZWxlY3QnLCBmdW5jdGlvbigpIHsgcmV0dXJuIGZhbHNlOyB9KTsgfSk7DQoJCQkJfQ0KCQkJCS8vIERpc2FibGUgYnJvd3NlciBjb250ZXh0IG1lbnUgKHJlcXVpcmVzIGJvdGggc2VsZWN0b3JzIHRvIHdvcmsgaW4gSUUvU2FmYXJpICsgRkYvQ2hyb21lKQ0KCQkJCSQoZWwpLmFkZCgkKCdVTC5jb250ZXh0TWVudScpKS5iaW5kKCdjb250ZXh0bWVudScsIGZ1bmN0aW9uKCkgeyByZXR1cm4gZmFsc2U7IH0pOw0KCQkJCQ0KCQkJfSk7DQoJCQlyZXR1cm4gJCh0aGlzKTsNCgkJfSwNCgkJDQoJCS8vIERpc2FibGUgY29udGV4dCBtZW51IGl0ZW1zIG9uIHRoZSBmbHkNCgkJZGlzYWJsZUNvbnRleHRNZW51SXRlbXM6IGZ1bmN0aW9uKG8pIHsNCgkJCWlmKCBvID09IHVuZGVmaW5lZCApIHsNCgkJCQkvLyBEaXNhYmxlIGFsbA0KCQkJCSQodGhpcykuZmluZCgnTEknKS5hZGRDbGFzcygnZGlzYWJsZWQnKTsNCgkJCQlyZXR1cm4oICQodGhpcykgKTsNCgkJCX0NCgkJCSQodGhpcykuZWFjaCggZnVuY3Rpb24oKSB7DQoJCQkJaWYoIG8gIT0gdW5kZWZpbmVkICkgew0KCQkJCQl2YXIgZCA9IG8uc3BsaXQoJywnKTsNCgkJCQkJZm9yKCB2YXIgaSA9IDA7IGkgPCBkLmxlbmd0aDsgaSsrICkgew0KCQkJCQkJJCh0aGlzKS5maW5kKCdBW2hyZWY9IicgKyBkW2ldICsgJyJdJykucGFyZW50KCkuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7DQoJCQkJCQkNCgkJCQkJfQ0KCQkJCX0NCgkJCX0pOw0KCQkJcmV0dXJuKCAkKHRoaXMpICk7DQoJCX0sDQoJCQ0KCQkvLyBFbmFibGUgY29udGV4dCBtZW51IGl0ZW1zIG9uIHRoZSBmbHkNCgkJZW5hYmxlQ29udGV4dE1lbnVJdGVtczogZnVuY3Rpb24obykgew0KCQkJaWYoIG8gPT0gdW5kZWZpbmVkICkgew0KCQkJCS8vIEVuYWJsZSBhbGwNCgkJCQkkKHRoaXMpLmZpbmQoJ0xJLmRpc2FibGVkJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7DQoJCQkJcmV0dXJuKCAkKHRoaXMpICk7DQoJCQl9DQoJCQkkKHRoaXMpLmVhY2goIGZ1bmN0aW9uKCkgew0KCQkJCWlmKCBvICE9IHVuZGVmaW5lZCApIHsNCgkJCQkJdmFyIGQgPSBvLnNwbGl0KCcsJyk7DQoJCQkJCWZvciggdmFyIGkgPSAwOyBpIDwgZC5sZW5ndGg7IGkrKyApIHsNCgkJCQkJCSQodGhpcykuZmluZCgnQVtocmVmPSInICsgZFtpXSArICciXScpLnBhcmVudCgpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpOw0KCQkJCQkJDQoJCQkJCX0NCgkJCQl9DQoJCQl9KTsNCgkJCXJldHVybiggJCh0aGlzKSApOw0KCQl9LA0KCQkNCgkJLy8gRGlzYWJsZSBjb250ZXh0IG1lbnUocykNCgkJZGlzYWJsZUNvbnRleHRNZW51OiBmdW5jdGlvbigpIHsNCgkJCSQodGhpcykuZWFjaCggZnVuY3Rpb24oKSB7DQoJCQkJJCh0aGlzKS5hZGRDbGFzcygnZGlzYWJsZWQnKTsNCgkJCX0pOw0KCQkJcmV0dXJuKCAkKHRoaXMpICk7DQoJCX0sDQoJCQ0KCQkvLyBFbmFibGUgY29udGV4dCBtZW51KHMpDQoJCWVuYWJsZUNvbnRleHRNZW51OiBmdW5jdGlvbigpIHsNCgkJCSQodGhpcykuZWFjaCggZnVuY3Rpb24oKSB7DQoJCQkJJCh0aGlzKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTsNCgkJCX0pOw0KCQkJcmV0dXJuKCAkKHRoaXMpICk7DQoJCX0sDQoJCQ0KCQkvLyBEZXN0cm95IGNvbnRleHQgbWVudShzKQ0KCQlkZXN0cm95Q29udGV4dE1lbnU6IGZ1bmN0aW9uKCkgew0KCQkJLy8gRGVzdHJveSBzcGVjaWZpZWQgY29udGV4dCBtZW51cw0KCQkJJCh0aGlzKS5lYWNoKCBmdW5jdGlvbigpIHsNCgkJCQkvLyBEaXNhYmxlIGFjdGlvbg0KCQkJCSQodGhpcykudW5iaW5kKCdtb3VzZWRvd24nKS51bmJpbmQoJ21vdXNldXAnKTsNCgkJCX0pOw0KCQkJcmV0dXJuKCAkKHRoaXMpICk7DQoJCX0NCgkJDQoJfSk7DQp9KShqUXVlcnkpOw==" );
			// jQuery Hotkeys Plugin - https://github.com/jeresig/jquery.hotkeys
			echo base64_decode( "LyoKICogalF1ZXJ5IEhvdGtleXMgUGx1Z2luCiAqIENvcHlyaWdodCAyMDEwLCBKb2huIFJlc2lnCiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBvciBHUEwgVmVyc2lvbiAyIGxpY2Vuc2VzLgogKgogKiBCYXNlZCB1cG9uIHRoZSBwbHVnaW4gYnkgVHp1cnkgQmFyIFlvY2hheToKICogaHR0cDovL2dpdGh1Yi5jb20vdHp1cnlieS9ob3RrZXlzCiAqCiAqIE9yaWdpbmFsIGlkZWEgYnk6CiAqIEJpbm55IFYgQSwgaHR0cDovL3d3dy5vcGVuanMuY29tL3NjcmlwdHMvZXZlbnRzL2tleWJvYXJkX3Nob3J0Y3V0cy8KKi8KCihmdW5jdGlvbihqUXVlcnkpewoJCglqUXVlcnkuaG90a2V5cyA9IHsKCQl2ZXJzaW9uOiAiMC44IiwKCgkJc3BlY2lhbEtleXM6IHsKCQkJODogImJhY2tzcGFjZSIsIDk6ICJ0YWIiLCAxMzogInJldHVybiIsIDE2OiAic2hpZnQiLCAxNzogImN0cmwiLCAxODogImFsdCIsIDE5OiAicGF1c2UiLAoJCQkyMDogImNhcHNsb2NrIiwgMjc6ICJlc2MiLCAzMjogInNwYWNlIiwgMzM6ICJwYWdldXAiLCAzNDogInBhZ2Vkb3duIiwgMzU6ICJlbmQiLCAzNjogImhvbWUiLAoJCQkzNzogImxlZnQiLCAzODogInVwIiwgMzk6ICJyaWdodCIsIDQwOiAiZG93biIsIDQ1OiAiaW5zZXJ0IiwgNDY6ICJkZWwiLCAKCQkJOTY6ICIwIiwgOTc6ICIxIiwgOTg6ICIyIiwgOTk6ICIzIiwgMTAwOiAiNCIsIDEwMTogIjUiLCAxMDI6ICI2IiwgMTAzOiAiNyIsCgkJCTEwNDogIjgiLCAxMDU6ICI5IiwgMTA2OiAiKiIsIDEwNzogIisiLCAxMDk6ICItIiwgMTEwOiAiLiIsIDExMSA6ICIvIiwgCgkJCTExMjogImYxIiwgMTEzOiAiZjIiLCAxMTQ6ICJmMyIsIDExNTogImY0IiwgMTE2OiAiZjUiLCAxMTc6ICJmNiIsIDExODogImY3IiwgMTE5OiAiZjgiLCAKCQkJMTIwOiAiZjkiLCAxMjE6ICJmMTAiLCAxMjI6ICJmMTEiLCAxMjM6ICJmMTIiLCAxNDQ6ICJudW1sb2NrIiwgMTQ1OiAic2Nyb2xsIiwgMTkxOiAiLyIsIDIyNDogIm1ldGEiCgkJfSwKCQoJCXNoaWZ0TnVtczogewoJCQkiYCI6ICJ+IiwgIjEiOiAiISIsICIyIjogIkAiLCAiMyI6ICIjIiwgIjQiOiAiJCIsICI1IjogIiUiLCAiNiI6ICJeIiwgIjciOiAiJiIsIAoJCQkiOCI6ICIqIiwgIjkiOiAiKCIsICIwIjogIikiLCAiLSI6ICJfIiwgIj0iOiAiKyIsICI7IjogIjogIiwgIiciOiAiXCIiLCAiLCI6ICI8IiwgCgkJCSIuIjogIj4iLCAgIi8iOiAiPyIsICAiXFwiOiAifCIKCQl9Cgl9OwoKCWZ1bmN0aW9uIGtleUhhbmRsZXIoIGhhbmRsZU9iaiApIHsKCQkvLyBPbmx5IGNhcmUgd2hlbiBhIHBvc3NpYmxlIGlucHV0IGhhcyBiZWVuIHNwZWNpZmllZAoJCWlmICggdHlwZW9mIGhhbmRsZU9iai5kYXRhICE9PSAic3RyaW5nIiApIHsKCQkJcmV0dXJuOwoJCX0KCQkKCQl2YXIgb3JpZ0hhbmRsZXIgPSBoYW5kbGVPYmouaGFuZGxlciwKCQkJa2V5cyA9IGhhbmRsZU9iai5kYXRhLnRvTG93ZXJDYXNlKCkuc3BsaXQoIiAiKTsKCQoJCWhhbmRsZU9iai5oYW5kbGVyID0gZnVuY3Rpb24oIGV2ZW50ICkgewoJCQkvLyBEb24ndCBmaXJlIGluIHRleHQtYWNjZXB0aW5nIGlucHV0cyB0aGF0IHdlIGRpZG4ndCBkaXJlY3RseSBiaW5kIHRvCgkJCWlmICggdGhpcyAhPT0gZXZlbnQudGFyZ2V0ICYmICgvdGV4dGFyZWF8c2VsZWN0L2kudGVzdCggZXZlbnQudGFyZ2V0Lm5vZGVOYW1lICkgfHwKCQkJCSBldmVudC50YXJnZXQudHlwZSA9PT0gInRleHQiKSApIHsKCQkJCXJldHVybjsKCQkJfQoJCQkKCQkJLy8gS2V5cHJlc3MgcmVwcmVzZW50cyBjaGFyYWN0ZXJzLCBub3Qgc3BlY2lhbCBrZXlzCgkJCXZhciBzcGVjaWFsID0gZXZlbnQudHlwZSAhPT0gImtleXByZXNzIiAmJiBqUXVlcnkuaG90a2V5cy5zcGVjaWFsS2V5c1sgZXZlbnQud2hpY2ggXSwKCQkJCWNoYXJhY3RlciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoIGV2ZW50LndoaWNoICkudG9Mb3dlckNhc2UoKSwKCQkJCWtleSwgbW9kaWYgPSAiIiwgcG9zc2libGUgPSB7fTsKCgkJCS8vIGNoZWNrIGNvbWJpbmF0aW9ucyAoYWx0fGN0cmx8c2hpZnQrYW55dGhpbmcpCgkJCWlmICggZXZlbnQuYWx0S2V5ICYmIHNwZWNpYWwgIT09ICJhbHQiICkgewoJCQkJbW9kaWYgKz0gImFsdCsiOwoJCQl9CgoJCQlpZiAoIGV2ZW50LmN0cmxLZXkgJiYgc3BlY2lhbCAhPT0gImN0cmwiICkgewoJCQkJbW9kaWYgKz0gImN0cmwrIjsKCQkJfQoJCQkKCQkJLy8gVE9ETzogTmVlZCB0byBtYWtlIHN1cmUgdGhpcyB3b3JrcyBjb25zaXN0ZW50bHkgYWNyb3NzIHBsYXRmb3JtcwoJCQlpZiAoIGV2ZW50Lm1ldGFLZXkgJiYgIWV2ZW50LmN0cmxLZXkgJiYgc3BlY2lhbCAhPT0gIm1ldGEiICkgewoJCQkJbW9kaWYgKz0gIm1ldGErIjsKCQkJfQoKCQkJaWYgKCBldmVudC5zaGlmdEtleSAmJiBzcGVjaWFsICE9PSAic2hpZnQiICkgewoJCQkJbW9kaWYgKz0gInNoaWZ0KyI7CgkJCX0KCgkJCWlmICggc3BlY2lhbCApIHsKCQkJCXBvc3NpYmxlWyBtb2RpZiArIHNwZWNpYWwgXSA9IHRydWU7CgoJCQl9IGVsc2UgewoJCQkJcG9zc2libGVbIG1vZGlmICsgY2hhcmFjdGVyIF0gPSB0cnVlOwoJCQkJcG9zc2libGVbIG1vZGlmICsgalF1ZXJ5LmhvdGtleXMuc2hpZnROdW1zWyBjaGFyYWN0ZXIgXSBdID0gdHJ1ZTsKCgkJCQkvLyAiJCIgY2FuIGJlIHRyaWdnZXJlZCBhcyAiU2hpZnQrNCIgb3IgIlNoaWZ0KyQiIG9yIGp1c3QgIiQiCgkJCQlpZiAoIG1vZGlmID09PSAic2hpZnQrIiApIHsKCQkJCQlwb3NzaWJsZVsgalF1ZXJ5LmhvdGtleXMuc2hpZnROdW1zWyBjaGFyYWN0ZXIgXSBdID0gdHJ1ZTsKCQkJCX0KCQkJfQoKCQkJZm9yICggdmFyIGkgPSAwLCBsID0ga2V5cy5sZW5ndGg7IGkgPCBsOyBpKysgKSB7CgkJCQlpZiAoIHBvc3NpYmxlWyBrZXlzW2ldIF0gKSB7CgkJCQkJcmV0dXJuIG9yaWdIYW5kbGVyLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKCQkJCX0KCQkJfQoJCX07Cgl9CgoJalF1ZXJ5LmVhY2goWyAia2V5ZG93biIsICJrZXl1cCIsICJrZXlwcmVzcyIgXSwgZnVuY3Rpb24oKSB7CgkJalF1ZXJ5LmV2ZW50LnNwZWNpYWxbIHRoaXMgXSA9IHsgYWRkOiBrZXlIYW5kbGVyIH07Cgl9KTsKCn0pKCBqUXVlcnkgKTs=" );
			break;
		case 'fo':
			header( 'Content-Type: image/png' );
			echo base64_decode( "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAGrSURBVDjLxZO7ihRBFIa/6u0ZW7GHBUV0UQQTZzd3QdhMQxOfwMRXEANBMNQX0MzAzFAwEzHwARbNFDdwEd31Mj3X7a6uOr9BtzNjYjKBJ6nicP7v3KqcJFaxhBVtZUAK8OHlld2st7Xl3DJPVONP+zEUV4HqL5UDYHr5xvuQAjgl/Qs7TzvOOVAjxjlC+ePSwe6DfbVegLVuT4r14eTr6zvA8xSAoBLzx6pvj4l+DZIezuVkG9fY2H7YRQIMZIBwycmzH1/s3F8AapfIPNF3kQk7+kw9PWBy+IZOdg5Ug3mkAATy/t0usovzGeCUWTjCz0B+Sj0ekfdvkZ3abBv+U4GaCtJ1iEm6ANQJ6fEzrG/engcKw/wXQvEKxSEKQxRGKE7Izt+DSiwBJMUSm71rguMYhQKrBygOIRStf4TiFFRBvbRGKiQLWP29yRSHKBTtfdBmHs0BUpgvtgF4yRFR+NUKi0XZcYjCeCG2smkzLAHkbRBmP0/Uk26O5YnUActBp1GsAI+S5nRJJJal5K1aAMrq0d6Tm9uI6zjyf75dAe6tx/SsWeD//o2/Ab6IH3/h25pOAAAAAElFTkSuQmCC" );
			break;
		case 'fi':
			header( 'Content-Type: image/png' );
			echo base64_decode( "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAINSURBVBgZBcG/r55zGAfg6/4+z3va01NHlYgzEfE7MdCIGISFgS4Gk8ViYyM2Mdlsko4GSf8Do0FLRCIkghhYJA3aVBtEz3nP89wf11VJvPDepdd390+8Nso5nESBQoq0pfvXm9fzWf19453LF85vASqJlz748vInb517dIw6EyYBIIG49u+xi9/c9MdvR//99MPPZ7+4cP4IZhhTPbwzT2d+vGoaVRRp1rRliVvHq+cfvM3TD82+7mun0o/ceO7NT+/4/KOXjwZU1ekk0840bAZzMQ2mooqh0A72d5x/6sB9D5zYnff3PoYBoWBgFKPKqDKqjCpjKr//dcu9p489dra88cydps30KswACfNEKanSaxhlntjJ8Mv12Paie+vZ+0+oeSwwQ0Iw1xAR1CiFNJkGO4wu3ZMY1AAzBI0qSgmCNJsJUEOtJSMaCTBDLyQ0CknAGOgyTyFFiLI2awMzdEcSQgSAAKVUmAeNkxvWJWCGtVlDmgYQ0GFtgg4pNtOwbBcwQy/Rife/2yrRRVI0qYCEBly8Z+P4qMEMy7JaVw72N568e+iwhrXoECQkfH91kY7jwwXMsBx1L93ZruqrK6uuiAIdSnTIKKPLPFcvay8ww/Hh+ufeznTXu49v95IMoQG3784gYXdTqvRmqn/Wpa/ADFX58MW3L71SVU9ETgEIQQQIOOzub+fhIvwPRDgeVjWDahIAAAAASUVORK5CYII=" );
			break;
		case 'perms':
			header( 'Content-Type: image/png' );
			echo base64_decode( "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAALzSURBVDjLdZPdT5JhGMaZf4Bbh3ZaBzn/gU46MM1iNrf8WExNVyz1IDUOHCFpfq4PmmZmtTTT8GMJNGAO0hgi8a0oIBAGfoS4N12gmUpmL1fPy9LGpu/27N2zPdfvvu7rfh4WANZRa2pqims2mycMBsME+bjHnUvYOJ3O1JmZmWQiTiLi9dXVVYRCIUil0nWVSpWkVCqTZTJZ6pEAIu4mYtpms1EmkylFr9dTi4uLWFhYABFSCoUihYCo4eFhWiwWdycAHA6HMBAIIBwOw+/3g4i3tVptzOv1wu12Qy6Xx4h4mzgDRVFQq9UQiUTCQwCpWkd6jTEQRjA/Px8HHQCYvcvlAgOwWCwQCAQxHo9Xl9CC0WhsZQ5PT0/DarVifHwcPT096O/vZxyBtAXbx6fwDXLgV7TC8ToLzq60EhYh2kn1FZ1OF/H5fLDb7dBoNGhqajLx+fzM+vr6zPb2dtPMxCNQWj42XaPAz1VsuKTQiy7/ZhExvba2FrfLVCZBYnBwEC0tLZkH7qzS7Kbv7nvYW1GC0omwO/cef5YNxEUZWGTGdDAYjPfI2GQckMTR2dkZB4TUpy9F3Hdj9K4Buwu3ELZV4rOYC9ebMvAqSmkWGYmdWFzp6+uLzM7OxiFMDr29vabJoSu1kTkB6KgZO4FSRINF2PLWwtOVQd/m5n/Ly8uzH4ZIxtRKgsTk5CSYv17+GNQU/5+4BNGvhfjhFmL++UW01XB6E+6BRCKpGxoaink8nrjYMNoB71gN6F09oktc/ApewyZx8oWI7Z/GUFVVFSsvL/8/xoGBASGTPHPz3rbx4FHVwql+gpC1ADtLRQg77sDZcSEmE7+IZ9XQ0IDc3Fxhwj1obGzsrq6upkceZgBby/C9yoe29iSML9n4cO8sLRGcT+dwOFROTg7NZrO7j3xMBJDafDNtf8/8DHvWDlhb0zFScQqV13MjhYWFScXFxckEkHrsa2RWwbkT0fulZ/Y1D9j0u+asjRtXsy3E7rHP+S+qJels2qSd5wAAAABJRU5ErkJggg==" );
			break;
		case 'edit':
			header( 'Content-Type: image/png' );
			echo base64_decode( "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAH8SURBVDjLjZPfS1NhGMdXf0VEQhDUhdCN4X0IYT8ghIJQM0KoC4vushZddLELKyRhQQkSFIKEGEkUCI2oxVhepG5zi1xbc0u3cDs7Z+ec/ezT+x62scmmHvhwDrzP93Pe57znsQE2cR0SdAm6d+GwYL/M1LBVBV35fF4plUqVcrlMK8Q6TqdzYrukJuiW4Vwuh67rdbLZLJlMhmQyaUnigVlC05f4+dbB0tQplp92DsnwPimQBaZpUigUrLtE0zQURSGVSqHF37DhGkVZeQdagszKLJ7HvZtNAhmuIQWGYaCqKps/ZkivPqCwPs/Gp0cYvjnKUTe+F9fMJoFoo96zfJZ9K+sLpP33qRhujPANtr7dJPhqmO/PBxX3+PljTYLtqImPpH13qZge9LUrmLEB1FU7sZd9jJw5MljNthYk/KLnxdFqeAjzdz9Z/z3Ck2fRE36qx9pakAjME1y4Lbb9GTMyTD52GUXsZO3ZadTkL6umrSD4ZZrAezvLH54Q915EjwywtXSH8FQf+t+I9V12FLwe6wE1SmjyAi77Qb6Kt3rGe9H+hKzwrgLH9eMUPE4K3gm8jpPMjRwlHfNTLBbr7Cjo7znA2NVOXA/PsThzi2wyah1pI+0E/9rNQQsqMtM4CyfE36fLhb2ERa0mB7BR0CElexjnGnL0O2T2PyFunSz8jchwAAAAAElFTkSuQmCC" );
			break;
		case 'cut':
			header( 'Content-Type: image/png' );
			echo base64_decode( "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAIcSURBVDjLY/j//z8DLqyePcvQuW7VQomESay41DDgM8CpdkVm94YzD0RiJ3Iii4snTGIjygD3xlX58/de+y6ZOFkAJqaQNk3Hu2HlaaIM8G5eU7r+5L3/silT5aE2q9UsOfw6ecJW4gwIaF9fc/Dq8//yqVO1hWL6pZuXH30+d8/VhymTtyYRZUBw58aWc/ff/VdIm55as/jQraM3Xv71a1pZTXQghvds7rzy6OP/vk3nvjx4/fW/V/2yuUTFQgc3AxOIjurbMuHuq2//t5x9+D+2d+N+gtHYw8ssv1xNeuYuE60zc2UEOzNn7D5z4cGH//ETtx8Vie3nxmsASPNOU53r591s/p+yM/503cf+/6w9N/4/BLogatLu/RJJU6ylEicy4jRgpYbsnDNu1v8nCHFYTRBkD77iYf1/zt7b/5edeff/no/D/4vOVv9nSPJn4jTgsI3Rm7V6yutB7BWqUjMvBTj9L118+t81f8f/ixXF5h6w1L+yz0LvfjcvExdWA/Za6d87aW/6dLOB6qG7Xvb/12jJH9pkoHL6mI3RpzYuBua50oLlJxzN//cJcShgNWC6JH/ycVujH+eBilZrym8AapLYoqu8/oyD6d9WTgaJFeoyU4/amfzo4WMRwRkLvfys8n0CbGpd3IzMIP5sGaGCm94O//eb6ty96G77f6W67BKScmMP0L/L1GXmA732fb2u0k5gTMmgqwEAFiuGP1TJcvYAAAAASUVORK5CYII=" );
			break;
		case 'copy':
			header( 'Content-Type: image/png' );
			echo base64_decode( "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAADHSURBVCjPdZFNbsIwFAa/5B5FuQPCOQ9HQuqCq3SHUAtrrgFCSKQk8Y80XTjYJqiajRfj55GftNBKJtGoRiXSytlAZORzM1ckExjouHEm0LPdqHkTRnruXAgEPGpVq1JVCJ6RB3dOfHFEa7W5RzLx3kjPDse8ZxKisue9JwkByzevPQGZQnD8kHuunEvB43EcyD0dt/kEzzGdLD2/k9Ckb261zs9ZhiggVRO12jzN4Z5C+tQq90T+ETK20/J1tU2xeCOjpT7+APfbTaDnTb/mAAAAAElFTkSuQmCC" );
			break;
		case 'compress':
			header( 'Content-Type: image/png' );
			echo base64_decode( "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAKQSURBVDjLbZNNaJxVFIafe7/5KTPzpUloNK0tIsowCtbiQgRRQReudCMVqYrdiLgQ01UrWUgXXZQumoU2myyKii66dOFCEUo3IiL+VRMFHactYpsMmsy0mbnnx8X8tEn7wuHAudyH97zcG9wdgKWl9zNgl7vvrVar51T1PndHVQHDzBCRFGNhqd1ePXb06PF1gALAhbONF+7PanPtymtP9G2iVK3WmJjYibtjZuNupsWVlYtviaRTwABw4WzjEPDRVGMy/vt3QLpCu73G2toqZoKZE2Mkz3PyfBKxgKplDFUA3rz7wL5Y2lnigdrHiDhuRlaoYJslrv3cWb7cfehka/3BxUY93+EGqolbAU/tqz+K2V/MzFQAHZYQ4146v55v/NPd81UxL6uKQgyY2RgQB025fOUPCC9COAjhJVqt38BlcKpKb/M65kbq9YfB3nQAGOVSxqXWCXDBSZTLBWAAMDOKsYibYURE0naAMjOzC5gc2Pc0vDwApJTQGx3UDJHNLQ7GK1xq/Q7hFQivQjzMn82LY4CqhiwWw8BBQNW2OxBK5Yxm812whNNnx5YVtBBkoxICkLqYbcugt9Fh9+xj4/RHtblxA7EMVZsOYZC+qqMqWwBHfvr829OjgRNIWkIsIhb54cr+r7Ms+3Bqanr0GjHzm4AnDy8vAAujwfz83NTs7O7z3W7nYTOjH3uPp7RuWZYNHdhtDrZIVda/8+fPWa06nfWvfjJxdfFTEd2zvPzLZyn1CCHSrx954/UPWi8DC2H0G2/VM8ebzeceqd375fer/9WvnTgDVET0oLsWzJDmPe/lzx64K//ix43WHQH1t1fmgLkC/TNPy8lFM4vuWhGx6G72TXX+UAqVd4DT/wMfm3vSJoP5ygAAAABJRU5ErkJggg==" );
			break;
		case 'notavail':
			header( 'Content-Type: image/png' );
			echo base64_decode( "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAHdSURBVDjLpZNraxpBFIb3a0ggISmmNISWXmOboKihxpgUNGWNSpvaS6RpKL3Ry//Mh1wgf6PElaCyzq67O09nVjdVlJbSDy8Lw77PmfecMwZg/I/GDw3DCo8HCkZl/RlgGA0e3Yfv7+DbAfLrW+SXOvLTG+SHV/gPbuMZRnsyIDL/OASziMxkkKkUQTJJsLaGn8/iHz6nd+8mQv87Ahg2H9Th/BxZqxEkEgSrq/iVCvLsDK9awtvfxb2zjD2ARID+lVVlbabTgWYTv1rFL5fBUtHbbeTJCb3EQ3ovCnRC6xAgzJtOE+ztheYIEkqbFaS3vY2zuIj77AmtYYDusPy8/zuvunJkDKXM7tYWTiyGWFjAqeQnAD6+7ueNx/FLpRGAru7mcoj5ebqzszil7DggeF/DX1nBN82rzPqrzbRayIsLhJqMPT2N83Sdy2GApwFqRN7jFPL0tF+10cDd3MTZ2AjNUkGCoyO6y9cRxfQowFUbpufr1ct4ZoHg+Dg067zduTmEbq4yi/UkYidDe+kaTcP4ObJIajksPd/eyx3c+N2rvPbMDPbUFPZSLKzcGjKPrbJaDsu+dQO3msfZzeGY2TCvKGYQhdSYeeJjUt21dIcjXQ7U7Kv599f4j/oF55W4g/2e3b8AAAAASUVORK5CYII=" );
			break;
		case 'cross':
			header( 'Content-Type: image/png' );
			echo base64_decode( "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAIhSURBVDjLlZPrThNRFIWJicmJz6BWiYbIkYDEG0JbBiitDQgm0PuFXqSAtKXtpE2hNuoPTXwSnwtExd6w0pl2OtPlrphKLSXhx07OZM769qy19wwAGLhM1ddC184+d18QMzoq3lfsD3LZ7Y3XbE5DL6Atzuyilc5Ciyd7IHVfgNcDYTQ2tvDr5crn6uLSvX+Av2Lk36FFpSVENDe3OxDZu8apO5rROJDLo30+Nlvj5RnTlVNAKs1aCVFr7b4BPn6Cls21AWgEQlz2+Dl1h7IdA+i97A/geP65WhbmrnZZ0GIJpr6OqZqYAd5/gJpKox4Mg7pD2YoC2b0/54rJQuJZdm6Izcgma4TW1WZ0h+y8BfbyJMwBmSxkjw+VObNanp5h/adwGhaTXF4NWbLj9gEONyCmUZmd10pGgf1/vwcgOT3tUQE0DdicwIod2EmSbwsKE1P8QoDkcHPJ5YESjgBJkYQpIEZ2KEB51Y6y3ojvY+P8XEDN7uKS0w0ltA7QGCWHCxSWWpwyaCeLy0BkA7UXyyg8fIzDoWHeBaDN4tQdSvAVdU1Aok+nsNTipIEVnkywo/FHatVkBoIhnFisOBoZxcGtQd4B0GYJNZsDSiAEadUBCkstPtN3Avs2Msa+Dt9XfxoFSNYF/Bh9gP0bOqHLAm2WUF1YQskwrVFYPWkf3h1iXwbvqGfFPSGW9Eah8HSS9fuZDnS32f71m8KFY7xs/QZyu6TH2+2+FAAAAABJRU5ErkJggg==" );
			break;
		case 'delete':
			header( 'Content-Type: image/png' );
			echo base64_decode( "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAJdSURBVDjLpZP7S1NhGMf9W7YfogSJboSEUVCY8zJ31trcps6zTI9bLGJpjp1hmkGNxVz4Q6ildtXKXzJNbJRaRmrXoeWx8tJOTWptnrNryre5YCYuI3rh+8vL+/m8PA/PkwIg5X+y5mJWrxfOUBXm91QZM6UluUmthntHqplxUml2lciF6wrmdHriI0Wx3xw2hAediLwZRWRkCPzdDswaSvGqkGCfq8VEUsEyPF1O8Qu3O7A09RbRvjuIttsRbT6HHzebsDjcB4/JgFFlNv9MnkmsEszodIIY7Oaut2OJcSF68Qx8dgv8tmqEL1gQaaARtp5A+N4NzB0lMXxon/uxbI8gIYjB9HytGYuusfiPIQcN71kjgnW6VeFOkgh3XcHLvAwMSDPohOADdYQJdF1FtLMZPmslvhZJk2ahkgRvq4HHUoWHRDqTEDDl2mDkfheiDgt8pw340/EocuClCuFvboQzb0cwIZgki4KhzlaE6w0InipbVzBfqoK/qRH94i0rgokSFeO11iBkp8EdV8cfJo0yD75aE2ZNRvSJ0lZKcBXLaUYmQrCzDT6tDN5SyRqYlWeDLZAg0H4JQ+Jt6M3atNLE10VSwQsN4Z6r0CBwqzXesHmV+BeoyAUri8EyMfi2FowXS5dhd7doo2DVII0V5BAjigP89GEVAtda8b2ehodU4rNaAW+dGfzlFkyo89GTlcrHYCLpKD+V7yeeHNzLjkp24Uu1Ed6G8/F8qjqGRzlbl2H2dzjpMg1KdwsHxOlmJ7GTeZC/nesXbeZ6c9OYnuxUc3fmBuFft/Ff8xMd0s65SXIb/gAAAABJRU5ErkJggg==" );
			break;
	}
	exit;
}

// takes away the slash at the end
function end_slash( $str ) {
	if ( substr( $str, -1, 1 ) == '/' ) {
		$str = substr( $str, 0, -1 );
	}
	if ( substr( $str, -1, 1 ) == '\\' ) {
		$str = substr( $str, 0, -1 );
	}
	return $str;
}

// takes away both slashes
function slash( $str ) {
	if ( $str == null ) {
		return null;
	}
	if ( substr( $str, 0, 1 ) == '/' ) {
		$str = substr( $str, 1 );
	}
	if ( substr( $str, -1, 1 ) == '/' ) {
		$str = substr( $str, 0, -1 );
	}
	if ( substr( $str, 0, 1 ) == '\\' ) {
		$str = substr( $str, 1 );
	}
	if ( substr( $str, -1, 1 ) == '\\' ) {
		$str = substr( $str, 0, -1 );
	}
	return $str;
}

// root directory
$root = dirname(__FILE__);
$root = end_slash( $root );
$root = $root;

// current directory
$cd = ( isset( $_GET['cd'] ) && !empty( $_GET['cd'] ) ) ? ( $_GET['cd'] ) : null;
$cd = slash( $cd );

# root/current directory/  (root with current directory appended)
if ( $cd != null ) {
	$root_cd = "$root/$cd/";
} else {
	$root_cd = "$root/";
}

// location of the upper directory
if ( $cd != null ) {
	$up = realpath( $root_cd . '/..' );
	$up = str_replace( $root, '', $up );
	$up = slash( $up );
}

$folders = array();
$files = array();

# iterate over the folder, separate files and folders
if ( $handle = opendir( $root_cd ) ) {
    while ( false !== ( $file = readdir( $handle ) ) ) {
        if ( is_dir( $root_cd . $file ) ) {
			if ( $file == '.' || $file == '..' ) {
				continue;
			}
			$folders[ '/' . $file ] = array(
										md5( $root_cd . $file ), # used for the name and id
										urlencode( $cd . '/' . $file ), 
										substr( sprintf( '%o', fileperms( $root_cd . $file ) ), -4 ),
										fileatime( $root_cd . $file ),
									);
		} else {
			// exclude this script
			if ( $file == slash( $_SERVER['SCRIPT_NAME'] ) ) {
				continue;
			}
			$files[ $file ] = array(
									md5( $root_cd . $file ), # used for the name and id
									filesize( $root_cd . $file ),
									substr( sprintf( '%o', fileperms( $root_cd . $file ) ), -4 ),
									fileatime( $root_cd . $file ),
									);
		}
    }
	closedir( $handle );
}
?>
<!doctype html> 
<html lang="en"> 
	<head>
		<title>Pholder</title> 
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
		<link rel="stylesheet" type="text/css" href="?res=css" /> 
	</head>
	<body>
		<h1>Pholder</h1>
		<h2>/<?php echo $cd; ?></h2>
		<ul>
			<?php if ( $cd != null ) { ?> <li><a id="cd" href="?cd=<?php echo $up; ?>">Up a directory</a></li> <?php } ?>
			<?php $a = false; ?>
			<?php foreach ( $folders as $folder => $info ) { ?>
				<?php
					if ( $a == false ) { 
						$a = true;
					} else {
						$a = false;
					}
				?>
				<li class="folder list <?php if ( $a == true ) { echo ' alt'; } ?>" id="folder[<?php echo $info[0]; ?>]">
				<img src="?res=fo" alt="folder" class="ico" />
					<input type="checkbox" name="folder[<?php echo $info[0]; ?>]" class="chkfolder" />
					<a href="?cd=<?php echo $info[1]; ?>" title="folder[<?php echo $info[0]; ?>]">
						<?php echo $folder; ?></a> - 
						<?php echo $info[2]; ?> - 
						<?php echo date( "F d Y H:i:s.", $info[3] ); ?>
				</li>
			<?php } ?>
			<?php foreach ( $files as $file => $info ) { ?>
				<?php
					if ( $a == false ) { 
						$a = true;
					} else {
						$a = false;
					}
				?>
				<li class="file list<?php if ( $a == true ) { echo ' alt'; } ?>" id="file[<?php echo $info[0]; ?>]">
					<img src="?res=fi" alt="file" class="ico" />
					<input type="checkbox" name="file[<?php echo $info[0]; ?>]" class="chkfile" />
					<?php echo $file; ?> - 
					(<?php echo $info[1]; ?> KB) - 
					<?php echo $info[2]; ?> - 
					<?php echo date( "F d Y H:i:s.", $info[3] ); ?>
				</li>
			<?php } ?>
		</ul>
		<p><small>Copyright &copy; 2011 Bheesham Persaud. Icons by <a href="http://www.famfamfam.com/">famfamfam</a>. <a href="http://www.jquery.com">jQuery 1.4.2</a>. <a href="http://abeautifulsite.net/blog/2008/09/jquery-context-menu-plugin/">jQuery Context Menu Plugin</a>. <a href="https://github.com/jeresig/jquery.hotkeys">jQuery Hotkeys Plugin</a>.</small></p>
		<ul id="context_menu" class="contextMenu">
			<li class="fboth perms">
				<a href="#perms">Permissions</a>
			</li>
			<li class="ffile edit">
				<a href="#edit">Edit</a>
			</li>
			<li class="ffolder compress separator">
				<a href="#compress">Compress</a>
			</li>
			<li class="fboth delete separator">
				<a href="#delete">Delete</a>
			</li>
		</ul>
		<ul id="not_context_menu" class="contextMenu">
			<li class="cross">
				<a href="#cross">N/A</a>
			</li>
		</ul>
		<script type="text/javascript" src="?res=js"></script> 
		<script type="text/javascript">
			// a function to toggle a checkbox
			toggleCheckbox = function( name ) {
				if ( $('[name=' + name + ']').attr( 'checked' ) == true ) {
					$('[name=' + name + ']').attr( 'checked', false );
				} else {
					$('[name=' + name + ']').attr( 'checked', true );
				}
			}
			// file/folder specific actions
			fileFunctions = function() {
				if ( $("input:checkbox:checked.chkfolder").length > 0 ) {
					bothFunctions();
				} else {
					$("li.ffile").show();
					$("li.ffolder").hide();
				}
			}
			folderFunctions = function() {
				if ( $("input:checkbox:checked.chkfile").length > 0 ) {
					bothFunctions();
				} else {
					$("li.ffolder").show();
					$("li.ffile").hide();
				}
			}
			// indifferent functions for files/folders
			bothFunctions = function() {
				$("li.ffolder").hide();
				$("li.ffile").hide();
			}
			
			showContext = function() {
				$("li.list").destroyContextMenu();
				$("li.list").contextMenu({
						menu: 'context_menu'
					},
						function(action, el, pos) {
							return false;
				});
				return false;
			}
			
			hideContext = function() {
				$("li.list").destroyContextMenu();
				$("li.list").contextMenu({
						menu: 'not_context_menu'
					},
						function(action, el, pos) {
							return false;
				});
				return false;
			}
			
			$(document).ready( function() {
				// bind files
				$("li.file").bind( 'click', function() {
					$(this).toggleClass('sel');
					toggleCheckbox( $(this).attr( 'id' ) );
					fileFunctions();
				});
				// bind folders
				$("li.folder").bind( 'click', function() {
					$(this).toggleClass('sel');
					toggleCheckbox( $(this).attr( 'id' ) );
					folderFunctions();
				});
				// bind context menu
				$("li.list").bind( 'click', function() {
					if ( $("input:checkbox:checked").length == 0 )
					{
						hideContext();
					} else {
						showContext();
					}
				});
				// default context menu
				hideContext();
				// uncheck files and folders
				$("input:checkbox:checked").attr( 'checked', false );
				// backspace for folder browsing
				// when not in the root folder, press backspace to go up a folder
				jQuery(document).bind( 'keydown', 'backspace', function ( evt ){
					if ( typeof $("#cd").attr( 'href' ) != "undefined" ) {
						redi = $("#cd").attr( 'href' );
						window.location.href = redi;
					}
					return false;
				});
				// return key for folder browsing
				// select a folder, hit enter/return
				jQuery(document).bind( 'keydown', 'return', function ( evt ){
                    if ( $("input:checkbox:checked.chkfolder").length == 1 && $("input:checkbox:checked.chkfile").length == 0 ) {
						folder = $("input:checkbox:checked.chkfolder")
						redi = $("a[title=" + folder.attr("name") + "]").attr( 'href' );
						$("input:checkbox:checked").attr( 'checked', false );
						window.location.href = redi;
					}
                    return false;
                });
			});
		</script>
	</body>
</html>